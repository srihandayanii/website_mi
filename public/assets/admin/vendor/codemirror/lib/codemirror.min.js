(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{(this||window).CodeMirror=a()}}})(function(){var gc=navigator.userAgent;var eq=navigator.platform;var bJ=/gecko\/\d/i.test(gc);var ci=/MSIE \d/.test(gc);var ch=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(gc);var cg=ci||ch;var cj=cg&&(ci?document.documentMode||6:ch[1]);var gj=/WebKit\//.test(gc);var eE=gj&&/Qt\/\d+\.\d+/.test(gc);var L=/Chrome\//.test(gc);var ez=/Opera\//.test(gc);var e4=/Apple Computer/.test(navigator.vendor);var dd=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(gc);var ep=/PhantomJS/.test(gc);var cv=/AppleWebKit/.test(gc)&&/Mobile\/\w+/.test(gc);var dF=cv||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(gc);var dc=cv||/Mac/.test(eq);var M=/\bCrOS\b/.test(gc);var go=/win/i.test(eq);var eA=ez&&gc.match(/Version\/(\d*\.\d*)/);if(eA){eA=Number(eA[1])}if(eA&&eA>=15){ez=false;gj=true}var bG=dc&&(eE||ez&&(eA==null||eA<12.11));var G=bJ||(cg&&cj>=9);var e6=false,e5=false;function ab(gz,gy){if(!(this instanceof ab)){return new ab(gz,gy)}this.options=gy=gy?au(gy):{};au(aC,gy,false);fi(gy);var gu=gy.value;if(typeof gu=="string"){gu=new aP(gu,gy.mode,null,gy.lineSeparator)}this.doc=gu;var gw=new ab.inputStyles[gy.inputStyle](this);var gt=this.display=new aL(gz,gu,gw);gt.wrapper.CodeMirror=this;fX(this);fR(this);if(gy.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(gy.autofocus&&!dF){gt.input.focus()}co(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,selectingText:false,draggingText:false,highlight:new aF(),keySeq:null,specialChars:null};var gs=this;if(cg&&cj<11){setTimeout(function(){gs.display.input.reset(true)},20)}eN(this);bf();fF(this);this.curOp.forceUpdate=true;m(this,gu);if((gy.autofocus&&!dF)||gs.hasFocus()){setTimeout(w(d6,this),20)}else{d1(this)}for(var gx in eg){if(eg.hasOwnProperty(gx)){eg[gx](this,gy[gx],cm)}}du(this);if(gy.finishInit){gy.finishInit(this)}for(var gv=0;gv<cn.length;++gv){cn[gv](this)}a6(this);if(gj&&gy.lineWrapping&&getComputedStyle(gt.lineDiv).textRendering=="optimizelegibility"){gt.lineDiv.style.textRendering="auto"}}function aL(gv,gt,gu){var gs=this;this.input=gu;gs.scrollbarFiller=a5("div",null,"CodeMirror-scrollbar-filler");gs.scrollbarFiller.setAttribute("cm-not-content","true");gs.gutterFiller=a5("div",null,"CodeMirror-gutter-filler");gs.gutterFiller.setAttribute("cm-not-content","true");gs.lineDiv=a5("div",null,"CodeMirror-code");gs.selectionDiv=a5("div",null,null,"position: relative; z-index: 1");gs.cursorDiv=a5("div",null,"CodeMirror-cursors");gs.measure=a5("div",null,"CodeMirror-measure");gs.lineMeasure=a5("div",null,"CodeMirror-measure");gs.lineSpace=a5("div",[gs.measure,gs.lineMeasure,gs.selectionDiv,gs.cursorDiv,gs.lineDiv],null,"position: relative; outline: none");gs.mover=a5("div",[a5("div",[gs.lineSpace],"CodeMirror-lines")],null,"position: relative");gs.sizer=a5("div",[gs.mover],"CodeMirror-sizer");gs.sizerWidth=null;gs.heightForcer=a5("div",null,null,"position: absolute; height: "+e7+"px; width: 1px;");gs.gutters=a5("div",null,"CodeMirror-gutters");gs.lineGutter=null;gs.scroller=a5("div",[gs.sizer,gs.heightForcer,gs.gutters],"CodeMirror-scroll");gs.scroller.setAttribute("tabIndex","-1");gs.wrapper=a5("div",[gs.scrollbarFiller,gs.gutterFiller,gs.scroller],"CodeMirror");if(cg&&cj<8){gs.gutters.style.zIndex=-1;gs.scroller.style.paddingRight=0}if(!gj&&!(bJ&&dF)){gs.scroller.draggable=true}if(gv){if(gv.appendChild){gv.appendChild(gs.wrapper)}else{gv(gs.wrapper)}}gs.viewFrom=gs.viewTo=gt.first;gs.reportedViewFrom=gs.reportedViewTo=gt.first;gs.view=[];gs.renderedView=null;gs.externalMeasured=null;gs.viewOffset=0;gs.lastWrapHeight=gs.lastWrapWidth=0;gs.updateLineNumbers=null;gs.nativeBarWidth=gs.barHeight=gs.barWidth=0;gs.scrollbarsClipped=false;gs.lineNumWidth=gs.lineNumInnerWidth=gs.lineNumChars=null;gs.alignWidgets=false;gs.cachedCharWidth=gs.cachedTextHeight=gs.cachedPaddingH=null;gs.maxLine=null;gs.maxLineLength=0;gs.maxLineChanged=false;gs.wheelDX=gs.wheelDY=gs.wheelStartX=gs.wheelStartY=null;gs.shift=false;gs.selForContextMenu=null;gs.activeTouch=null;gu.init(gs)}function c7(gs){gs.doc.mode=ab.getMode(gs.options,gs.doc.modeOption);eX(gs)}function eX(gs){gs.doc.iter(function(gt){if(gt.stateAfter){gt.stateAfter=null}if(gt.styles){gt.styles=null}});gs.doc.frontier=gs.doc.first;fH(gs,100);gs.state.modeGen++;if(gs.curOp){eM(gs)}}function gp(gs){if(gs.options.lineWrapping){c(gs.display.wrapper,"CodeMirror-wrap");gs.display.sizer.style.minWidth="";gs.display.sizerWidth=null}else{e1(gs.display.wrapper,"CodeMirror-wrap");bx(gs)}bk(gs);eM(gs);P(gs);setTimeout(function(){f8(gs)},100)}function bj(gs){var gu=fP(gs.display),gv=gs.options.lineWrapping;var gt=gv&&Math.max(5,gs.display.scroller.clientWidth/K(gs.display)-3);return function(gx){if(cV(gs.doc,gx)){return 0}var gy=0;if(gx.widgets){for(var gw=0;gw<gx.widgets.length;gw++){if(gx.widgets[gw].height){gy+=gx.widgets[gw].height}}}if(gv){return gy+(Math.ceil(gx.text.length/gt)||1)*gu}else{return gy+gu}}}function bk(gs){var gt=gs.doc,gu=bj(gs);gt.iter(function(gw){var gv=gu(gw);if(gv!=gw.height){f5(gw,gv)}})}function fR(gs){gs.display.wrapper.className=gs.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+gs.options.theme.replace(/(^|\s)\s*/g," cm-s-");P(gs)}function b0(gs){fX(gs);eM(gs);setTimeout(function(){k(gs)},20)}function fX(gs){var gv=gs.display.gutters,gx=gs.options.gutters;eQ(gv);for(var gw=0;gw<gx.length;++gw){var gu=gx[gw];var gt=gv.appendChild(a5("div",null,"CodeMirror-gutter "+gu));if(gu=="CodeMirror-linenumbers"){gs.display.lineGutter=gt;gt.style.width=(gs.display.lineNumWidth||1)+"px"}}gv.style.display=gw?"":"none";fY(gs)}function fY(gs){var gt=gs.display.gutters.offsetWidth;gs.display.sizer.style.marginLeft=gt+"px"}function cY(gv){if(gv.height==0){return 0}var gu=gv.text.length,gw,gs=gv;while(gw=ae(gs)){var gt=gw.find(0,true);gs=gt.from.line;gu+=gt.from.ch-gt.to.ch}gs=gv;while(gw=ac(gs)){var gt=gw.find(0,true);gu-=gs.text.length-gt.from.ch;gs=gt.to.line;gu+=gs.text.length-gt.to.ch}return gu}function bx(gs){var gt=gs.display,gu=gs.doc;gt.maxLine=bP(gu,gu.first);gt.maxLineLength=cY(gt.maxLine);gt.maxLineChanged=true;gu.iter(function(gw){var gv=cY(gw);if(gv>gt.maxLineLength){gt.maxLineLength=gv;gt.maxLine=gw}})}function fi(gt){var gs=cl(gt.gutters,"CodeMirror-linenumbers");if(gs==-1&&gt.lineNumbers){gt.gutters=gt.gutters.concat(["CodeMirror-linenumbers"])}else{if(gs>-1&&!gt.lineNumbers){gt.gutters=gt.gutters.slice(0);gt.gutters.splice(gs,1)}}}function dz(gs){var gt=gs.display,gv=gt.gutters.offsetWidth;var gu=Math.round(gs.doc.height+ek(gs.display));return{clientHeight:gt.scroller.clientHeight,viewHeight:gt.wrapper.clientHeight,scrollWidth:gt.scroller.scrollWidth,clientWidth:gt.scroller.clientWidth,viewWidth:gt.wrapper.clientWidth,barLeft:gs.options.fixedGutter?gv:0,docHeight:gu,scrollHeight:gu+e8(gs)+gt.barHeight,nativeBarWidth:gt.nativeBarWidth,gutterWidth:gv}}function dM(gu,gv,gs){this.cm=gs;var gw=this.vert=a5("div",[a5("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var gt=this.horiz=a5("div",[a5("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");gu(gw);gu(gt);d0(gw,"scroll",function(){if(gw.clientHeight){gv(gw.scrollTop,"vertical")}});d0(gt,"scroll",function(){if(gt.clientWidth){gv(gt.scrollLeft,"horizontal")}});this.checkedZeroWidth=false;if(cg&&cj<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}}dM.prototype=au({update:function(gs){var gt=gs.scrollWidth>gs.clientWidth+1;var gu=gs.scrollHeight>gs.clientHeight+1;var gv=gs.nativeBarWidth;if(gu){this.vert.style.display="block";this.vert.style.bottom=gt?gv+"px":"0";var gw=gs.viewHeight-(gt?gv:0);this.vert.firstChild.style.height=Math.max(0,gs.scrollHeight-gs.clientHeight+gw)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(gt){this.horiz.style.display="block";this.horiz.style.right=gu?gv+"px":"0";this.horiz.style.left=gs.barLeft+"px";var gx=gs.viewWidth-gs.barLeft-(gu?gv:0);this.horiz.firstChild.style.width=(gs.scrollWidth-gs.clientWidth+gx)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedZeroWidth&&gs.clientHeight>0){if(gv==0){this.zeroWidthHack()}this.checkedZeroWidth=true}return{right:gu?gv:0,bottom:gt?gv:0}},setScrollLeft:function(gs){if(this.horiz.scrollLeft!=gs){this.horiz.scrollLeft=gs}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz)}},setScrollTop:function(gs){if(this.vert.scrollTop!=gs){this.vert.scrollTop=gs}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert)}},zeroWidthHack:function(){var gs=dc&&!dd?"12px":"18px";this.horiz.style.height=this.vert.style.width=gs;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new aF;this.disableVert=new aF},enableZeroWidthBar:function(gs,gt){gs.style.pointerEvents="auto";function gu(){var gv=gs.getBoundingClientRect();var gw=document.elementFromPoint(gv.left+1,gv.bottom-1);if(gw!=gs){gs.style.pointerEvents="none"}else{gt.set(1000,gu)}}gt.set(1000,gu)},clear:function(){var gs=this.horiz.parentNode;gs.removeChild(this.horiz);gs.removeChild(this.vert)}},dM.prototype);function dX(){}dX.prototype=au({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},dX.prototype);ab.scrollbarModel={"native":dM,"null":dX};function co(gs){if(gs.display.scrollbars){gs.display.scrollbars.clear();if(gs.display.scrollbars.addClass){e1(gs.display.wrapper,gs.display.scrollbars.addClass)}}gs.display.scrollbars=new ab.scrollbarModel[gs.options.scrollbarStyle](function(gt){gs.display.wrapper.insertBefore(gt,gs.display.scrollbarFiller);d0(gt,"mousedown",function(){if(gs.state.focused){setTimeout(function(){gs.display.input.focus()},0)}});gt.setAttribute("cm-not-content","true")},function(gu,gt){if(gt=="horizontal"){fj(gs,gu)}else{fk(gs,gu)}},gs);if(gs.display.scrollbars.addClass){c(gs.display.wrapper,gs.display.scrollbars.addClass)}}function f8(gs,gu){if(!gu){gu=dz(gs)}var gw=gs.display.barWidth,gv=gs.display.barHeight;f9(gs,gu);for(var gt=0;gt<4&&gw!=gs.display.barWidth||gv!=gs.display.barHeight;gt++){if(gw!=gs.display.barWidth&&gs.options.lineWrapping){fZ(gs)}f9(gs,dz(gs));gw=gs.display.barWidth;gv=gs.display.barHeight}}function f9(gs,gu){var gt=gs.display;var gv=gt.scrollbars.update(gu);gt.sizer.style.paddingRight=(gt.barWidth=gv.right)+"px";gt.sizer.style.paddingBottom=(gt.barHeight=gv.bottom)+"px";gt.heightForcer.style.borderBottom=gv.bottom+"px solid transparent";if(gv.right&&gv.bottom){gt.scrollbarFiller.style.display="block";gt.scrollbarFiller.style.height=gv.bottom+"px";gt.scrollbarFiller.style.width=gv.right+"px"}else{gt.scrollbarFiller.style.display=""}if(gv.bottom&&gs.options.coverGutterNextToScrollbar&&gs.options.fixedGutter){gt.gutterFiller.style.display="block";gt.gutterFiller.style.height=gv.bottom+"px";gt.gutterFiller.style.width=gu.gutterWidth+"px"}else{gt.gutterFiller.style.display=""}}function ge(gt,gu,gA){var gz=gA&&gA.top!=null?Math.max(0,gA.top):gt.scroller.scrollTop;gz=Math.floor(gz-ej(gt));var gs=gA&&gA.bottom!=null?gA.bottom:gz+gt.wrapper.clientHeight;var gx=cT(gu,gz),gy=cT(gu,gs);if(gA&&gA.ensure){var gv=gA.ensure.from.line,gw=gA.ensure.to.line;if(gv<gx){gx=gv;gy=cT(gu,b9(bP(gu,gv))+gt.wrapper.clientHeight)}else{if(Math.min(gw,gu.lastLine())>=gy){gx=cT(gu,b9(bP(gu,gw))-gt.wrapper.clientHeight);gy=gw}}}return{from:gx,to:Math.max(gy,gx+1)}}function k(gt){var gv=gt.display,gA=gv.view;if(!gv.alignWidgets&&(!gv.gutters.firstChild||!gt.options.fixedGutter)){return}var gu=ai(gv)-gv.scroller.scrollLeft+gt.doc.scrollLeft;var gw=gv.gutters.offsetWidth,gz=gu+"px";for(var gx=0;gx<gA.length;gx++){if(!gA[gx].hidden){if(gt.options.fixedGutter){if(gA[gx].gutter){gA[gx].gutter.style.left=gz}if(gA[gx].gutterBackground){gA[gx].gutterBackground.style.left=gz}}var gs=gA[gx].alignable;if(gs){for(var gy=0;gy<gs.length;gy++){gs[gy].style.left=gz}}}}if(gt.options.fixedGutter){gv.gutters.style.left=(gu+gw)+"px"}}function du(gs){if(!gs.options.lineNumbers){return false}var gu=gs.doc,gw=c0(gs.options,gu.first+gu.size-1),gt=gs.display;if(gw.length!=gt.lineNumChars){var gy=gt.measure.appendChild(a5("div",[a5("div",gw)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var gv=gy.firstChild.offsetWidth,gx=gy.offsetWidth-gv;gt.lineGutter.style.width="";gt.lineNumInnerWidth=Math.max(gv,gt.lineGutter.offsetWidth-gx)+1;gt.lineNumWidth=gt.lineNumInnerWidth+gx;gt.lineNumChars=gt.lineNumInnerWidth?gw.length:-1;gt.lineGutter.style.width=gt.lineNumWidth+"px";fY(gs);return true}return false}function c0(gt,gs){return String(gt.lineNumberFormatter(gs+gt.firstLineNumber))}function ai(gs){return gs.scroller.getBoundingClientRect().left-gs.sizer.getBoundingClientRect().left}function aN(gs,gv,gu){var gt=gs.display;this.viewport=gv;this.visible=ge(gt,gs.doc,gv);this.editorIsHidden=!gt.wrapper.offsetWidth;this.wrapperHeight=gt.wrapper.clientHeight;this.wrapperWidth=gt.wrapper.clientWidth;this.oldDisplayWidth=aO(gs);this.force=gu;this.dims=bM(gs);this.events=[]}aN.prototype.signal=function(gs,gt){if(b7(gs,gt)){this.events.push(arguments)}};aN.prototype.finish=function(){for(var gs=0;gs<this.events.length;gs++){ft.apply(null,this.events[gs])}};function ds(gs){var gt=gs.display;if(!gt.scrollbarsClipped&&gt.scroller.offsetWidth){gt.nativeBarWidth=gt.scroller.offsetWidth-gt.scroller.clientWidth;gt.heightForcer.style.height=e8(gs)+"px";gt.sizer.style.marginBottom=-gt.nativeBarWidth+"px";gt.sizer.style.borderRightWidth=e8(gs)+"px";gt.scrollbarsClipped=true}}function fT(gs,gB){var gu=gs.display,gv=gs.doc;if(gB.editorIsHidden){eY(gs);return false}if(!gB.force&&gB.visible.from>=gu.viewFrom&&gB.visible.to<=gu.viewTo&&(gu.updateLineNumbers==null||gu.updateLineNumbers>=gu.viewTo)&&gu.renderedView==gu.view&&az(gs)==0){return false}if(du(gs)){eY(gs);gB.dims=bM(gs)}var gw=gv.first+gv.size;var gy=Math.max(gB.visible.from-gs.options.viewportMargin,gv.first);var gz=Math.min(gw,gB.visible.to+gs.options.viewportMargin);if(gu.viewFrom<gy&&gy-gu.viewFrom<20){gy=Math.max(gv.first,gu.viewFrom)}if(gu.viewTo>gz&&gu.viewTo-gz<20){gz=Math.min(gw,gu.viewTo)}if(e5){gy=gi(gs.doc,gy);gz=gh(gs.doc,gz)}var gt=gy!=gu.viewFrom||gz!=gu.viewTo||gu.lastWrapHeight!=gB.wrapperHeight||gu.lastWrapWidth!=gB.wrapperWidth;j(gs,gy,gz);gu.viewOffset=b9(bP(gs.doc,gu.viewFrom));gs.display.mover.style.top=gu.viewOffset+"px";var gA=az(gs);if(!gt&&gA==0&&!gB.force&&gu.renderedView==gu.view&&(gu.updateLineNumbers==null||gu.updateLineNumbers>=gu.viewTo)){return false}var gx=a();if(gA>4){gu.lineDiv.style.display="none"}eo(gs,gu.updateLineNumbers,gB.dims);if(gA>4){gu.lineDiv.style.display=""}gu.renderedView=gu.view;if(gx&&a()!=gx&&gx.offsetHeight){gx.focus()}eQ(gu.cursorDiv);eQ(gu.selectionDiv);gu.gutters.style.height=gu.sizer.style.minHeight=0;if(gt){gu.lastWrapHeight=gB.wrapperHeight;gu.lastWrapWidth=gB.wrapperWidth;fH(gs,400)}gu.updateLineNumbers=null;return true}function ev(gt,gv){var gw=gv.viewport;for(var gu=true;;gu=false){if(!gu||!gt.options.lineWrapping||gv.oldDisplayWidth==aO(gt)){if(gw&&gw.top!=null){gw={top:Math.min(gt.doc.height+ek(gt.display)-aM(gt),gw.top)}}gv.visible=ge(gt.display,gt.doc,gw);if(gv.visible.from>=gt.display.viewFrom&&gv.visible.to<=gt.display.viewTo){break}}if(!fT(gt,gv)){break}fZ(gt);var gs=dz(gt);ga(gt);f8(gt,gs);fh(gt,gs)}gv.signal(gt,"update",gt);if(gt.display.viewFrom!=gt.display.reportedViewFrom||gt.display.viewTo!=gt.display.reportedViewTo){gv.signal(gt,"viewportChange",gt,gt.display.viewFrom,gt.display.viewTo);gt.display.reportedViewFrom=gt.display.viewFrom;gt.display.reportedViewTo=gt.display.viewTo}}function fU(gt,gv){var gu=new aN(gt,gv);if(fT(gt,gu)){fZ(gt);ev(gt,gu);var gs=dz(gt);ga(gt);f8(gt,gs);fh(gt,gs);gu.finish()}}function fh(gs,gt){gs.display.sizer.style.minHeight=gt.docHeight+"px";gs.display.heightForcer.style.top=gt.docHeight+"px";gs.display.gutters.style.height=(gt.docHeight+gs.display.barHeight+e8(gs))+"px"}function fZ(gu){var gx=gu.display;var gB=gx.lineDiv.offsetTop;for(var gz=0;gz<gx.view.length;gz++){var gv=gx.view[gz],gy;if(gv.hidden){continue}if(cg&&cj<8){var gs=gv.node.offsetTop+gv.node.offsetHeight;gy=gs-gB;gB=gs}else{var gt=gv.node.getBoundingClientRect();gy=gt.bottom-gt.top}var gw=gv.line.height-gy;if(gy<2){gy=fP(gx)}if(gw>0.001||gw<-0.001){f5(gv.line,gy);gb(gv.line);if(gv.rest){for(var gA=0;gA<gv.rest.length;gA++){gb(gv.rest[gA])}}}}}function gb(gt){if(gt.widgets){for(var gs=0;gs<gt.widgets.length;++gs){gt.widgets[gs].height=gt.widgets[gs].node.parentNode.offsetHeight}}}function bM(gs){var gt=gs.display,gw={},gy={};var gu=gt.gutters.clientLeft;for(var gx=gt.gutters.firstChild,gv=0;gx;gx=gx.nextSibling,++gv){gw[gs.options.gutters[gv]]=gx.offsetLeft+gx.clientLeft+gu;gy[gs.options.gutters[gv]]=gx.clientWidth}return{fixedPos:ai(gt),gutterTotalWidth:gt.gutters.offsetWidth,gutterLeft:gw,gutterWidth:gy,wrapperWidth:gt.wrapper.clientWidth}}function eo(gs,gE,gv){var gw=gs.display,gz=gs.options.lineNumbers;var gt=gw.lineDiv,gu=gt.firstChild;function gC(gH){var gG=gH.nextSibling;if(gj&&dc&&gs.display.currentWheelTarget==gH){gH.style.display="none"}else{gH.parentNode.removeChild(gH)}return gG}var gF=gw.view,gy=gw.viewFrom;for(var gx=0;gx<gF.length;gx++){var gA=gF[gx];if(gA.hidden){}else{if(!gA.node||gA.node.parentNode!=gt){var gB=A(gs,gA,gy,gv);gt.insertBefore(gB,gu)}else{while(gu!=gA.node){gu=gC(gu)}var gD=gz&&gE!=null&&gE<=gy&&gA.lineNumber;if(gA.changes){if(cl(gA.changes,"gutter")>-1){gD=false}f3(gs,gA,gy,gv)}if(gD){eQ(gA.lineNumber);gA.lineNumber.appendChild(document.createTextNode(c0(gs.options,gy)))}gu=gA.node.nextSibling}}gy+=gA.size}while(gu){gu=gC(gu)}}function f3(gs,gw,gv,gt){for(var gu=0;gu<gw.changes.length;gu++){var gx=gw.changes[gu];if(gx=="text"){f6(gs,gw)}else{if(gx=="gutter"){f4(gs,gw,gv,gt)}else{if(gx=="class"){f2(gw)}else{if(gx=="widget"){f7(gs,gw,gt)}}}}}gw.changes=null}function bh(gs){if(gs.node==gs.text){gs.node=a5("div",null,null,"position: relative");if(gs.text.parentNode){gs.text.parentNode.replaceChild(gs.node,gs.text)}gs.node.appendChild(gs.text);if(cg&&cj<8){gs.node.style.zIndex=2}}return gs.node}function f1(gt){var gs=gt.bgClass?gt.bgClass+" "+(gt.line.bgClass||""):gt.line.bgClass;if(gs){gs+=" CodeMirror-linebackground"}if(gt.background){if(gs){gt.background.className=gs}else{gt.background.parentNode.removeChild(gt.background);gt.background=null}}else{if(gs){var gu=bh(gt);gt.background=gu.insertBefore(a5("div",null,gs),gu.firstChild)}}}function bQ(gs,gu){var gt=gs.display.externalMeasured;if(gt&&gt.line==gu.line){gs.display.externalMeasured=null;gu.measure=gt.measure;return gt.built}return z(gs,gu)}function f6(gu,gv){var gt=gv.text.className;var gs=bQ(gu,gv);if(gv.text==gv.node){gv.node=gs.pre}gv.text.parentNode.replaceChild(gs.pre,gv.text);gv.text=gs.pre;if(gs.bgClass!=gv.bgClass||gs.textClass!=gv.textClass){gv.bgClass=gs.bgClass;gv.textClass=gs.textClass;f2(gv)}else{if(gt){gv.text.className=gt}}}function f2(gs){f1(gs);if(gs.line.wrapClass){bh(gs).className=gs.line.wrapClass}else{if(gs.node!=gs.text){gs.node.className=""}}var gt=gs.textClass?gs.textClass+" "+(gs.line.textClass||""):gs.line.textClass;gs.text.className=gt||""}function f4(gs,gz,gy,gt){if(gz.gutter){gz.node.removeChild(gz.gutter);gz.gutter=null}if(gz.gutterBackground){gz.node.removeChild(gz.gutterBackground);gz.gutterBackground=null}if(gz.line.gutterClass){var gB=bh(gz);gz.gutterBackground=a5("div",null,"CodeMirror-gutter-background "+gz.line.gutterClass,"left: "+(gs.options.fixedGutter?gt.fixedPos:-gt.gutterTotalWidth)+"px; width: "+gt.gutterTotalWidth+"px");gB.insertBefore(gz.gutterBackground,gz.text)}var gA=gz.line.gutterMarkers;if(gs.options.lineNumbers||gA){var gB=bh(gz);var gv=gz.gutter=a5("div",null,"CodeMirror-gutter-wrapper","left: "+(gs.options.fixedGutter?gt.fixedPos:-gt.gutterTotalWidth)+"px");gs.display.input.setUneditable(gv);gB.insertBefore(gv,gz.text);if(gz.line.gutterClass){gv.className+=" "+gz.line.gutterClass}if(gs.options.lineNumbers&&(!gA||!gA["CodeMirror-linenumbers"])){gz.lineNumber=gv.appendChild(a5("div",c0(gs.options,gy),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+gt.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+gs.display.lineNumInnerWidth+"px"))}if(gA){for(var gx=0;gx<gs.options.gutters.length;++gx){var gw=gs.options.gutters[gx],gu=gA.hasOwnProperty(gw)&&gA[gw];if(gu){gv.appendChild(a5("div",[gu],"CodeMirror-gutter-elt","left: "+gt.gutterLeft[gw]+"px; width: "+gt.gutterWidth[gw]+"px"))}}}}}function f7(gs,gu,gt){if(gu.alignable){gu.alignable=null}for(var gw=gu.node.firstChild,gv;gw;gw=gv){var gv=gw.nextSibling;if(gw.className=="CodeMirror-linewidget"){gu.node.removeChild(gw)}}cq(gs,gu,gt)}function A(gt,gw,gv,gu){var gs=bQ(gt,gw);gw.text=gw.node=gs.pre;if(gs.bgClass){gw.bgClass=gs.bgClass}if(gs.textClass){gw.textClass=gs.textClass}f2(gw);f4(gt,gw,gv,gu);cq(gt,gw,gu);return gw.node}function cq(gs,gv,gt){cr(gs,gv.line,gv,gt,true);if(gv.rest){for(var gu=0;gu<gv.rest.length;gu++){cr(gs,gv.rest[gu],gv,gt,false)}}}function cr(gt,gw,gx,gu,gs){if(!gw.widgets){return}var gA=bh(gx);for(var gv=0,gB=gw.widgets;gv<gB.length;++gv){var gz=gB[gv],gy=a5("div",[gz.node],"CodeMirror-linewidget");if(!gz.handleMouseEvents){gy.setAttribute("cm-ignore-events","true")}et(gz,gy,gx,gu);gt.display.input.setUneditable(gy);if(gs&&gz.above){gA.insertBefore(gy,gx.gutter||gx.text)}else{gA.appendChild(gy)}fw(gz,"redraw")}}function et(gv,gu,gt,gs){if(gv.noHScroll){(gt.alignable||(gt.alignable=[])).push(gu);var gw=gs.wrapperWidth;gu.style.left=gs.fixedPos+"px";if(!gv.coverGutter){gw-=gs.gutterTotalWidth;gu.style.paddingLeft=gs.gutterTotalWidth+"px"}gu.style.width=gw+"px"}if(gv.coverGutter){gu.style.zIndex=5;gu.style.position="relative";if(!gv.noHScroll){gu.style.marginLeft=-gs.gutterTotalWidth+"px"}}}var er=ab.Pos=function(gt,gs){if(!(this instanceof er)){return new er(gt,gs)}this.line=gt;this.ch=gs};var aa=ab.cmpPos=function(gs,gt){return gs.line-gt.line||gs.ch-gt.ch};function av(gs){return er(gs.line,gs.ch)}function dr(gs,gt){return aa(gs,gt)<0?gt:gs}function dE(gs,gt){return aa(gs,gt)<0?gs:gt}function be(gs){if(!gs.state.focused){gs.display.input.focus();d6(gs)}}var cK=null;function l(gt,gy,gu,gD,gA){var gv=gt.doc;gt.display.shift=false;if(!gD){gD=gv.sel}var gB=gt.state.pasteIncoming||gA=="paste";var gE=gv.splitLines(gy),gz=null;if(gB&&gD.ranges.length>1){if(cK&&cK.text.join("\n")==gy){if(gD.ranges.length%cK.text.length==0){gz=[];for(var gx=0;gx<cK.text.length;gx++){gz.push(gv.splitLines(cK.text[gx]))}}}else{if(gE.length==gD.ranges.length){gz=dj(gE,function(gH){return[gH]})}}}for(var gx=gD.ranges.length-1;gx>=0;gx--){var gC=gD.ranges[gx];var gw=gC.from(),gF=gC.to();if(gC.empty()){if(gu&&gu>0){gw=er(gw.line,gw.ch-gu)}else{if(gt.state.overwrite&&!gB){gF=er(gF.line,Math.min(bP(gv,gF.line).text.length,gF.ch+db(gE).length))}else{if(cK&&cK.lineWise&&cK.text.join("\n")==gy){gw=gF=er(gw.line,0)}}}}var gG=gt.curOp.updateInput;var gs={from:gw,to:gF,text:gz?gz[gx%gz.length]:gE,origin:gA||(gB?"paste":gt.state.cutIncoming?"cut":"+input")};de(gt.doc,gs);fw(gt,"inputRead",gt,gs)}if(gy&&!gB){fS(gt,gy)}bd(gt);gt.curOp.updateInput=gG;gt.curOp.typing=true;gt.state.pasteIncoming=gt.state.cutIncoming=false}function b3(gt,gs){var gu=gt.clipboardData&&gt.clipboardData.getData("Text");if(gu){gt.preventDefault();if(!gs.isReadOnly()&&!gs.options.disableInput){e2(gs,function(){l(gs,gu,0,null,"paste")})}return true}}function fS(gs,gv){if(!gs.options.electricChars||!gs.options.smartIndent){return}var gz=gs.doc.sel;for(var gt=gz.ranges.length-1;gt>=0;gt--){var gy=gz.ranges[gt];if(gy.head.ch>100||(gt&&gz.ranges[gt-1].head.line==gy.head.line)){continue}var gx=gs.getModeAt(gy.head);var gu=false;if(gx.electricChars){for(var gw=0;gw<gx.electricChars.length;gw++){if(gv.indexOf(gx.electricChars.charAt(gw))>-1){gu=ck(gs,gy.head.line,"smart");break}}}else{if(gx.electricInput){if(gx.electricInput.test(bP(gs.doc,gy.head.line).text.slice(0,gy.head.ch))){gu=ck(gs,gy.head.line,"smart")}}}if(gu){fw(gs,"electricInput",gs,gy.head.line)}}}function ar(gs){var gx=[],gw=[];for(var gt=0;gt<gs.doc.sel.ranges.length;gt++){var gu=gs.doc.sel.ranges[gt].head.line;var gv={anchor:er(gu,0),head:er(gu+1,0)};gw.push(gv);gx.push(gs.getRange(gv.anchor,gv.head))}return{text:gx,ranges:gw}}function aJ(gs,gt){gs.setAttribute("autocorrect","off");gs.setAttribute("autocapitalize","off");gs.setAttribute("spellcheck",!!gt)}function fO(gs){this.cm=gs;this.prevInput="";this.pollingFast=false;this.polling=new aF();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null}function cb(){var gt=a5("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none");var gs=a5("div",[gt],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(gj){gt.style.width="1000px"}else{gt.setAttribute("wrap","off")}if(cv){gt.style.border="1px solid black"}aJ(gt);return gs}fO.prototype=au({init:function(gt){var gv=this,gs=this.cm;var gu=this.wrapper=cb();var gx=this.textarea=gu.firstChild;gt.wrapper.insertBefore(gu,gt.wrapper.firstChild);if(cv){gx.style.width="0px"}d0(gx,"input",function(){if(cg&&cj>=9&&gv.hasSelection){gv.hasSelection=null}gv.poll()});d0(gx,"paste",function(gy){if(fv(gs,gy)||b3(gy,gs)){return}gs.state.pasteIncoming=true;gv.fastPoll()});function gw(gy){if(fv(gs,gy)){return}if(gs.somethingSelected()){cK={lineWise:false,text:gs.getSelections()};if(gv.inaccurateSelection){gv.prevInput="";gv.inaccurateSelection=false;gx.value=cK.text.join("\n");fe(gx)}}else{if(!gs.options.lineWiseCopyCut){return}else{var gz=ar(gs);cK={lineWise:true,text:gz.text};if(gy.type=="cut"){gs.setSelections(gz.ranges,null,fb)}else{gv.prevInput="";gx.value=gz.text.join("\n");fe(gx)}}}if(gy.type=="cut"){gs.state.cutIncoming=true}}d0(gx,"cut",gw);d0(gx,"copy",gw);d0(gt.scroller,"paste",function(gy){if(bl(gt,gy)||fv(gs,gy)){return}gs.state.pasteIncoming=true;gv.focus()});d0(gt.lineSpace,"selectstart",function(gy){if(!bl(gt,gy)){a1(gy)}});d0(gx,"compositionstart",function(){var gy=gs.getCursor("from");if(gv.composing){gv.composing.range.clear()}gv.composing={start:gy,range:gs.markText(gy,gs.getCursor("to"),{className:"CodeMirror-composing"})}});d0(gx,"compositionend",function(){if(gv.composing){gv.poll();gv.composing.range.clear();gv.composing=null}})},prepareSelection:function(){var gs=this.cm,gt=gs.display,gu=gs.doc;var gx=ey(gs);if(gs.options.moveInputWithCursor){var gv=aB(gs,gu.sel.primary().head,"div");var gy=gt.wrapper.getBoundingClientRect(),gw=gt.lineDiv.getBoundingClientRect();gx.teTop=Math.max(0,Math.min(gt.wrapper.clientHeight-10,gv.top+gw.top-gy.top));gx.teLeft=Math.max(0,Math.min(gt.wrapper.clientWidth-10,gv.left+gw.left-gy.left))}return gx},showSelection:function(gu){var gs=this.cm,gt=gs.display;eR(gt.cursorDiv,gu.cursors);eR(gt.selectionDiv,gu.selection);if(gu.teTop!=null){this.wrapper.style.top=gu.teTop+"px";this.wrapper.style.left=gu.teLeft+"px"}},reset:function(gy){if(this.contextMenuPending){return}var gv,gx,gs=this.cm,gu=gs.doc;if(gs.somethingSelected()){this.prevInput="";var gw=gu.sel.primary();gv=b6&&(gw.to().line-gw.from().line>100||(gx=gs.getSelection()).length>1000);var gt=gv?"-":gx||gs.getSelection();this.textarea.value=gt;if(gs.state.focused){fe(this.textarea)}if(cg&&cj>=9){this.hasSelection=gt}}else{if(!gy){this.prevInput=this.textarea.value="";if(cg&&cj>=9){this.hasSelection=null}}}this.inaccurateSelection=gv},getField:function(){return this.textarea},supportsTouch:function(){return false},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!dF||a()!=this.textarea)){try{this.textarea.focus()}catch(gs){}}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var gs=this;if(gs.pollingFast){return}gs.polling.set(this.cm.options.pollInterval,function(){gs.poll();if(gs.cm.state.focused){gs.slowPoll()}})},fastPoll:function(){var gt=false,gs=this;gs.pollingFast=true;function gu(){var gv=gs.poll();if(!gv&&!gt){gt=true;gs.polling.set(60,gu)}else{gs.pollingFast=false;gs.slowPoll()}}gs.polling.set(20,gu)},poll:function(){var gs=this.cm,gu=this.textarea,gw=this.prevInput;if(this.contextMenuPending||!gs.state.focused||(b8(gu)&&!gw&&!this.composing)||gs.isReadOnly()||gs.options.disableInput||gs.state.keySeq){return false}var gz=gu.value;if(gz==gw&&!gs.somethingSelected()){return false}if(cg&&cj>=9&&this.hasSelection===gz||dc&&/[\uf700-\uf7ff]/.test(gz)){gs.display.input.reset();return false}if(gs.doc.sel==gs.display.selForContextMenu){var gt=gz.charCodeAt(0);if(gt==8203&&!gw){gw="\u200b"}if(gt==8666){this.reset();return this.cm.execCommand("undo")}}var gx=0,gv=Math.min(gw.length,gz.length);while(gx<gv&&gw.charCodeAt(gx)==gz.charCodeAt(gx)){++gx}var gy=this;e2(gs,function(){l(gs,gz.slice(gx),gw.length-gx,null,gy.composing?"*compose":null);if(gz.length>1000||gz.indexOf("\n")>-1){gu.value=gy.prevInput=""}else{gy.prevInput=gz}if(gy.composing){gy.composing.range.clear();gy.composing.range=gs.markText(gy.composing.start,gs.getCursor("to"),{className:"CodeMirror-composing"})}});return true},ensurePolled:function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}},onKeyPress:function(){if(cg&&cj>=9){this.hasSelection=null}this.fastPoll()},onContextMenu:function(gu){var gv=this,gs=gv.cm,gt=gs.display,gF=gv.textarea;var gA=es(gs,gu),gE=gt.scroller.scrollTop;if(!gA||ez){return}var gD=gs.options.resetSelectionOnContextMenu;if(gD&&gs.doc.sel.contains(gA)==-1){ed(gs,fl)(gs.doc,fx(gA),fb)}var gx=gF.style.cssText,gz=gv.wrapper.style.cssText;gv.wrapper.style.cssText="position: absolute";var gG=gv.wrapper.getBoundingClientRect();gF.style.cssText="position: absolute; width: 30px; height: 30px; top: "+(gu.clientY-gG.top-5)+"px; left: "+(gu.clientX-gG.left-5)+"px; z-index: 1000; background: "+(cg?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(gj){var gy=window.scrollY}gt.input.focus();if(gj){window.scrollTo(null,gy)}gt.input.reset();if(!gs.somethingSelected()){gF.value=gv.prevInput=" "}gv.contextMenuPending=true;gt.selForContextMenu=gs.doc.sel;clearTimeout(gt.detectingSelectAll);function gB(){if(gF.selectionStart!=null){var gI=gs.somethingSelected();var gH="\u200b"+(gI?gF.value:"");gF.value="\u21da";gF.value=gH;gv.prevInput=gI?"":"\u200b";gF.selectionStart=1;gF.selectionEnd=gH.length;gt.selForContextMenu=gs.doc.sel}}function gC(){gv.contextMenuPending=false;gv.wrapper.style.cssText=gz;gF.style.cssText=gx;if(cg&&cj<9){gt.scrollbars.setScrollTop(gt.scroller.scrollTop=gE)}if(gF.selectionStart!=null){if(!cg||(cg&&cj<9)){gB()}var gH=0,gI=function(){if(gt.selForContextMenu==gs.doc.sel&&gF.selectionStart==0&&gF.selectionEnd>0&&gv.prevInput=="\u200b"){ed(gs,af.selectAll)(gs)}else{if(gH++<10){gt.detectingSelectAll=setTimeout(gI,500)}else{gt.input.reset()}}};gt.detectingSelectAll=setTimeout(gI,200)}}if(cg&&cj>=9){gB()}if(G){a2(gu);var gw=function(){dY(window,"mouseup",gw);setTimeout(gC,20)};d0(window,"mouseup",gw)}else{setTimeout(gC,50)}},readOnlyChanged:function(gs){if(!gs){this.reset()}},setUneditable:dV,needsContentAttribute:false},fO.prototype);function an(gs){this.cm=gs;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new aF();this.gracePeriod=false}an.prototype=au({init:function(gt){var gv=this,gs=gv.cm;var gu=gv.div=gt.lineDiv;aJ(gu,gs.options.spellcheck);d0(gu,"paste",function(gx){if(fv(gs,gx)||b3(gx,gs)){return}if(cj<=11){setTimeout(ed(gs,function(){if(!gv.pollContent()){eM(gs)}}),20)}});d0(gu,"compositionstart",function(gy){var gx=gy.data;gv.composing={sel:gs.doc.sel,data:gx,startData:gx};if(!gx){return}var gB=gs.doc.sel.primary();var gA=gs.getLine(gB.head.line);var gz=gA.indexOf(gx,Math.max(0,gB.head.ch-gx.length));if(gz>-1&&gz<=gB.head.ch){gv.composing.sel=fx(er(gB.head.line,gz),er(gB.head.line,gz+gx.length))}});d0(gu,"compositionupdate",function(gx){gv.composing.data=gx.data});d0(gu,"compositionend",function(gx){var gy=gv.composing;if(!gy){return}if(gx.data!=gy.startData&&!/\u200b/.test(gx.data)){gy.data=gx.data}setTimeout(function(){if(!gy.handled){gv.applyComposition(gy)}if(gv.composing==gy){gv.composing=null}},50)});d0(gu,"touchstart",function(){gv.forceCompositionEnd()});d0(gu,"input",function(){if(gv.composing){return}if(gs.isReadOnly()||!gv.pollContent()){e2(gv.cm,function(){eM(gs)})}});function gw(gy){if(fv(gs,gy)){return}if(gs.somethingSelected()){cK={lineWise:false,text:gs.getSelections()};if(gy.type=="cut"){gs.replaceSelection("",null,"cut")}}else{if(!gs.options.lineWiseCopyCut){return}else{var gB=ar(gs);cK={lineWise:true,text:gB.text};if(gy.type=="cut"){gs.operation(function(){gs.setSelections(gB.ranges,0,fb);gs.replaceSelection("",null,"cut")})}}}if(gy.clipboardData){gy.clipboardData.clearData();var gx=cK.text.join("\n");gy.clipboardData.setData("Text",gx);if(gy.clipboardData.getData("Text")==gx){gy.preventDefault();return}}var gA=cb(),gC=gA.firstChild;gs.display.lineSpace.insertBefore(gA,gs.display.lineSpace.firstChild);gC.value=cK.text.join("\n");var gz=document.activeElement;fe(gC);setTimeout(function(){gs.display.lineSpace.removeChild(gA);gz.focus();if(gz==gu){gv.showPrimarySelection()}},50)}d0(gu,"copy",gw);d0(gu,"cut",gw)},prepareSelection:function(){var gs=ey(this.cm,false);gs.focus=this.cm.state.focused;return gs},showSelection:function(gs,gt){if(!gs||!this.cm.display.view.length){return}if(gs.focus||gt){this.showPrimarySelection()}this.showMultipleSelections(gs)},showPrimarySelection:function(){var gB=window.getSelection(),gz=this.cm.doc.sel.primary();var gs=aT(this.cm,gB.anchorNode,gB.anchorOffset);var gt=aT(this.cm,gB.focusNode,gB.focusOffset);if(gs&&!gs.bad&&gt&&!gt.bad&&aa(dE(gs,gt),gz.from())==0&&aa(dr(gs,gt),gz.to())==0){return}var gC=eu(this.cm,gz.from());var gv=eu(this.cm,gz.to());if(!gC&&!gv){return}var gD=this.cm.display.view;var gy=gB.rangeCount&&gB.getRangeAt(0);if(!gC){gC={node:gD[0].measure.map[2],offset:0}}else{if(!gv){var gx=gD[gD.length-1].measure;var gw=gx.maps?gx.maps[gx.maps.length-1]:gx.map;gv={node:gw[gw.length-1],offset:gw[gw.length-2]-gw[gw.length-3]}}}try{var gA=eF(gC.node,gC.offset,gv.offset,gv.node)}catch(gu){}if(gA){if(!bJ&&this.cm.state.focused){gB.collapse(gC.node,gC.offset);if(!gA.collapsed){gB.addRange(gA)}}else{gB.removeAllRanges();gB.addRange(gA)}if(gy&&gB.anchorNode==null){gB.addRange(gy)}else{if(bJ){this.startGracePeriod()}}}this.rememberSelection()},startGracePeriod:function(){var gs=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){gs.gracePeriod=false;if(gs.selectionChanged()){gs.cm.operation(function(){gs.cm.curOp.selectionChanged=true})}},20)},showMultipleSelections:function(gs){eR(this.cm.display.cursorDiv,gs.cursors);eR(this.cm.display.selectionDiv,gs.selection)},rememberSelection:function(){var gs=window.getSelection();this.lastAnchorNode=gs.anchorNode;this.lastAnchorOffset=gs.anchorOffset;this.lastFocusNode=gs.focusNode;this.lastFocusOffset=gs.focusOffset},selectionInEditor:function(){var gt=window.getSelection();if(!gt.rangeCount){return false}var gs=gt.getRangeAt(0).commonAncestorContainer;return am(this.div,gs)},focus:function(){if(this.cm.options.readOnly!="nocursor"){this.div.focus()}},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return true},receivedFocus:function(){var gs=this;if(this.selectionInEditor()){this.pollSelection()}else{e2(this.cm,function(){gs.cm.curOp.selectionChanged=true})}function gt(){if(gs.cm.state.focused){gs.pollSelection();gs.polling.set(gs.cm.options.pollInterval,gt)}}this.polling.set(this.cm.options.pollInterval,gt)},selectionChanged:function(){var gs=window.getSelection();return gs.anchorNode!=this.lastAnchorNode||gs.anchorOffset!=this.lastAnchorOffset||gs.focusNode!=this.lastFocusNode||gs.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var gv=window.getSelection(),gt=this.cm;this.rememberSelection();var gs=aT(gt,gv.anchorNode,gv.anchorOffset);var gu=aT(gt,gv.focusNode,gv.focusOffset);if(gs&&gu){e2(gt,function(){fl(gt.doc,fx(gs,gu),fb);if(gs.bad||gu.bad){gt.curOp.selectionChanged=true}})}}},pollContent:function(){var gu=this.cm,gx=gu.display,gK=gu.doc.sel.primary();var gy=gK.from(),gL=gK.to();if(gy.line<gx.viewFrom||gL.line>gx.viewTo-1){return false}var gz;if(gy.line==gx.viewFrom||(gz=bD(gu,gy.line))==0){var gA=cZ(gx.view[0].line);var gB=gx.view[0].node}else{var gA=cZ(gx.view[gz].line);var gB=gx.view[gz-1].node.nextSibling}var gM=bD(gu,gL.line);if(gM==gx.view.length-1){var gN=gx.viewTo-1;var gO=gx.lineDiv.lastChild}else{var gN=cZ(gx.view[gM+1].line)-1;var gO=gx.view[gM+1].node.previousSibling}var gF=gu.doc.splitLines(aS(gu,gB,gO,gA,gN));var gI=bK(gu.doc,er(gA,0),er(gN,bP(gu.doc,gN).text.length));while(gF.length>1&&gI.length>1){if(db(gF)==db(gI)){gF.pop();gI.pop();gN--}else{if(gF[0]==gI[0]){gF.shift();gI.shift();gA++}else{break}}}var gw=0,gv=0;var gG=gF[0],gJ=gI[0],gD=Math.min(gG.length,gJ.length);while(gw<gD&&gG.charCodeAt(gw)==gJ.charCodeAt(gw)){++gw}var gE=db(gF),gH=db(gI);var gC=Math.min(gE.length-(gF.length==1?gw:0),gH.length-(gI.length==1?gw:0));while(gv<gC&&gE.charCodeAt(gE.length-gv-1)==gH.charCodeAt(gH.length-gv-1)){++gv}gF[gF.length-1]=gE.slice(0,gE.length-gv);gF[0]=gF[0].slice(gw);var gs=er(gA,gw);var gt=er(gN,gI.length?db(gI).length-gv:0);if(gF.length>1||gF[0]||aa(gs,gt)){eW(gu.doc,gF,gs,gt,"+input");return true}},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){if(!this.composing||this.composing.handled){return}this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus()},applyComposition:function(gs){if(this.cm.isReadOnly()){ed(this.cm,eM)(this.cm)}else{if(gs.data&&gs.data!=gs.startData){ed(this.cm,l)(this.cm,gs.data,0,gs.sel)}}},setUneditable:function(gs){gs.contentEditable="false"},onKeyPress:function(gs){gs.preventDefault();if(!this.cm.isReadOnly()){ed(this.cm,l)(this.cm,String.fromCharCode(gs.charCode==null?gs.keyCode:gs.charCode),0)}},readOnlyChanged:function(gs){this.div.contentEditable=String(gs!="nocursor")},onContextMenu:dV,resetPosition:dV,needsContentAttribute:true},an.prototype);function eu(gs,gx){var gA=bC(gs,gx.line);if(!gA||gA.hidden){return null}var gu=bP(gs.doc,gx.line);var gt=dk(gA,gu,gx.line);var gv=bV(gu),gz="left";if(gv){var gw=bL(gv,gx.ch);gz=gw%2?"right":"left"}var gy=dQ(gt.map,gx.ch,gz);gy.offset=gy.collapse=="right"?gy.end:gy.start;return gy}function q(gt,gs){if(gs){gt.bad=true}return gt}function aT(gs,gw,gx){var gu;if(gw==gs.display.lineDiv){gu=gs.display.lineDiv.childNodes[gx];if(!gu){return q(gs.clipPos(er(gs.display.viewTo-1)),true)}gw=null;gx=0}else{for(gu=gw;;gu=gu.parentNode){if(!gu||gu==gs.display.lineDiv){return null}if(gu.parentNode&&gu.parentNode==gs.display.lineDiv){break}}}for(var gt=0;gt<gs.display.view.length;gt++){var gv=gs.display.view[gt];if(gv.node==gu){return c8(gv,gw,gx)}}}function c8(gz,gC,gD){var gG=gz.text.firstChild,gt=false;if(!gC||!am(gG,gC)){return q(er(cZ(gz.line),0),true)}if(gC==gG){gt=true;gC=gG.childNodes[gD];gD=0;if(!gC){var gy=gz.rest?db(gz.rest):gz.line;return q(er(cZ(gy),gy.text.length),gt)}}var gE=gC.nodeType==3?gC:null,gF=gC;if(!gE&&gC.childNodes.length==1&&gC.firstChild.nodeType==3){gE=gC.firstChild;if(gD){gD=gE.nodeValue.length}}while(gF.parentNode!=gG){gF=gF.parentNode}var gB=gz.measure,gA=gB.maps;function gw(gO,gP,gN){for(var gJ=-1;gJ<(gA?gA.length:0);gJ++){var gM=gJ<0?gB.map:gA[gJ];for(var gK=0;gK<gM.length;gK+=3){var gI=gM[gK+2];if(gI==gO||gI==gP){var gL=cZ(gJ<0?gz.line:gz.rest[gJ]);var gH=gM[gK]+gN;if(gN<0||gI!=gO){gH=gM[gK+(gN?1:0)]}return er(gL,gH)}}}}var gx=gw(gE,gF,gD);if(gx){return q(gx,gt)}for(var gs=gF.nextSibling,gv=gE?gE.nodeValue.length-gD:0;gs;gs=gs.nextSibling){gx=gw(gs,gs.firstChild,0);if(gx){return q(er(gx.line,gx.ch-gv),gt)}else{gv+=gs.textContent.length}}for(var gu=gF.previousSibling,gv=gD;gu;gu=gu.previousSibling){gx=gw(gu,gu.firstChild,-1);if(gx){return q(er(gx.line,gx.ch+gv),gt)}else{gv+=gu.textContent.length}}}function aS(gt,gu,gz,gv,gA){var gy="",gs=false,gw=gt.doc.lineSeparator();function gx(gC){return function(gD){return gD.id==gC}}function gB(gG){if(gG.nodeType==1){var gC=gG.getAttribute("cm-text");if(gC!=null){if(gC==""){gC=gG.textContent.replace(/\u200b/g,"")}gy+=gC;return}var gF=gG.getAttribute("cm-marker"),gH;if(gF){var gD=gt.findMarks(er(gv,0),er(gA+1,0),gx(+gF));if(gD.length&&(gH=gD[0].find())){gy+=bK(gt.doc,gH.from,gH.to).join(gw)}return}if(gG.getAttribute("contenteditable")=="false"){return}for(var gE=0;gE<gG.childNodes.length;gE++){gB(gG.childNodes[gE])}if(/^(pre|div|p)$/i.test(gG.nodeName)){gs=true}}else{if(gG.nodeType==3){var gI=gG.nodeValue;if(!gI){return}if(gs){gy+=gw;gs=false}gy+=gI}}}for(;;){gB(gu);if(gu==gz){break}gu=gu.nextSibling}return gy}ab.inputStyles={textarea:fO,contenteditable:an};function ff(gt,gs){this.ranges=gt;this.primIndex=gs}ff.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(gu){if(gu==this){return true}if(gu.primIndex!=this.primIndex||gu.ranges.length!=this.ranges.length){return false}for(var gt=0;gt<this.ranges.length;gt++){var gs=this.ranges[gt],gv=gu.ranges[gt];if(aa(gs.anchor,gv.anchor)!=0||aa(gs.head,gv.head)!=0){return false}}return true},deepCopy:function(){for(var gt=[],gs=0;gs<this.ranges.length;gs++){gt[gs]=new eG(av(this.ranges[gs].anchor),av(this.ranges[gs].head))}return new ff(gt,this.primIndex)},somethingSelected:function(){for(var gs=0;gs<this.ranges.length;gs++){if(!this.ranges[gs].empty()){return true}}return false},contains:function(gu,gs){if(!gs){gs=gu}for(var gt=0;gt<this.ranges.length;gt++){var gv=this.ranges[gt];if(aa(gs,gv.from())>=0&&aa(gu,gv.to())<=0){return gt}}return -1}};function eG(gs,gt){this.anchor=gs;this.head=gt}eG.prototype={from:function(){return dE(this.anchor,this.head)},to:function(){return dr(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function dU(gz,gy){var gx=gz[gy];gz.sort(function(gB,gC){return aa(gB.from(),gC.from())});gy=cl(gz,gx);for(var gu=1;gu<gz.length;gu++){var gs=gz[gu],gw=gz[gu-1];if(aa(gw.to(),gs.from())>=0){var gt=dE(gw.from(),gs.from()),gA=dr(gw.to(),gs.to());var gv=gw.empty()?gs.from()==gs.head:gw.from()==gw.head;if(gu<=gy){--gy}gz.splice(--gu,2,new eG(gv?gA:gt,gv?gt:gA))}}return new ff(gz,gy)}function fx(gs,gt){return new ff([new eG(gs,gt||gs)],0)}function W(gs,gt){return Math.max(gs.first,Math.min(gt,gs.first+gs.size-1))}function X(gs,gu){if(gu.line<gs.first){return er(gs.first,0)}var gt=gs.first+gs.size-1;if(gu.line>gt){return er(gt,bP(gs,gt).text.length)}return Z(gu,bP(gs,gu.line).text.length)}function Z(gu,gt){var gs=gu.ch;if(gs==null||gs>gt){return er(gu.line,gt)}else{if(gs<0){return er(gu.line,0)}else{return gu}}}function cy(gs,gt){return gt>=gs.first&&gt<gs.first+gs.size}function Y(gt,gs){for(var gv=[],gu=0;gu<gs.length;gu++){gv[gu]=X(gt,gs[gu])}return gv}function bo(gt,gx,gu,gv){if(gt.cm&&gt.cm.display.shift||gt.extend){var gs=gx.anchor;if(gv){var gw=aa(gu,gs)<0;if(gw!=(aa(gv,gs)<0)){gs=gu;gu=gv}else{if(gw!=(aa(gu,gv)<0)){gu=gv}}}return new eG(gs,gu)}else{return new eG(gv||gu,gu)}}function bp(gs,gt,gv,gu){fl(gs,new ff([bo(gs,gs.sel.primary(),gt,gv)],0),gu)}function bq(gs,gt,gw){for(var gx=[],gu=0;gu<gs.sel.ranges.length;gu++){gx[gu]=bo(gs,gs.sel.ranges[gu],gt[gu],null)}var gv=dU(gx,gs.sel.primIndex);fl(gs,gv,gw)}function eV(gs,gt,gv,gu){var gw=gs.sel.ranges.slice(0);gw[gt]=gv;fl(gs,dU(gw,gs.sel.primIndex),gu)}function fp(gt,gs,gu,gv){fl(gt,fx(gs,gu),gv)}function bv(gs,gv,gu){var gt={ranges:gv.ranges,update:function(gx){this.ranges=[];for(var gw=0;gw<gx.length;gw++){this.ranges[gw]=new eG(X(gs,gx[gw].anchor),X(gs,gx[gw].head))}},origin:gu&&gu.origin};ft(gs,"beforeSelectionChange",gs,gt);if(gs.cm){ft(gs.cm,"beforeSelectionChange",gs.cm,gt)}if(gt.ranges!=gv.ranges){return dU(gt.ranges,gt.ranges.length-1)}else{return gv}}function fo(gs,gw,gv){var gt=gs.history.done,gu=db(gt);if(gu&&gu.ranges){gt[gt.length-1]=gw;fn(gs,gw,gv)}else{fl(gs,gw,gv)}}function fl(gs,gu,gt){fn(gs,gu,gt);f(gs,gs.sel,gs.cm?gs.cm.curOp.id:NaN,gt)}function fn(gt,gv,gu){if(b7(gt,"beforeSelectionChange")||gt.cm&&b7(gt.cm,"beforeSelectionChange")){gv=bv(gt,gv,gu)}var gs=gu&&gu.bias||(aa(gv.primary().head,gt.sel.primary().head)<0?-1:1);fm(gt,fA(gt,gv,gs,true));if(!(gu&&gu.scroll===false)&&gt.cm){bd(gt.cm)}}function fm(gs,gt){if(gt.equals(gs.sel)){return}gs.sel=gt;if(gs.cm){gs.cm.curOp.updateInput=gs.cm.curOp.selectionChanged=true;fu(gs.cm)}fw(gs,"cursorActivity",gs)}function eL(gs){fm(gs,fA(gs,gs.sel,null,false),fb)}function fA(gt,gB,gs,gv){var gz;for(var gu=0;gu<gB.ranges.length;gu++){var gA=gB.ranges[gu];var gy=gB.ranges.length==gt.sel.ranges.length&&gt.sel.ranges[gu];var gw=fy(gt,gA.anchor,gy&&gy.anchor,gs,gv);var gx=fy(gt,gA.head,gy&&gy.head,gs,gv);if(gz||gw!=gA.anchor||gx!=gA.head){if(!gz){gz=gB.ranges.slice(0,gu)}gz[gu]=new eG(gw,gx)}}return gz?dU(gz,gB.primIndex):gB}function fz(gu,gC,gB,gt,gz){var gx=bP(gu,gC.line);if(gx.markedSpans){for(var gw=0;gw<gx.markedSpans.length;++gw){var gD=gx.markedSpans[gw],gy=gD.marker;if((gD.from==null||(gy.inclusiveLeft?gD.from<=gC.ch:gD.from<gC.ch))&&(gD.to==null||(gy.inclusiveRight?gD.to>=gC.ch:gD.to>gC.ch))){if(gz){ft(gy,"beforeCursorEnter");if(gy.explicitlyCleared){if(!gx.markedSpans){break}else{--gw;continue}}}if(!gy.atomic){continue}if(gB){var gA=gy.find(gt<0?1:-1),gs;if(gt<0?gy.inclusiveRight:gy.inclusiveLeft){gA=dK(gu,gA,-gt,gA&&gA.line==gC.line?gx:null)}if(gA&&gA.line==gC.line&&(gs=aa(gA,gB))&&(gt<0?gs<0:gs>0)){return fz(gu,gA,gC,gt,gz)}}var gv=gy.find(gt<0?-1:1);if(gt<0?gy.inclusiveLeft:gy.inclusiveRight){gv=dK(gu,gv,gt,gv.line==gC.line?gx:null)}return gv?fz(gu,gv,gC,gt,gz):null}}}return gC}function fy(gu,gy,gx,gs,gw){var gt=gs||1;var gv=fz(gu,gy,gx,gt,gw)||(!gw&&fz(gu,gy,gx,gt,true))||fz(gu,gy,gx,-gt,gw)||(!gw&&fz(gu,gy,gx,-gt,true));if(!gv){gu.cantEdit=true;return er(gu.first,0)}return gv}function dK(gt,gv,gs,gu){if(gs<0&&gv.ch==0){if(gv.line>gt.first){return X(gt,er(gv.line-1))}else{return null}}else{if(gs>0&&gv.ch==(gu||bP(gt,gv.line)).text.length){if(gv.line<gt.first+gt.size-1){return er(gv.line+1,0)}else{return null}}else{return new er(gv.line,gv.ch+gs)}}}function ga(gs){gs.display.input.showSelection(gs.display.input.prepareSelection())}function ey(gs,gx){var gv=gs.doc,gz={};var gu=gz.cursors=document.createDocumentFragment();var gA=gz.selection=document.createDocumentFragment();for(var gw=0;gw<gv.sel.ranges.length;gw++){if(gx===false&&gw==gv.sel.primIndex){continue}var gy=gv.sel.ranges[gw];if(gy.from().line>=gs.display.viewTo||gy.to().line<gs.display.viewFrom){continue}var gt=gy.empty();if(gt||gs.options.showCursorWhenSelecting){aX(gs,gy.head,gu)}if(!gt){aY(gs,gy,gA)}}return gz}function aX(gs,gu,gw){var gx=aB(gs,gu,"div",null,null,!gs.options.singleCursorHeightPerLine);var gt=gw.appendChild(a5("div","\u00a0","CodeMirror-cursor"));gt.style.left=gx.left+"px";gt.style.top=gx.top+"px";gt.style.height=Math.max(0,gx.bottom-gx.top)*gs.options.cursorHeight+"px";if(gx.other){var gv=gw.appendChild(a5("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));gv.style.display="";gv.style.left=gx.other.left+"px";gv.style.top=gx.other.top+"px";gv.style.height=(gx.other.bottom-gx.other.top)*0.85+"px"}}function aY(gt,gD,gB){var gu=gt.display,gv=gt.doc;var gx=document.createDocumentFragment();var gC=ei(gt.display),gA=gC.left;var gE=Math.max(gu.sizerWidth,aO(gt)-gu.sizer.offsetLeft)-gC.right;function gs(gL,gM,gN,gK){if(gM<0){gM=0}gM=Math.round(gM);gK=Math.round(gK);gx.appendChild(a5("div",null,"CodeMirror-selected","position: absolute; left: "+gL+"px; top: "+gM+"px; width: "+(gN==null?gE-gL:gN)+"px; height: "+(gK-gM)+"px"))}function gw(gN,gM,gR){var gP=bP(gv,gN);var gO=gP.text.length;var gQ,gL;function gK(gT,gS){return J(gt,er(gN,gT),"div",gP,gS)}cD(bV(gP),gM||0,gR==null?gO:gR,function(gT,gZ,gS){var gV=gK(gT,"left"),gX,gU,gW;if(gT==gZ){gX=gV;gU=gW=gV.left}else{gX=gK(gZ-1,"right");if(gS=="rtl"){var gY=gV;gV=gX;gX=gY}gU=gV.left;gW=gX.right}if(gM==null&&gT==0){gU=gA}if(gX.top-gV.top>3){gs(gU,gV.top,null,gV.bottom);gU=gA;if(gV.bottom<gX.top){gs(gU,gV.bottom,null,gX.top)}}if(gR==null&&gZ==gO){gW=gE}if(!gQ||gV.top<gQ.top||gV.top==gQ.top&&gV.left<gQ.left){gQ=gV}if(!gL||gX.bottom>gL.bottom||gX.bottom==gL.bottom&&gX.right>gL.right){gL=gX}if(gU<gA+1){gU=gA}gs(gU,gX.top,gW-gU,gX.bottom)});return{start:gQ,end:gL}}var gG=gD.from(),gI=gD.to();if(gG.line==gI.line){gw(gG.line,gG.ch,gI.ch)}else{var gy=bP(gv,gG.line),gJ=bP(gv,gI.line);var gH=gf(gy)==gf(gJ);var gz=gw(gG.line,gG.ch,gH?gy.text.length+1:null).end;var gF=gw(gI.line,gH?0:null,gI.ch).start;if(gH){if(gz.top<gF.top-2){gs(gz.right,gz.top,null,gz.bottom);gs(gA,gF.top,gF.left,gF.bottom)}else{gs(gz.right,gz.top,gF.left-gz.right,gz.bottom)}}if(gz.bottom<gF.top){gs(gA,gz.bottom,null,gF.top)}}gB.appendChild(gx)}function e0(gs){if(!gs.state.focused){return}var gt=gs.display;clearInterval(gt.blinker);var gu=true;gt.cursorDiv.style.visibility="";if(gs.options.cursorBlinkRate>0){gt.blinker=setInterval(function(){gt.cursorDiv.style.visibility=(gu=!gu)?"":"hidden"},gs.options.cursorBlinkRate)}else{if(gs.options.cursorBlinkRate<0){gt.cursorDiv.style.visibility="hidden"}}}function fH(gs,gt){if(gs.doc.mode.startState&&gs.doc.frontier<gs.display.viewTo){gs.state.highlight.set(gt,w(cd,gs))}}function cd(gt){var gu=gt.doc;if(gu.frontier<gu.first){gu.frontier=gu.first}if(gu.frontier>=gt.display.viewTo){return}var gv=+new Date+gt.options.workTime;var gw=ax(gu.mode,bW(gt,gu.frontier));var gs=[];gu.iter(gu.frontier,Math.min(gu.first+gu.size,gt.display.viewTo+500),function(gA){if(gu.frontier>=gt.display.viewFrom){var gD=gA.styles,gE=gA.text.length>gt.options.maxHighlightLength;var gx=cc(gt,gA,gE?ax(gu.mode,gw):gw,true);gA.styles=gx.styles;var gC=gA.styleClasses,gB=gx.classes;if(gB){gA.styleClasses=gB}else{if(gC){gA.styleClasses=null}}var gz=!gD||gD.length!=gA.styles.length||gC!=gB&&(!gC||!gB||gC.bgClass!=gB.bgClass||gC.textClass!=gB.textClass);for(var gy=0;!gz&&gy<gD.length;++gy){gz=gD[gy]!=gA.styles[gy]}if(gz){gs.push(gu.frontier)}gA.stateAfter=gE?gw:ax(gu.mode,gw)}else{if(gA.text.length<=gt.options.maxHighlightLength){eB(gt,gA.text,gw)}gA.stateAfter=gu.frontier%5==0?ax(gu.mode,gw):null}++gu.frontier;if(+new Date>gv){fH(gt,gt.options.workDelay);return true}});if(gs.length){e2(gt,function(){for(var gx=0;gx<gs.length;gx++){eP(gt,gs[gx],"text")}})}}function bB(gs,gz,gA){var gx,gy,gt=gs.doc;var gv=gA?-1:gz-(gs.doc.mode.innerMode?1000:100);for(var gB=gz;gB>gv;--gB){if(gB<=gt.first){return gt.first}var gw=bP(gt,gB-1);if(gw.stateAfter&&(!gA||gB<=gt.frontier)){return gB}var gu=ay(gw.text,null,gs.options.tabSize);if(gy==null||gx>gu){gy=gB-1;gx=gu}}return gy}function bW(gs,gv,gx){var gu=gs.doc,gt=gs.display;if(!gu.mode.startState){return true}var gw=bB(gs,gv,gx),gy=gw>gu.first&&bP(gu,gw-1).stateAfter;if(!gy){gy=fG(gu.mode)}else{gy=ax(gu.mode,gy)}gu.iter(gw,gv,function(gz){eB(gs,gz.text,gy);var gA=gw==gv-1||gw%5==0||gw>=gt.viewFrom&&gw<gt.viewTo;gz.stateAfter=gA?ax(gu.mode,gy):null;++gw});if(gx){gu.frontier=gw}return gy}function ej(gs){return gs.lineSpace.offsetTop}function ek(gs){return gs.mover.offsetHeight-gs.lineSpace.offsetHeight}function ei(gt){if(gt.cachedPaddingH){return gt.cachedPaddingH}var gu=eR(gt.measure,a5("pre","x"));var gv=window.getComputedStyle?window.getComputedStyle(gu):gu.currentStyle;var gs={left:parseInt(gv.paddingLeft),right:parseInt(gv.paddingRight)};if(!isNaN(gs.left)&&!isNaN(gs.right)){gt.cachedPaddingH=gs}return gs}function e8(gs){return e7-gs.display.nativeBarWidth}function aO(gs){return gs.display.scroller.clientWidth-e8(gs)-gs.display.barWidth}function aM(gs){return gs.display.scroller.clientHeight-e8(gs)-gs.display.barHeight}function bg(gs,gx,gz){var gB=gs.options.lineWrapping;var gu=gB&&aO(gs);if(!gx.measure.heights||gB&&gx.measure.width!=gu){var gv=gx.measure.heights=[];if(gB){gx.measure.width=gu;var gA=gx.text.firstChild.getClientRects();for(var gw=0;gw<gA.length-1;gw++){var gt=gA[gw],gy=gA[gw+1];if(Math.abs(gt.bottom-gy.bottom)>2){gv.push((gt.bottom+gy.top)/2-gz.top)}}}gv.push(gz.bottom-gz.top)}}function dk(gv,gt,gu){if(gv.line==gt){return{map:gv.measure.map,cache:gv.measure.cache}}for(var gs=0;gs<gv.rest.length;gs++){if(gv.rest[gs]==gt){return{map:gv.measure.maps[gs],cache:gv.measure.caches[gs]}}}for(var gs=0;gs<gv.rest.length;gs++){if(cZ(gv.rest[gs])>gu){return{map:gv.measure.maps[gs],cache:gv.measure.caches[gs],before:true}}}}function fW(gt,gu){gu=gf(gu);var gv=cZ(gu);var gw=gt.display.externalMeasured=new c4(gt.doc,gu,gv);gw.lineN=gv;var gs=gw.built=z(gt,gw);gw.text=gs.pre;eR(gt.display.lineMeasure,gs.pre);return gw}function dw(gu,gv,gt,gs){return dy(gu,ex(gu,gv),gt,gs)}function bC(gs,gu){if(gu>=gs.display.viewFrom&&gu<gs.display.viewTo){return gs.display.view[bD(gs,gu)]}var gt=gs.display.externalMeasured;if(gt&&gu>=gt.lineN&&gu<gt.lineN+gt.size){return gt}}function ex(gs,gu){var gv=cZ(gu);var gw=bC(gs,gv);if(gw&&!gw.text){gw=null}else{if(gw&&gw.changes){f3(gs,gw,gv,bM(gs));gs.curOp.forceUpdate=true}}if(!gw){gw=fW(gs,gu)}var gt=dk(gw,gu,gv);return{line:gu,view:gw,rect:null,map:gt.map,cache:gt.cache,before:gt.before,hasHeights:false}}function dy(gu,gx,gt,gs,gy){if(gx.before){gt=-1}var gw=gt+(gs||""),gv;if(gx.cache.hasOwnProperty(gw)){gv=gx.cache[gw]}else{if(!gx.rect){gx.rect=gx.view.text.getBoundingClientRect()}if(!gx.hasHeights){bg(gu,gx.view,gx.rect);gx.hasHeights=true}gv=dx(gu,gx,gt,gs);if(!gv.bogus){gx.cache[gw]=gv}}return{left:gv.left,right:gv.right,top:gy?gv.rtop:gv.top,bottom:gy?gv.rbottom:gv.bottom}}var dW={left:0,right:0,top:0,bottom:0};function dQ(gx,gt,gs){var gA,gB,gv,gu;for(var gw=0;gw<gx.length;gw+=3){var gz=gx[gw],gy=gx[gw+1];if(gt<gz){gB=0;gv=1;gu="left"}else{if(gt<gy){gB=gt-gz;gv=gB+1}else{if(gw==gx.length-3||gt==gy&&gx[gw+3]>gt){gv=gy-gz;gB=gv-1;if(gt>=gy){gu="right"}}}}if(gB!=null){gA=gx[gw+2];if(gz==gy&&gs==(gA.insertLeft?"left":"right")){gu=gs}if(gs=="left"&&gB==0){while(gw&&gx[gw-2]==gx[gw-3]&&gx[gw-1].insertLeft){gA=gx[(gw-=3)+2];gu="left"}}if(gs=="right"&&gB==gy-gz){while(gw<gx.length-3&&gx[gw+3]==gx[gw+4]&&!gx[gw+5].insertLeft){gA=gx[(gw+=3)+2];gu="right"}}break}}return{node:gA,start:gB,end:gv,collapse:gu,coverStart:gz,coverEnd:gy}}function bX(gv,gs){var gu=dW;if(gs=="left"){for(var gt=0;gt<gv.length;gt++){if((gu=gv[gt]).left!=gu.right){break}}}else{for(var gt=gv.length-1;gt>=0;gt--){if((gu=gv[gt]).left!=gu.right){break}}}return gu}function dx(gv,gD,gu,gs){var gC=dQ(gD.map,gu,gs);var gB=gC.node,gK=gC.start,gx=gC.end,gw=gC.collapse;var gF;if(gB.nodeType==3){for(var gz=0;gz<4;gz++){while(gK&&cx(gD.line.text.charAt(gC.coverStart+gK))){--gK}while(gC.coverStart+gx<gC.coverEnd&&cx(gD.line.text.charAt(gC.coverStart+gx))){++gx}if(cg&&cj<9&&gK==0&&gx==gC.coverEnd-gC.coverStart){gF=gB.parentNode.getBoundingClientRect()}else{gF=bX(eF(gB,gK,gx).getClientRects(),gs)}if(gF.left||gF.right||gK==0){break}gx=gK;gK=gK-1;gw="right"}if(cg&&cj<11){gF=dv(gv.display.measure,gF)}}else{if(gK>0){gw=gs="right"}var gG;if(gv.options.lineWrapping&&(gG=gB.getClientRects()).length>1){gF=gG[gs=="right"?gG.length-1:0]}else{gF=gB.getBoundingClientRect()}}if(cg&&cj<9&&!gK&&(!gF||!gF.left&&!gF.right)){var gI=gB.parentNode.getClientRects()[0];if(gI){gF={left:gI.left,right:gI.left+K(gv.display),top:gI.top,bottom:gI.bottom}}else{gF=dW}}var gJ=gF.top-gD.rect.top,gE=gF.bottom-gD.rect.top;var gA=(gJ+gE)/2;var gy=gD.view.measure.heights;for(var gz=0;gz<gy.length-1;gz++){if(gA<gy[gz]){break}}var gL=gz?gy[gz-1]:0,gt=gy[gz];var gH={left:(gw=="right"?gF.right:gF.left)-gD.rect.left,right:(gw=="left"?gF.left:gF.right)-gD.rect.left,top:gL,bottom:gt};if(!gF.left&&!gF.right){gH.bogus=true}if(!gv.options.singleCursorHeightPerLine){gH.rtop=gJ;gH.rbottom=gE}return gH}function dv(gs,gt){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!b5(gs)){return gt}var gu=screen.logicalXDPI/screen.deviceXDPI;var gv=screen.logicalYDPI/screen.deviceYDPI;return{left:gt.left*gu,right:gt.right*gu,top:gt.top*gv,bottom:gt.bottom*gv}}function T(gt){if(gt.measure){gt.measure.cache={};gt.measure.heights=null;if(gt.rest){for(var gs=0;gs<gt.rest.length;gs++){gt.measure.caches[gs]={}}}}}function S(gs){gs.display.externalMeasure=null;eQ(gs.display.lineMeasure);for(var gt=0;gt<gs.display.view.length;gt++){T(gs.display.view[gt])}}function P(gs){S(gs);gs.display.cachedCharWidth=gs.display.cachedTextHeight=gs.display.cachedPaddingH=null;if(!gs.options.lineWrapping){gs.display.maxLineChanged=true}gs.display.lineNumChars=null}function el(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function em(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function cu(gs,gv,gx,gt){if(gv.widgets){for(var gu=0;gu<gv.widgets.length;++gu){if(gv.widgets[gu].above){var gy=gn(gv.widgets[gu]);gx.top+=gy;gx.bottom+=gy}}}if(gt=="line"){return gx}if(!gt){gt="local"}var gA=b9(gv);if(gt=="local"){gA+=ej(gs.display)}else{gA-=gs.display.viewOffset}if(gt=="page"||gt=="window"){var gw=gs.display.lineSpace.getBoundingClientRect();gA+=gw.top+(gt=="window"?0:em());var gz=gw.left+(gt=="window"?0:el());gx.left+=gz;gx.right+=gz}gx.top+=gA;gx.bottom+=gA;return gx}function bI(gs,gu,gt){if(gt=="div"){return gu}var gv=gu.left,gy=gu.top;if(gt=="page"){gv-=el();gy-=em()}else{if(gt=="local"||!gt){var gx=gs.display.sizer.getBoundingClientRect();gv+=gx.left;gy+=gx.top}}var gw=gs.display.lineSpace.getBoundingClientRect();return{left:gv-gw.left,top:gy-gw.top}}function J(gt,gw,gu,gv,gs){if(!gv){gv=bP(gt.doc,gw.line)}return cu(gt,gv,dw(gt,gv,gw.ch,gs),gu)}function aB(gt,gA,gu,gx,gB,gD){gx=gx||bP(gt.doc,gA.line);if(!gB){gB=ex(gt,gx)}function gv(gE,gG){var gF=dy(gt,gB,gE,gG?"right":"left",gD);if(gG){gF.left=gF.right}else{gF.right=gF.left}return cu(gt,gx,gF,gu)}function gw(gE,gG){var gF=gy[gG],gH=gF.level%2;if(gE==s(gF)&&gG&&gF.level<gy[gG-1].level){gF=gy[--gG];gE=v(gF)-(gF.level%2?0:1);gH=true}else{if(gE==v(gF)&&gG<gy.length-1&&gF.level<gy[gG+1].level){gF=gy[++gG];gE=s(gF)-gF.level%2;gH=false}}if(gH&&gE==gF.to&&gE>gF.from){return gv(gE-1)}return gv(gE,gH)}var gy=bV(gx),gs=gA.ch;if(!gy){return gv(gs)}var gz=bL(gy,gs);var gC=gw(gs,gz);if(u!=null){gC.other=gw(gs,u)}return gC}function bi(gs,gv){var gt=0,gv=X(gs.doc,gv);if(!gs.options.lineWrapping){gt=K(gs.display)*gv.ch}var gu=bP(gs.doc,gv.line);var gw=b9(gu)+ej(gs.display);return{left:gt,right:gt,top:gw,bottom:gw+gu.height}}function ew(gt,gs,gu,gw){var gv=er(gt,gs);gv.xRel=gw;if(gu){gv.outside=true}return gv}function ap(gs,gA,gB){var gt=gs.doc;gB+=gs.display.viewOffset;if(gB<0){return ew(gt.first,0,true,-1)}var gw=cT(gt,gB),gv=gt.first+gt.size-1;if(gw>gv){return ew(gt.first+gt.size-1,bP(gt,gv).text.length,true,1)}if(gA<0){gA=0}var gx=bP(gt,gw);for(;;){var gu=aq(gs,gx,gw,gA,gB);var gy=ac(gx);var gz=gy&&gy.find(0,true);if(gy&&(gu.ch>gz.from.ch||gu.ch==gz.from.ch&&gu.xRel>0)){gw=cZ(gx=gz.to.line)}else{return gu}}}function aq(gw,gF,gE,gQ,gS){var gD=gS-b9(gF);var gP=false,gs=2*gw.display.wrapper.clientWidth;var gK=ex(gw,gF);function gB(gT){var gU=aB(gw,er(gE,gT),"line",gF,gK);gP=true;if(gD>gU.bottom){return gU.left-gs}else{if(gD<gU.top){return gU.left+gs}else{gP=false}}return gU.left}var gt=bV(gF),gx=gF.text.length;var gy=cX(gF),gM=c1(gF);var gA=gB(gy),gz=gP,gO=gB(gM),gN=gP;if(gQ>gO){return ew(gE,gM,gN,1)}for(;;){if(gt?gM==gy||gM==dL(gF,gy,1):gM-gy<=1){var gu=gQ<gA||gQ-gA<=gO-gQ?gy:gM;var gI=gu==gy?gz:gN;var gR=gQ-(gu==gy?gA:gO);if(gN&&!gt&&!/\s/.test(gF.text.charAt(gu))&&gR>0&&gu<gF.text.length&&gK.view.measure.heights.length>1){var gv=dy(gw,gK,gu,"right");if(gD<=gv.bottom&&gD>=gv.top&&Math.abs(gQ-gv.right)<gR){gI=false;gu++;gR=gQ-gv.right}}while(cx(gF.text.charAt(gu))){++gu}var gJ=ew(gE,gu,gI,gR<-1?-1:gR>1?1:0);return gJ}var gL=Math.ceil(gx/2),gG=gy+gL;if(gt){gG=gy;for(var gC=0;gC<gL;++gC){gG=dL(gF,gG,1)}}var gH=gB(gG);if(gH>gQ){gM=gG;gO=gH;if(gN=gP){gO+=1000}gx=gL}else{gy=gG;gA=gH;gz=gP;gx-=gL}}}var dA;function fP(gs){if(gs.cachedTextHeight!=null){return gs.cachedTextHeight}if(dA==null){dA=a5("pre");for(var gu=0;gu<49;++gu){dA.appendChild(document.createTextNode("x"));dA.appendChild(a5("br"))}dA.appendChild(document.createTextNode("x"))}eR(gs.measure,dA);var gt=dA.offsetHeight/50;if(gt>3){gs.cachedTextHeight=gt}eQ(gs.measure);return gt||1}function K(gt){if(gt.cachedCharWidth!=null){return gt.cachedCharWidth}var gs=a5("span","xxxxxxxxxx");var gu=a5("pre",[gs]);eR(gt.measure,gu);var gv=gs.getBoundingClientRect(),gw=(gv.right-gv.left)/10;if(gw>2){gt.cachedCharWidth=gw}return gw||10}var ee=null;var dP=0;function fF(gs){gs.curOp={cm:gs,viewChanged:false,startHeight:gs.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++dP};if(ee){ee.ops.push(gs.curOp)}else{gs.curOp.ownsGroup=ee={ops:[gs.curOp],delayedCallbacks:[]}}}function bE(gt){var gs=gt.delayedCallbacks,gu=0;do{for(;gu<gs.length;gu++){gs[gu].call(null)}for(var gv=0;gv<gt.ops.length;gv++){var gw=gt.ops[gv];if(gw.cursorActivityHandlers){while(gw.cursorActivityCalled<gw.cursorActivityHandlers.length){gw.cursorActivityHandlers[gw.cursorActivityCalled++].call(null,gw.cm)}}}}while(gu<gs.length)}function a6(gs){var gv=gs.curOp,gt=gv.ownsGroup;if(!gt){return}try{bE(gt)}finally{ee=null;for(var gu=0;gu<gt.ops.length;gu++){gt.ops[gu].cm.curOp=null}bc(gt)}}function bc(gs){var gu=gs.ops;for(var gt=0;gt<gu.length;gt++){a8(gu[gt])}for(var gt=0;gt<gu.length;gt++){ba(gu[gt])}for(var gt=0;gt<gu.length;gt++){a9(gu[gt])}for(var gt=0;gt<gu.length;gt++){bb(gu[gt])}for(var gt=0;gt<gu.length;gt++){a7(gu[gt])}}function a8(gu){var gs=gu.cm,gt=gs.display;ds(gs);if(gu.updateMaxLine){bx(gs)}gu.mustUpdate=gu.viewChanged||gu.forceUpdate||gu.scrollTop!=null||gu.scrollToPos&&(gu.scrollToPos.from.line<gt.viewFrom||gu.scrollToPos.to.line>=gt.viewTo)||gt.maxLineChanged&&gs.options.lineWrapping;gu.update=gu.mustUpdate&&new aN(gs,gu.mustUpdate&&{top:gu.scrollTop,ensure:gu.scrollToPos},gu.forceUpdate)}function ba(gs){gs.updatedDisplay=gs.mustUpdate&&fT(gs.cm,gs.update)}function a9(gu){var gs=gu.cm,gt=gs.display;if(gu.updatedDisplay){fZ(gs)}gu.barMeasure=dz(gs);if(gt.maxLineChanged&&!gs.options.lineWrapping){gu.adjustWidthTo=dw(gs,gt.maxLine,gt.maxLine.text.length).left+3;gs.display.sizerWidth=gu.adjustWidthTo;gu.barMeasure.scrollWidth=Math.max(gt.scroller.clientWidth,gt.sizer.offsetLeft+gu.adjustWidthTo+e8(gs)+gs.display.barWidth);gu.maxScrollLeft=Math.max(0,gt.sizer.offsetLeft+gu.adjustWidthTo-aO(gs))}if(gu.updatedDisplay||gu.selectionChanged){gu.preparedSelection=gt.input.prepareSelection(gu.focus)}}function bb(gt){var gs=gt.cm;if(gt.adjustWidthTo!=null){gs.display.sizer.style.minWidth=gt.adjustWidthTo+"px";if(gt.maxScrollLeft<gs.doc.scrollLeft){fj(gs,Math.min(gs.display.scroller.scrollLeft,gt.maxScrollLeft),true)}gs.display.maxLineChanged=false}var gu=gt.focus&&gt.focus==a()&&(!document.hasFocus||document.hasFocus());if(gt.preparedSelection){gs.display.input.showSelection(gt.preparedSelection,gu)}if(gt.updatedDisplay||gt.startHeight!=gs.doc.height){f8(gs,gt.barMeasure)}if(gt.updatedDisplay){fh(gs,gt.barMeasure)}if(gt.selectionChanged){e0(gs)}if(gs.state.focused&&gt.updateInput){gs.display.input.reset(gt.typing)}if(gu){be(gt.cm)}}function a7(gy){var gs=gy.cm,gu=gs.display,gv=gs.doc;if(gy.updatedDisplay){ev(gs,gy.update)}if(gu.wheelStartX!=null&&(gy.scrollTop!=null||gy.scrollLeft!=null||gy.scrollToPos)){gu.wheelStartX=gu.wheelStartY=null}if(gy.scrollTop!=null&&(gu.scroller.scrollTop!=gy.scrollTop||gy.forceScroll)){gv.scrollTop=Math.max(0,Math.min(gu.scroller.scrollHeight-gu.scroller.clientHeight,gy.scrollTop));gu.scrollbars.setScrollTop(gv.scrollTop);gu.scroller.scrollTop=gv.scrollTop}if(gy.scrollLeft!=null&&(gu.scroller.scrollLeft!=gy.scrollLeft||gy.forceScroll)){gv.scrollLeft=Math.max(0,Math.min(gu.scroller.scrollWidth-gu.scroller.clientWidth,gy.scrollLeft));gu.scrollbars.setScrollLeft(gv.scrollLeft);gu.scroller.scrollLeft=gv.scrollLeft;k(gs)}if(gy.scrollToPos){var gt=fa(gs,X(gv,gy.scrollToPos.from),X(gv,gy.scrollToPos.to),gy.scrollToPos.margin);if(gy.scrollToPos.isCursor&&gs.state.focused){dt(gs,gt)}}var gw=gy.maybeHiddenMarkers,gz=gy.maybeUnhiddenMarkers;if(gw){for(var gx=0;gx<gw.length;++gx){if(!gw[gx].lines.length){ft(gw[gx],"hide")}}}if(gz){for(var gx=0;gx<gz.length;++gx){if(gz[gx].lines.length){ft(gz[gx],"unhide")}}}if(gu.wrapper.offsetHeight){gv.scrollTop=gs.display.scroller.scrollTop}if(gy.changeObjs){ft(gs,"changes",gs,gy.changeObjs)}if(gy.update){gy.update.finish()}}function e2(gs,gt){if(gs.curOp){return gt()}fF(gs);try{return gt()}finally{a6(gs)}}function ed(gs,gt){return function(){if(gs.curOp){return gt.apply(gs,arguments)}fF(gs);try{return gt.apply(gs,arguments)}finally{a6(gs)}}}function dC(gs){return function(){if(this.curOp){return gs.apply(this,arguments)}fF(this);try{return gs.apply(this,arguments)}finally{a6(this)}}}function aQ(gs){return function(){var gt=this.cm;if(!gt||gt.curOp){return gs.apply(this,arguments)}fF(gt);try{return gs.apply(this,arguments)}finally{a6(gt)}}}function c4(gs,gt,gu){this.line=gt;this.rest=gg(gt);this.size=this.rest?cZ(db(this.rest))-gu+1:1;this.node=this.text=null;this.hidden=cV(gs,gt)}function D(gt,gu,gx){var gs=[],gv;for(var gw=gu;gw<gx;gw=gv){var gy=new c4(gt.doc,bP(gt.doc,gw),gw);gv=gw+gy.size;gs.push(gy)}return gs}function eM(gs,gy,gA,gz){if(gy==null){gy=gs.doc.first}if(gA==null){gA=gs.doc.first+gs.doc.size}if(!gz){gz=0}var gw=gs.display;if(gz&&gA<gw.viewTo&&(gw.updateLineNumbers==null||gw.updateLineNumbers>gy)){gw.updateLineNumbers=gy}gs.curOp.viewChanged=true;if(gy>=gw.viewTo){if(e5&&gi(gs.doc,gy)<gw.viewTo){eY(gs)}}else{if(gA<=gw.viewFrom){if(e5&&gh(gs.doc,gA+gz)>gw.viewFrom){eY(gs)}else{gw.viewFrom+=gz;gw.viewTo+=gz}}else{if(gy<=gw.viewFrom&&gA>=gw.viewTo){eY(gs)}else{if(gy<=gw.viewFrom){var gt=gd(gs,gA,gA+gz,1);if(gt){gw.view=gw.view.slice(gt.index);gw.viewFrom=gt.lineN;gw.viewTo+=gz}else{eY(gs)}}else{if(gA>=gw.viewTo){var gt=gd(gs,gy,gy,-1);if(gt){gw.view=gw.view.slice(0,gt.index);gw.viewTo=gt.lineN}else{eY(gs)}}else{var gv=gd(gs,gy,gy,-1);var gu=gd(gs,gA,gA+gz,1);if(gv&&gu){gw.view=gw.view.slice(0,gv.index).concat(D(gs,gv.lineN,gu.lineN)).concat(gw.view.slice(gu.index));gw.viewTo+=gz}else{eY(gs)}}}}}}var gx=gw.externalMeasured;if(gx){if(gA<gx.lineN){gx.lineN+=gz}else{if(gy<gx.lineN+gx.size){gw.externalMeasured=null}}}}function eP(gt,gw,gy){gt.curOp.viewChanged=true;var gu=gt.display,gv=gt.display.externalMeasured;if(gv&&gw>=gv.lineN&&gw<gv.lineN+gv.size){gu.externalMeasured=null}if(gw<gu.viewFrom||gw>=gu.viewTo){return}var gx=gu.view[bD(gt,gw)];if(gx.node==null){return}var gs=gx.changes||(gx.changes=[]);if(cl(gs,gy)==-1){gs.push(gy)}}function eY(gs){gs.display.viewFrom=gs.display.viewTo=gs.doc.first;gs.display.view=[];gs.display.viewOffset=0}function bD(gs,gu){if(gu>=gs.display.viewTo){return null}gu-=gs.display.viewFrom;if(gu<0){return null}var gv=gs.display.view;for(var gt=0;gt<gv.length;gt++){gu-=gv[gt].size;if(gu<0){return gt}}}function gd(gs,gz,gy,gu){var gw=bD(gs,gz),gt,gA=gs.display.view;if(!e5||gy==gs.doc.first+gs.doc.size){return{index:gw,lineN:gy}}for(var gv=0,gx=gs.display.viewFrom;gv<gw;gv++){gx+=gA[gv].size}if(gx!=gz){if(gu>0){if(gw==gA.length-1){return null}gt=(gx+gA[gw].size)-gz;gw++}else{gt=gx-gz}gz+=gt;gy+=gt}while(gi(gs.doc,gy)!=gy){if(gw==(gu<0?0:gA.length-1)){return null}gy+=gu*gA[gw-(gu<0?1:0)].size;gw+=gu}return{index:gw,lineN:gy}}function j(gs,gu,gv){var gt=gs.display,gw=gt.view;if(gw.length==0||gu>=gt.viewTo||gv<=gt.viewFrom){gt.view=D(gs,gu,gv);gt.viewFrom=gu}else{if(gt.viewFrom>gu){gt.view=D(gs,gu,gt.viewFrom).concat(gt.view)}else{if(gt.viewFrom<gu){gt.view=gt.view.slice(bD(gs,gu))}}gt.viewFrom=gu;if(gt.viewTo<gv){gt.view=gt.view.concat(D(gs,gt.viewTo,gv))}else{if(gt.viewTo>gv){gt.view=gt.view.slice(0,bD(gs,gv))}}}gt.viewTo=gv}function az(gs){var gw=gs.display.view,gt=0;for(var gu=0;gu<gw.length;gu++){var gv=gw[gu];if(!gv.hidden&&(!gv.node||gv.changes)){++gt}}return gt}function eN(gs){var gt=gs.display;d0(gt.scroller,"mousedown",ed(gs,ea));if(cg&&cj<11){d0(gt.scroller,"dblclick",ed(gs,function(gA){if(fv(gs,gA)){return}var gB=es(gs,gA);if(!gB||V(gs,gA)||bl(gs.display,gA)){return}a1(gA);var gC=gs.findWordAt(gB);bp(gs.doc,gC.anchor,gC.head)}))}else{d0(gt.scroller,"dblclick",function(gA){fv(gs,gA)||a1(gA)})}if(!G){d0(gt.scroller,"contextmenu",function(gA){d2(gs,gA)})}var gz,gy={end:0};function gv(){if(gt.activeTouch){gz=setTimeout(function(){gt.activeTouch=null},1000);gy=gt.activeTouch;gy.end=+new Date}}function gx(gA){if(gA.touches.length!=1){return false}var gB=gA.touches[0];return gB.radiusX<=1&&gB.radiusY<=1}function gu(gD,gC){if(gC.left==null){return true}var gA=gC.left-gD.left,gB=gC.top-gD.top;return gA*gA+gB*gB>20*20}d0(gt.scroller,"touchstart",function(gA){if(!fv(gs,gA)&&!gx(gA)){clearTimeout(gz);var gB=+new Date;gt.activeTouch={start:gB,moved:false,prev:gB-gy.end<=300?gy:null};if(gA.touches.length==1){gt.activeTouch.left=gA.touches[0].pageX;gt.activeTouch.top=gA.touches[0].pageY}}});d0(gt.scroller,"touchmove",function(){if(gt.activeTouch){gt.activeTouch.moved=true}});d0(gt.scroller,"touchend",function(gA){var gD=gt.activeTouch;if(gD&&!bl(gt,gA)&&gD.left!=null&&!gD.moved&&new Date-gD.start<300){var gB=gs.coordsChar(gt.activeTouch,"page"),gC;if(!gD.prev||gu(gD,gD.prev)){gC=new eG(gB,gB)}else{if(!gD.prev.prev||gu(gD,gD.prev.prev)){gC=gs.findWordAt(gB)}else{gC=new eG(er(gB.line,0),X(gs.doc,er(gB.line+1,0)))}}gs.setSelection(gC.anchor,gC.head);gs.focus();a1(gA)}gv()});d0(gt.scroller,"touchcancel",gv);d0(gt.scroller,"scroll",function(){if(gt.scroller.clientHeight){fk(gs,gt.scroller.scrollTop);fj(gs,gt.scroller.scrollLeft,true);ft(gs,"scroll",gs)}});d0(gt.scroller,"mousewheel",function(gA){ec(gs,gA)});d0(gt.scroller,"DOMMouseScroll",function(gA){ec(gs,gA)});d0(gt.wrapper,"scroll",function(){gt.wrapper.scrollTop=gt.wrapper.scrollLeft=0});gt.dragFunctions={enter:function(gA){if(!fv(gs,gA)){a2(gA)}},over:function(gA){if(!fv(gs,gA)){d3(gs,gA);a2(gA)}},start:function(gA){d4(gs,gA)},drop:ed(gs,d5),leave:function(gA){if(!fv(gs,gA)){Q(gs)}}};var gw=gt.input.getField();d0(gw,"keyup",function(gA){d9.call(gs,gA)});d0(gw,"keydown",ed(gs,d7));d0(gw,"keypress",ed(gs,d8));d0(gw,"focus",w(d6,gs));d0(gw,"blur",w(d1,gs))}function aW(gs,gw,gu){var gx=gu&&gu!=ab.Init;if(!gw!=!gx){var gt=gs.display.dragFunctions;var gv=gw?d0:dY;gv(gs.display.scroller,"dragstart",gt.start);gv(gs.display.scroller,"dragenter",gt.enter);gv(gs.display.scroller,"dragover",gt.over);gv(gs.display.scroller,"dragleave",gt.leave);gv(gs.display.scroller,"drop",gt.drop)}}function eb(gs){var gt=gs.display;if(gt.lastWrapHeight==gt.wrapper.clientHeight&&gt.lastWrapWidth==gt.wrapper.clientWidth){return}gt.cachedCharWidth=gt.cachedTextHeight=gt.cachedPaddingH=null;gt.scrollbarsClipped=false;gs.setSize()}function bl(gs,gt){for(var gu=a4(gt);gu!=gs.wrapper;gu=gu.parentNode){if(!gu||(gu.nodeType==1&&gu.getAttribute("cm-ignore-events")=="true")||(gu.parentNode==gs.sizer&&gu!=gs.mover)){return true}}}function es(gs,gw,gy,gx){var gv=gs.display;if(!gy&&a4(gw).getAttribute("cm-not-content")=="true"){return null}var gB,gC,gA=gv.lineSpace.getBoundingClientRect();try{gB=gw.clientX-gA.left;gC=gw.clientY-gA.top}catch(gw){return null}var gu=ap(gs,gB,gC),gz;if(gx&&gu.xRel==1&&(gz=bP(gs.doc,gu.line).text).length==gu.ch){var gt=ay(gz,gz.length,gs.options.tabSize)-gz.length;gu=er(gu.line,Math.max(0,Math.round((gB-ei(gs.display).left)/K(gs.display))-gt))}return gu}function ea(gu){var gs=this,gt=gs.display;if(fv(gs,gu)||gt.activeTouch&&gt.input.supportsTouch()){return}gt.shift=gu.shiftKey;if(bl(gt,gu)){if(!gj){gt.scroller.draggable=false;setTimeout(function(){gt.scroller.draggable=true},100)}return}if(V(gs,gu)){return}var gv=es(gs,gu);window.focus();switch(aZ(gu)){case 1:if(gs.state.selectingText){gs.state.selectingText(gu)}else{if(gv){cP(gs,gu,gv)}else{if(a4(gu)==gt.scroller){a1(gu)}}}break;case 2:if(gj){gs.state.lastMiddleDown=+new Date}if(gv){bp(gs.doc,gv)}setTimeout(function(){gt.input.focus()},20);a1(gu);break;case 3:if(G){d2(gs,gu)}else{aE(gs)}break}}var cJ,cL;function cP(gs,gu,gy){if(cg){setTimeout(w(be,gs),0)}else{gs.curOp.focus=a()}var gw=+new Date,gz;if(cL&&cL.time>gw-400&&aa(cL.pos,gy)==0){gz="triple"}else{if(cJ&&cJ.time>gw-400&&aa(cJ.pos,gy)==0){gz="double";cL={time:gw,pos:gy}}else{gz="single";cJ={time:gw,pos:gy}}}var gx=gs.doc.sel,gv=dc?gu.metaKey:gu.ctrlKey,gt;if(gs.options.dragDrop&&aV&&!gs.isReadOnly()&&gz=="single"&&(gt=gx.contains(gy))>-1&&(aa((gt=gx.ranges[gt]).from(),gy)<0||gy.xRel>0)&&(aa(gt.to(),gy)>0||gy.xRel<0)){cR(gs,gu,gy,gv)}else{cQ(gs,gu,gy,gz,gv)}}function cR(gs,gv,gx,gw){var gt=gs.display,gy=+new Date;var gu=ed(gs,function(gz){if(gj){gt.scroller.draggable=false}gs.state.draggingText=false;dY(document,"mouseup",gu);dY(gt.scroller,"drop",gu);if(Math.abs(gv.clientX-gz.clientX)+Math.abs(gv.clientY-gz.clientY)<10){a1(gz);if(!gw&&+new Date-200<gy){bp(gs.doc,gx)}if(gj||cg&&cj==9){setTimeout(function(){document.body.focus();gt.input.focus()},20)}else{gt.input.focus()}}});if(gj){gt.scroller.draggable=true}gs.state.draggingText=gu;gu.copy=dc?gv.altKey:gv.ctrlKey;if(gt.scroller.dragDrop){gt.scroller.dragDrop()}d0(document,"mouseup",gu);d0(gt.scroller,"drop",gu)}function cQ(gt,gy,gI,gK,gs){var gv=gt.display,gw=gt.doc;a1(gy);var gG,gF,gJ=gw.sel,gH=gJ.ranges;if(gs&&!gy.shiftKey){gF=gw.sel.contains(gI);if(gF>-1){gG=gH[gF]}else{gG=new eG(gI,gI)}}else{gG=gw.sel.primary();gF=gw.sel.primIndex}if(M?gy.shiftKey&&gy.metaKey:gy.altKey){gK="rect";if(!gs){gG=new eG(gI,gI)}gI=es(gt,gy,true,true);gF=-1}else{if(gK=="double"){var gM=gt.findWordAt(gI);if(gt.display.shift||gw.extend){gG=bo(gw,gG,gM.anchor,gM.head)}else{gG=gM}}else{if(gK=="triple"){var gD=new eG(er(gI.line,0),X(gw,er(gI.line+1,0)));if(gt.display.shift||gw.extend){gG=bo(gw,gG,gD.anchor,gD.head)}else{gG=gD}}else{gG=bo(gw,gG,gI)}}}if(!gs){gF=0;fl(gw,new ff([gG],0),fc);gJ=gw.sel}else{if(gF==-1){gF=gH.length;fl(gw,dU(gH.concat([gG]),gF),{scroll:false,origin:"*mouse"})}else{if(gH.length>1&&gH[gF].empty()&&gK=="single"&&!gy.shiftKey){fl(gw,dU(gH.slice(0,gF).concat(gH.slice(gF+1)),0),{scroll:false,origin:"*mouse"});gJ=gw.sel}else{eV(gw,gF,gG,fc)}}}var gC=gI;function gB(gU){if(aa(gC,gU)==0){return}gC=gU;if(gK=="rect"){var gX=[],g0=gt.options.tabSize;var gZ=ay(bP(gw,gI.line).text,gI.ch,g0);var gV=ay(bP(gw,gU.line).text,gU.ch,g0);var gQ=Math.min(gZ,gV),gY=Math.max(gZ,gV);for(var gS=Math.min(gI.line,gU.line),gO=Math.min(gt.lastLine(),Math.max(gI.line,gU.line));gS<=gO;gS++){var g1=bP(gw,gS).text,gR=bw(g1,gQ,g0);if(gQ==gY){gX.push(new eG(er(gS,gR),er(gS,gR)))}else{if(g1.length>gR){gX.push(new eG(er(gS,gR),er(gS,bw(g1,gY,g0))))}}}if(!gX.length){gX.push(new eG(gI,gI))}fl(gw,dU(gJ.ranges.slice(0,gF).concat(gX),gF),{origin:"*mouse",scroll:false});gt.scrollIntoView(gU)}else{var gT=gG;var gN=gT.anchor,gP=gU;if(gK!="single"){if(gK=="double"){var gW=gt.findWordAt(gU)}else{var gW=new eG(er(gU.line,0),X(gw,er(gU.line+1,0)))}if(aa(gW.anchor,gN)>0){gP=gW.head;gN=dE(gT.from(),gW.anchor)}else{gP=gW.anchor;gN=dr(gT.to(),gW.head)}}var gX=gJ.ranges.slice(0);gX[gF]=new eG(X(gw,gN),gP);fl(gw,dU(gX,gF),fc)}}var gz=gv.wrapper.getBoundingClientRect();var gu=0;function gA(gP){var gO=++gu;var gN=es(gt,gP,true,gK=="rect");if(!gN){return}if(aa(gN,gC)!=0){gt.curOp.focus=a();gB(gN);var gR=ge(gv,gw);if(gN.line>=gR.to||gN.line<gR.from){setTimeout(ed(gt,function(){if(gu==gO){gA(gP)}}),150)}}else{var gQ=gP.clientY<gz.top?-20:gP.clientY>gz.bottom?20:0;if(gQ){setTimeout(ed(gt,function(){if(gu!=gO){return}gv.scroller.scrollTop+=gQ;gA(gP)}),50)}}}function gx(gN){gt.state.selectingText=false;gu=Infinity;a1(gN);gv.input.focus();dY(document,"mousemove",gE);dY(document,"mouseup",gL);gw.history.lastSelOrigin=null}var gE=ed(gt,function(gN){if(!aZ(gN)){gx(gN)}else{gA(gN)}});var gL=ed(gt,gx);gt.state.selectingText=gL;d0(document,"mousemove",gE);d0(document,"mouseup",gL)}function bZ(gs,gu,gD,gC){try{var gA=gu.clientX,gB=gu.clientY}catch(gu){return false}if(gA>=Math.floor(gs.display.gutters.getBoundingClientRect().right)){return false}if(gC){a1(gu)}var gt=gs.display;var gz=gt.lineDiv.getBoundingClientRect();if(gB>gz.bottom||!b7(gs,gD)){return a0(gu)}gB-=gz.top-gt.viewOffset;for(var gx=0;gx<gs.options.gutters.length;++gx){var gv=gt.gutters.childNodes[gx];if(gv&&gv.getBoundingClientRect().right>=gA){var gy=cT(gs.doc,gB);var gw=gs.options.gutters[gx];ft(gs,gD,gs,gy,gw,gu);return a0(gu)}}}function V(gs,gt){return bZ(gs,gt,"gutterClick",true)}var cM=0;function d5(gt){var gs=this;Q(gs);if(fv(gs,gt)||bl(gs.display,gt)){return}a1(gt);if(cg){cM=+new Date}var gy=es(gs,gt,true),gu=gt.dataTransfer.files;if(!gy||gs.isReadOnly()){return}if(gu&&gu.length&&window.FileReader&&window.File){var gx=gu.length,gB=Array(gx),gz=0;var gw=function(gC,gD){if(gs.options.allowDropFileTypes&&cl(gs.options.allowDropFileTypes,gC.type)==-1){return}var gE=new FileReader;gE.onload=ed(gs,function(){var gG=gE.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(gG)){gG=""}gB[gD]=gG;if(++gz==gx){gy=X(gs.doc,gy);var gF={from:gy,to:gy,text:gs.doc.splitLines(gB.join(gs.doc.lineSeparator())),origin:"paste"};de(gs.doc,gF);fo(gs.doc,fx(gy,H(gF)))}});gE.readAsText(gC)};for(var gv=0;gv<gx;++gv){gw(gu[gv],gv)}}else{if(gs.state.draggingText&&gs.doc.sel.contains(gy)>-1){gs.state.draggingText(gt);setTimeout(function(){gs.display.input.focus()},20);return}try{var gB=gt.dataTransfer.getData("Text");if(gB){if(gs.state.draggingText&&!gs.state.draggingText.copy){var gA=gs.listSelections()}fn(gs.doc,fx(gy,gy));if(gA){for(var gv=0;gv<gA.length;++gv){eW(gs.doc,"",gA[gv].anchor,gA[gv].head,"drag")}}gs.replaceSelection(gB,"around","paste");gs.display.input.focus()}}catch(gt){}}}function d4(gs,gt){if(cg&&(!gs.state.draggingText||+new Date-cM<100)){a2(gt);return}if(fv(gs,gt)||bl(gs.display,gt)){return}gt.dataTransfer.setData("Text",gs.getSelection());gt.dataTransfer.effectAllowed="copyMove";if(gt.dataTransfer.setDragImage&&!e4){var gu=a5("img",null,null,"position: fixed; left: 0; top: 0;");gu.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(ez){gu.width=gu.height=1;gs.display.wrapper.appendChild(gu);gu._top=gu.offsetTop}gt.dataTransfer.setDragImage(gu,0,0);if(ez){gu.parentNode.removeChild(gu)}}}function d3(gs,gt){var gv=es(gs,gt);if(!gv){return}var gu=document.createDocumentFragment();aX(gs,gv,gu);if(!gs.display.dragCursor){gs.display.dragCursor=a5("div",null,"CodeMirror-cursors CodeMirror-dragcursors");gs.display.lineSpace.insertBefore(gs.display.dragCursor,gs.display.cursorDiv)}eR(gs.display.dragCursor,gu)}function Q(gs){if(gs.display.dragCursor){gs.display.lineSpace.removeChild(gs.display.dragCursor);gs.display.dragCursor=null}}function fk(gs,gt){if(Math.abs(gs.doc.scrollTop-gt)<2){return}gs.doc.scrollTop=gt;if(!bJ){fU(gs,{top:gt})}if(gs.display.scroller.scrollTop!=gt){gs.display.scroller.scrollTop=gt}gs.display.scrollbars.setScrollTop(gt);if(bJ){fU(gs)}fH(gs,100)}function fj(gs,gu,gt){if(gt?gu==gs.doc.scrollLeft:Math.abs(gs.doc.scrollLeft-gu)<2){return}gu=Math.min(gu,gs.display.scroller.scrollWidth-gs.display.scroller.clientWidth);gs.doc.scrollLeft=gu;k(gs);if(gs.display.scroller.scrollLeft!=gu){gs.display.scroller.scrollLeft=gu}gs.display.scrollbars.setScrollLeft(gu)}var gm=0,gl=null;if(cg){gl=-0.53}else{if(bJ){gl=15}else{if(L){gl=-0.7}else{if(e4){gl=-1/3}}}}var gk=function(gu){var gs=gu.wheelDeltaX,gt=gu.wheelDeltaY;if(gs==null&&gu.detail&&gu.axis==gu.HORIZONTAL_AXIS){gs=gu.detail}if(gt==null&&gu.detail&&gu.axis==gu.VERTICAL_AXIS){gt=gu.detail}else{if(gt==null){gt=gu.wheelDelta}}return{x:gs,y:gt}};ab.wheelEventPixels=function(gt){var gs=gk(gt);gs.x*=gl;gs.y*=gl;return gs};function ec(gv,gB){var gx=gk(gB),gz=gx.x,gA=gx.y;var gy=gv.display,gE=gy.scroller;var gt=gE.scrollWidth>gE.clientWidth;var gu=gE.scrollHeight>gE.clientHeight;if(!(gz&&gt||gA&&gu)){return}if(gA&&dc&&gj){outer:for(var gw=gB.target,gG=gy.view;gw!=gE;gw=gw.parentNode){for(var gC=0;gC<gG.length;gC++){if(gG[gC].node==gw){gv.display.currentWheelTarget=gw;break outer}}}}if(gz&&!bJ&&!ez&&gl!=null){if(gA&&gu){fk(gv,Math.max(0,Math.min(gE.scrollTop+gA*gl,gE.scrollHeight-gE.clientHeight)))}fj(gv,Math.max(0,Math.min(gE.scrollLeft+gz*gl,gE.scrollWidth-gE.clientWidth)));if(!gA||(gA&&gu)){a1(gB)}gy.wheelStartX=null;return}if(gA&&gl!=null){var gD=gA*gl;var gF=gv.doc.scrollTop,gs=gF+gy.wrapper.clientHeight;if(gD<0){gF=Math.max(0,gF+gD-50)}else{gs=Math.min(gv.doc.height,gs+gD+50)}fU(gv,{top:gF,bottom:gs})}if(gm<20){if(gy.wheelStartX==null){gy.wheelStartX=gE.scrollLeft;gy.wheelStartY=gE.scrollTop;gy.wheelDX=gz;gy.wheelDY=gA;setTimeout(function(){if(gy.wheelStartX==null){return}var gH=gE.scrollLeft-gy.wheelStartX;var gI=gE.scrollTop-gy.wheelStartY;var gJ=(gI&&gy.wheelDY&&gI/gy.wheelDY)||(gH&&gy.wheelDX&&gH/gy.wheelDX);gy.wheelStartX=gy.wheelStartY=null;if(!gJ){return}gl=(gl*gm+gJ)/(gm+1);++gm},200)}else{gy.wheelDX+=gz;gy.wheelDY+=gA}}}function aR(gt,gs,gv){if(typeof gs=="string"){gs=af[gs];if(!gs){return false}}gt.display.input.ensurePolled();var gw=gt.display.shift,gu=false;try{if(gt.isReadOnly()){gt.state.suppressEdits=true}if(gv){gt.display.shift=false}gu=gs(gt)!=en}finally{gt.display.shift=gw;gt.state.suppressEdits=false}return gu}function da(gs,gv,gt){for(var gu=0;gu<gs.state.keyMaps.length;gu++){var gw=c9(gv,gs.state.keyMaps[gu],gt,gs);if(gw){return gw}}return(gs.options.extraKeys&&c9(gv,gs.options.extraKeys,gt,gs))||c9(gv,gs.options.keyMap,gt,gs)}var fI=new aF;function aK(gs,gv,gt,gu){var gx=gs.state.keySeq;if(gx){if(cz(gv)){return"handled"}fI.set(50,function(){if(gs.state.keySeq==gx){gs.state.keySeq=null;gs.display.input.reset()}});gv=gx+" "+gv}var gw=da(gs,gv,gu);if(gw=="multi"){gs.state.keySeq=gv}if(gw=="handled"){fw(gs,"keyHandled",gs,gv,gt)}if(gw=="handled"||gw=="multi"){a1(gt);e0(gs)}if(gx&&!gw&&/\'$/.test(gv)){a1(gt);return true}return !!gw}function b2(gs,gt){var gu=cG(gt,true);if(!gu){return false}if(gt.shiftKey&&!gs.state.keySeq){return aK(gs,"Shift-"+gu,gt,function(gv){return aR(gs,gv,true)})||aK(gs,gu,gt,function(gv){if(typeof gv=="string"?/^go[A-Z]/.test(gv):gv.motion){return aR(gs,gv)}})}else{return aK(gs,gu,gt,function(gv){return aR(gs,gv)})}}function b1(gt,gu,gs){return aK(gt,"'"+gs+"'",gu,function(gv){return aR(gt,gv,true)})}var cN=null;function d7(gu){var gs=this;gs.curOp.focus=a();if(fv(gs,gu)){return}if(cg&&cj<11&&gu.keyCode==27){gu.returnValue=false}var gt=gu.keyCode;gs.display.shift=gt==16||gu.shiftKey;var gv=b2(gs,gu);if(ez){cN=gv?gt:null;if(!gv&&gt==88&&!b6&&(dc?gu.metaKey:gu.ctrlKey)){gs.replaceSelection("",null,"cut")}}if(gt==18&&!/\bCodeMirror-crosshair\b/.test(gs.display.lineDiv.className)){fs(gs)}}function fs(gs){var gt=gs.display.lineDiv;c(gt,"CodeMirror-crosshair");function gu(gv){if(gv.keyCode==18||!gv.altKey){e1(gt,"CodeMirror-crosshair");dY(document,"keyup",gu);dY(document,"mouseover",gu)}}d0(document,"keyup",gu);d0(document,"mouseover",gu)}function d9(gs){if(gs.keyCode==16){this.doc.sel.shift=false}fv(this,gs)}function d8(gv){var gu=this;if(bl(gu.display,gv)||fv(gu,gv)||gv.ctrlKey&&!gv.altKey||dc&&gv.metaKey){return}var gw=gv.keyCode,gt=gv.charCode;if(ez&&gw==cN){cN=null;a1(gv);return}if((ez&&(!gv.which||gv.which<10))&&b2(gu,gv)){return}var gs=String.fromCharCode(gt==null?gw:gt);if(b1(gu,gv,gs)){return}gu.display.input.onKeyPress(gv)}function aE(gs){gs.state.delayingBlurEvent=true;setTimeout(function(){if(gs.state.delayingBlurEvent){gs.state.delayingBlurEvent=false;d1(gs)}},100)}function d6(gs){if(gs.state.delayingBlurEvent){gs.state.delayingBlurEvent=false}if(gs.options.readOnly=="nocursor"){return}if(!gs.state.focused){ft(gs,"focus",gs);gs.state.focused=true;c(gs.display.wrapper,"CodeMirror-focused");if(!gs.curOp&&gs.display.selForContextMenu!=gs.doc.sel){gs.display.input.reset();if(gj){setTimeout(function(){gs.display.input.reset(true)},20)}}gs.display.input.receivedFocus()}e0(gs)}function d1(gs){if(gs.state.delayingBlurEvent){return}if(gs.state.focused){ft(gs,"blur",gs);gs.state.focused=false;e1(gs.display.wrapper,"CodeMirror-focused")}clearInterval(gs.display.blinker);setTimeout(function(){if(!gs.state.focused){gs.display.shift=false}},150)}function d2(gs,gt){if(bl(gs.display,gt)||ao(gs,gt)){return}if(fv(gs,gt,"contextmenu")){return}gs.display.input.onContextMenu(gt)}function ao(gs,gt){if(!b7(gs,"gutterContextMenu")){return false}return bZ(gs,gt,"gutterContextMenu",false)}var H=ab.changeEnd=function(gs){if(!gs.text){return gs.to}return er(gs.from.line+gs.text.length-1,db(gs.text).length+(gs.text.length==1?gs.from.ch:0))};function h(gv,gt){if(aa(gv,gt.from)<0){return gv}if(aa(gv,gt.to)<=0){return H(gt)}var gu=gv.line+gt.text.length-(gt.to.line-gt.from.line)-1,gs=gv.ch;if(gv.line==gt.to.line){gs+=H(gt).ch-gt.to.ch}return er(gu,gs)}function ak(gt,gs){var gv=[];for(var gu=0;gu<gt.sel.ranges.length;gu++){var gw=gt.sel.ranges[gu];gv.push(new eG(h(gw.anchor,gs),h(gw.head,gs)))}return dU(gv,gt.sel.primIndex)}function dZ(gu,gt,gs){if(gu.line==gt.line){return er(gs.line,gu.ch-gt.ch+gs.ch)}else{return er(gs.line+(gu.line-gt.line),gu.ch)}}function aj(gu,gt,gw){var gB=[];var gA=er(gu.first,0),gz=gA;for(var gx=0;gx<gt.length;gx++){var gs=gt[gx];var gv=dZ(gs.from,gA,gz);var gD=dZ(H(gs),gA,gz);gA=gs.to;gz=gD;if(gw=="around"){var gC=gu.sel.ranges[gx],gy=aa(gC.head,gC.anchor)<0;gB[gx]=new eG(gy?gD:gv,gy?gv:gD)}else{gB[gx]=new eG(gv,gv)}}return new ff(gB,gu.sel.primIndex)}function bu(gt,gs,gv){var gu={canceled:false,from:gs.from,to:gs.to,text:gs.text,origin:gs.origin,cancel:function(){this.canceled=true}};if(gv){gu.update=function(gw,gz,gy,gx){if(gw){this.from=X(gt,gw)}if(gz){this.to=X(gt,gz)}if(gy){this.text=gy}if(gx!==undefined){this.origin=gx}}}ft(gt,"beforeChange",gt,gu);if(gt.cm){ft(gt.cm,"beforeChange",gt.cm,gu)}if(gu.canceled){return null}return{from:gu.from,to:gu.to,text:gu.text,origin:gu.origin}}function de(gt,gs,gv){if(gt.cm){if(!gt.cm.curOp){return ed(gt.cm,de)(gt,gs,gv)}if(gt.cm.state.suppressEdits){return}}if(b7(gt,"beforeChange")||gt.cm&&b7(gt.cm,"beforeChange")){gs=bu(gt,gs,true);if(!gs){return}}var gw=e6&&!gv&&eU(gt,gs.from,gs.to);if(gw){for(var gu=gw.length-1;gu>=0;--gu){dg(gt,{from:gw[gu].from,to:gw[gu].to,text:gu?[""]:gs.text})}}else{dg(gt,gs)}}function dg(gt,gs){if(gs.text.length==1&&gs.text[0]==""&&aa(gs.from,gs.to)==0){return}var gv=ak(gt,gs);b(gt,gs,gv,gt.cm?gt.cm.curOp.id:NaN);dh(gt,gs,gv,fJ(gt,gs));var gu=[];c6(gt,function(gw,gx){if(!gx&&cl(gu,gw.history)==-1){eI(gw.history,gs);gu.push(gw.history)}dh(gw,gs,null,fJ(gw,gs))})}function df(gx,gF,gt){if(gx.cm&&gx.cm.state.suppressEdits&&!gt){return}var gA=gx.history,gy,gD=gx.sel;var gE=gF=="undo"?gA.done:gA.undone,gw=gF=="undo"?gA.undone:gA.done;for(var gB=0;gB<gE.length;gB++){gy=gE[gB];if(gt?gy.ranges&&!gy.equals(gx.sel):!gy.ranges){break}}if(gB==gE.length){return}gA.lastOrigin=gA.lastSelOrigin=null;for(;;){gy=gE.pop();if(gy.ranges){eD(gy,gw);if(gt&&!gy.equals(gx.sel)){fl(gx,gy,{clearRedo:false});return}gD=gy}else{break}}var gu=[];eD(gD,gw);gw.push({changes:gu,generation:gA.generation});gA.generation=gy.generation||++gA.maxGeneration;var gz=b7(gx,"beforeChange")||gx.cm&&b7(gx.cm,"beforeChange");for(var gB=gy.changes.length-1;gB>=0;--gB){var gv=gy.changes[gB];gv.origin=gF;if(gz&&!bu(gx,gv,false)){gE.length=0;return}gu.push(cf(gx,gv));var gs=gB?ak(gx,gv):db(gE);dh(gx,gv,gs,dB(gx,gv));if(!gB&&gx.cm){gx.cm.scrollIntoView({from:gv.from,to:H(gv)})}var gC=[];c6(gx,function(gG,gH){if(!gH&&cl(gC,gG.history)==-1){eI(gG.history,gv);gC.push(gG.history)}dh(gG,gv,null,dB(gG,gv))})}}function fr(gu,gt){if(gt==0){return}gu.first+=gt;gu.sel=new ff(dj(gu.sel.ranges,function(gw){return new eG(er(gw.anchor.line+gt,gw.anchor.ch),er(gw.head.line+gt,gw.head.ch))}),gu.sel.primIndex);if(gu.cm){eM(gu.cm,gu.first,gu.first-gt,gt);for(var gs=gu.cm.display,gv=gs.viewFrom;gv<gs.viewTo;gv++){eP(gu.cm,gv,"gutter")}}}function dh(gt,gs,gv,gx){if(gt.cm&&!gt.cm.curOp){return ed(gt.cm,dh)(gt,gs,gv,gx)}if(gs.to.line<gt.first){fr(gt,gs.text.length-1-(gs.to.line-gs.from.line));return}if(gs.from.line>gt.lastLine()){return}if(gs.from.line<gt.first){var gw=gs.text.length-1-(gt.first-gs.from.line);fr(gt,gw);gs={from:er(gt.first,0),to:er(gs.to.line+gw,gs.to.ch),text:[db(gs.text)],origin:gs.origin}}var gu=gt.lastLine();if(gs.to.line>gu){gs={from:gs.from,to:er(gu,bP(gt,gu).text.length),text:[gs.text[0]],origin:gs.origin}}gs.removed=bK(gt,gs.from,gs.to);if(!gv){gv=ak(gt,gs)}if(gt.cm){di(gt.cm,gs,gx)}else{fV(gt,gs,gx)}fn(gt,gv,fb)}function di(gw,gs,gD){var gy=gw.doc,gx=gw.display,gz=gs.from,gE=gs.to;var gC=false,gv=gz.line;if(!gw.options.lineWrapping){gv=cZ(gf(bP(gy,gz.line)));gy.iter(gv,gE.line+1,function(gF){if(gF==gx.maxLine){gC=true;return true}})}if(gy.sel.contains(gs.from,gs.to)>-1){fu(gw)}fV(gy,gs,gD,bj(gw));if(!gw.options.lineWrapping){gy.iter(gv,gz.line+gs.text.length,function(gG){var gF=cY(gG);if(gF>gx.maxLineLength){gx.maxLine=gG;gx.maxLineLength=gF;gx.maxLineChanged=true;gC=false}});if(gC){gw.curOp.updateMaxLine=true}}gy.frontier=Math.min(gy.frontier,gz.line);fH(gw,400);var gA=gs.text.length-(gE.line-gz.line)-1;if(gs.full){eM(gw)}else{if(gz.line==gE.line&&gs.text.length==1&&!cA(gw.doc,gs)){eP(gw,gz.line,"text")}else{eM(gw,gz.line,gE.line+1,gA)}}var gu=b7(gw,"changes"),gt=b7(gw,"change");if(gt||gu){var gB={from:gz,to:gE,text:gs.text,removed:gs.removed,origin:gs.origin};if(gt){fw(gw,"change",gw,gB)}if(gu){(gw.curOp.changeObjs||(gw.curOp.changeObjs=[])).push(gB)}}gw.display.selForContextMenu=null}function eW(gt,gs,gu,gx,gv){if(!gx){gx=gu}if(aa(gx,gu)<0){var gw=gx;gx=gu;gu=gw}if(typeof gs=="string"){gs=gt.splitLines(gs)}de(gt,{from:gu,to:gx,text:gs,origin:gv})}function dt(gt,gu){if(fv(gt,"scrollCursorIntoView")){return}var gv=gt.display,gs=gv.sizer.getBoundingClientRect(),gw=null;if(gu.top+gs.top<0){gw=true}else{if(gu.bottom+gs.top>(window.innerHeight||document.documentElement.clientHeight)){gw=false}}if(gw!=null&&!ep){var gx=a5("div","\u200b",null,"position: absolute; top: "+(gu.top-gv.viewOffset-ej(gt.display))+"px; height: "+(gu.bottom-gu.top+e8(gt)+gv.barHeight)+"px; left: "+gu.left+"px; width: 2px;");gt.display.lineSpace.appendChild(gx);gx.scrollIntoView(gw);gt.display.lineSpace.removeChild(gx)}}function fa(gt,gz,gv,gy){if(gy==null){gy=0}for(var gx=0;gx<5;gx++){var gs=false,gu=aB(gt,gz);var gw=!gv||gv==gz?gu:aB(gt,gv);var gA=E(gt,Math.min(gu.left,gw.left),Math.min(gu.top,gw.top)-gy,Math.max(gu.left,gw.left),Math.max(gu.bottom,gw.bottom)+gy);var gC=gt.doc.scrollTop,gB=gt.doc.scrollLeft;if(gA.scrollTop!=null){fk(gt,gA.scrollTop);if(Math.abs(gt.doc.scrollTop-gC)>1){gs=true}}if(gA.scrollLeft!=null){fj(gt,gA.scrollLeft);if(Math.abs(gt.doc.scrollLeft-gB)>1){gs=true}}if(!gs){break}}return gu}function e9(gs,gu,gw,gv,gx){var gt=E(gs,gu,gw,gv,gx);if(gt.scrollTop!=null){fk(gs,gt.scrollTop)}if(gt.scrollLeft!=null){fj(gs,gt.scrollLeft)}}function E(gu,gF,gH,gG,gI){var gv=gu.display,gD=fP(gu.display);if(gH<0){gH=0}var gB=gu.curOp&&gu.curOp.scrollTop!=null?gu.curOp.scrollTop:gv.scroller.scrollTop;var gz=aM(gu),gy={};if(gI-gH>gz){gI=gH+gz}var gw=gu.doc.height+ek(gv);var gt=gH<gD,gs=gI>gw-gD;if(gH<gB){gy.scrollTop=gt?0:gH}else{if(gI>gB+gz){var gx=Math.min(gH,(gs?gw:gI)-gz);if(gx!=gB){gy.scrollTop=gx}}}var gA=gu.curOp&&gu.curOp.scrollLeft!=null?gu.curOp.scrollLeft:gv.scroller.scrollLeft;var gC=aO(gu)-(gu.options.fixedGutter?gv.gutters.offsetWidth:0);var gE=gG-gF>gC;if(gE){gG=gF+gC}if(gF<10){gy.scrollLeft=0}else{if(gF<gA){gy.scrollLeft=Math.max(0,gF-(gE?0:10))}else{if(gG>gC+gA-3){gy.scrollLeft=gG+(gE?0:10)-gC}}}return gy}function g(gs,gt,gu){if(gt!=null||gu!=null){eZ(gs)}if(gt!=null){gs.curOp.scrollLeft=(gs.curOp.scrollLeft==null?gs.doc.scrollLeft:gs.curOp.scrollLeft)+gt}if(gu!=null){gs.curOp.scrollTop=(gs.curOp.scrollTop==null?gs.doc.scrollTop:gs.curOp.scrollTop)+gu}}function bd(gs){eZ(gs);var gt=gs.getCursor(),gu=gt,gv=gt;if(!gs.options.lineWrapping){gu=gt.ch?er(gt.line,gt.ch-1):gt;gv=er(gt.line,gt.ch+1)}gs.curOp.scrollToPos={from:gu,to:gv,margin:gs.options.cursorScrollMargin,isCursor:true}}function eZ(gs){var gu=gs.curOp.scrollToPos;if(gu){gs.curOp.scrollToPos=null;var gt=bi(gs,gu.from),gw=bi(gs,gu.to);var gv=E(gs,Math.min(gt.left,gw.left),Math.min(gt.top,gw.top)-gu.margin,Math.max(gt.right,gw.right),Math.max(gt.bottom,gw.bottom)+gu.margin);gs.scrollTo(gv.scrollLeft,gv.scrollTop)}}function ck(gt,gC,gx,gs){var gw=gt.doc,gF;if(gx==null){gx="add"}if(gx=="smart"){if(!gw.mode.indent){gx="prev"}else{gF=bW(gt,gC)}}var gG=gt.options.tabSize;var gB=bP(gw,gC),gu=ay(gB.text,null,gG);if(gB.stateAfter){gB.stateAfter=null}var gv=gB.text.match(/^\s*/)[0],gz;if(!gs&&!/\S/.test(gB.text)){gz=0;gx="not"}else{if(gx=="smart"){gz=gw.mode.indent(gF,gB.text.slice(gv.length),gB.text);if(gz==en||gz>150){if(!gs){return}gx="prev"}}}if(gx=="prev"){if(gC>gw.first){gz=ay(bP(gw,gC-1).text,null,gG)}else{gz=0}}else{if(gx=="add"){gz=gu+gt.options.indentUnit}else{if(gx=="subtract"){gz=gu-gt.options.indentUnit}else{if(typeof gx=="number"){gz=gu+gx}}}}gz=Math.max(0,gz);var gA="",gD=0;if(gt.options.indentWithTabs){for(var gy=Math.floor(gz/gG);gy;--gy){gD+=gG;gA+="\t"}}if(gD<gz){gA+=fB(gz-gD)}if(gA!=gv){eW(gw,gA,er(gC,0),er(gC,gv.length),"+input");gB.stateAfter=null;return true}else{for(var gy=0;gy<gw.sel.ranges.length;gy++){var gE=gw.sel.ranges[gy];if(gE.head.line==gC&&gE.head.ch<gv.length){var gD=er(gC,gv.length);eV(gw,gy,new eG(gD,gD));break}}}}function I(gt,gu,gs,gx){var gw=gu,gv=gu;if(typeof gu=="number"){gv=bP(gt,W(gt,gu))}else{gw=cZ(gu)}if(gw==null){return null}if(gx(gv,gw)&&gt.cm){eP(gt.cm,gw,gs)}return gv}function aG(gs,gt){var gw=gs.doc.sel.ranges,gv=[];for(var gu=0;gu<gw.length;gu++){var gy=gt(gw[gu]);while(gv.length&&aa(gy.from,db(gv).to)<=0){var gx=gv.pop();if(aa(gx.from,gy.from)<0){gy.from=gx.from;break}}gv.push(gy)}e2(gs,function(){for(var gz=gv.length-1;gz>=0;gz--){eW(gs.doc,"",gv[gz].from,gv[gz].to,"+delete")}bd(gs)})}function by(gv,gE,gu,gI,gJ){var gA=gE.line,gs=gE.ch,gD=gu;var gB=bP(gv,gA);function gw(){var gK=gA+gu;if(gK<gv.first||gK>=gv.first+gv.size){return false}gA=gK;return gB=bP(gv,gK)}function gC(gK){var gL=(gJ?dL:dJ)(gB,gs,gu,true);if(gL==null){if(!gK&&gw()){if(gJ){gs=(gu<0?c1:cX)(gB)}else{gs=gu<0?gB.text.length:0}}else{return false}}else{gs=gL}return true}if(gI=="char"){gC()}else{if(gI=="column"){gC(true)}else{if(gI=="word"||gI=="group"){var gG=null,gy=gI=="group";var gz=gv.cm&&gv.cm.getHelper(gE,"wordChars");for(var gx=true;;gx=false){if(gu<0&&!gC(!gx)){break}var gt=gB.text.charAt(gs)||"\n";var gH=cB(gt,gz)?"w":gy&&gt=="\n"?"n":!gy||/\s/.test(gt)?null:"p";if(gy&&!gx&&!gH){gH="s"}if(gG&&gG!=gH){if(gu<0){gu=1;gC()}break}if(gH){gG=gH}if(gu>0&&!gC(!gx)){break}}}}}var gF=fy(gv,er(gA,gs),gE,gD,true);if(!aa(gE,gF)){gF.hitSide=true}return gF}function bz(gs,gw,gt,gy){var gu=gs.doc,gz=gw.left,gA;if(gy=="page"){var gv=Math.min(gs.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);gA=gw.top+gt*(gv-(gt<0?1.5:0.5)*fP(gs.display))}else{if(gy=="line"){gA=gt>0?gw.bottom+3:gw.top-3}}for(;;){var gx=ap(gs,gz,gA);if(!gx.outside){break}if(gt<0?gA<=0:gA>=gu.height){gx.hitSide=true;break}gA+=gt*5}return gx}ab.prototype={constructor:ab,focus:function(){window.focus();this.display.input.focus()},setOption:function(gt,gv){var gu=this.options,gs=gu[gt];if(gu[gt]==gv&&gt!="mode"){return}gu[gt]=gv;if(eg.hasOwnProperty(gt)){ed(this,eg[gt])(this,gv,gs)}},getOption:function(gs){return this.options[gs]},getDoc:function(){return this.doc},addKeyMap:function(gt,gs){this.state.keyMaps[gs?"push":"unshift"](bO(gt))},removeKeyMap:function(gt){var gu=this.state.keyMaps;for(var gs=0;gs<gu.length;++gs){if(gu[gs]==gt||gu[gs].name==gt){gu.splice(gs,1);return true}}},addOverlay:dC(function(gu,gt){var gs=gu.token?gu:ab.getMode(this.options,gu);if(gs.startState){throw new Error("Overlays may not be stateful.")}cs(this.state.overlays,{mode:gs,modeSpec:gu,opaque:gt&&gt.opaque,priority:(gt&&gt.priority)||0},function(gv){return gv.priority});this.state.modeGen++;eM(this)}),removeOverlay:dC(function(gv){var gu=this.state.overlays;for(var gt=0;gt<gu.length;++gt){var gs=gu[gt].modeSpec;if(gs==gv||typeof gv=="string"&&gs.name==gv){gu.splice(gt,1);this.state.modeGen++;eM(this);return}}}),indentLine:dC(function(gu,gt,gs){if(typeof gt!="string"&&typeof gt!="number"){if(gt==null){gt=this.options.smartIndent?"smart":"prev"}else{gt=gt?"add":"subtract"}}if(cy(this.doc,gu)){ck(this,gu,gt,gs)}}),indentSelection:dC(function(gu){var gz=this.doc.sel.ranges,gs=-1;for(var gv=0;gv<gz.length;gv++){var gy=gz[gv];if(!gy.empty()){var gt=gy.from(),gB=gy.to();var gA=Math.max(gs,gt.line);gs=Math.min(this.lastLine(),gB.line-(gB.ch?0:1))+1;for(var gw=gA;gw<gs;++gw){ck(this,gw,gu)}var gx=this.doc.sel.ranges;if(gt.ch==0&&gz.length==gx.length&&gx[gv].from().ch>0){eV(this.doc,gv,new eG(gt,gx[gv].to()),fb)}}else{if(gy.head.line>gs){ck(this,gy.head.line,gu,true);gs=gy.head.line;if(gv==this.doc.sel.primIndex){bd(this)}}}}}),getTokenAt:function(gs,gt){return fN(this,gs,gt)},getLineTokens:function(gs,gt){return fN(this,er(gs),gt,true)},getTokenTypeAt:function(gx){gx=X(this.doc,gx);var gy=bS(this,bP(this.doc,gx.line));var gt=0,gs=(gy.length-1)/2,gu=gx.ch;var gz;if(gu==0){gz=gy[2]}else{for(;;){var gw=(gt+gs)>>1;if((gw?gy[gw*2-1]:0)>=gu){gs=gw}else{if(gy[gw*2+1]<gu){gt=gw+1}else{gz=gy[gw*2+2];break}}}}var gv=gz?gz.indexOf("cm-overlay "):-1;return gv<0?gz:gv==0?null:gz.slice(0,gv-1)},getModeAt:function(gt){var gs=this.doc.mode;if(!gs.innerMode){return gs}return ab.innerMode(gs,this.getTokenAt(gt).state).mode},getHelper:function(gs,gt){return this.getHelpers(gs,gt)[0]},getHelpers:function(gx,gy){var gt=[];if(!ca.hasOwnProperty(gy)){return gt}var gu=ca[gy],gw=this.getModeAt(gx);if(typeof gw[gy]=="string"){if(gu[gw[gy]]){gt.push(gu[gw[gy]])}}else{if(gw[gy]){for(var gv=0;gv<gw[gy].length;gv++){var gz=gu[gw[gy][gv]];if(gz){gt.push(gz)}}}else{if(gw.helperType&&gu[gw.helperType]){gt.push(gu[gw.helperType])}else{if(gu[gw.name]){gt.push(gu[gw.name])}}}}for(var gv=0;gv<gu._global.length;gv++){var gs=gu._global[gv];if(gs.pred(gw,this)&&cl(gt,gs.val)==-1){gt.push(gs.val)}}return gt},getStateAfter:function(gt,gu){var gs=this.doc;gt=W(gs,gt==null?gs.first+gs.size-1:gt);return bW(this,gt+1,gu)},cursorCoords:function(gv,gs){var gt,gu=this.doc.sel.primary();if(gv==null){gt=gu.head}else{if(typeof gv=="object"){gt=X(this.doc,gv)}else{gt=gv?gu.from():gu.to()}}return aB(this,gt,gs||"page")},charCoords:function(gt,gs){return J(this,X(this.doc,gt),gs||"page")},coordsChar:function(gs,gt){gs=bI(this,gs,gt||"page");return ap(this,gs.left,gs.top)},lineAtHeight:function(gs,gt){gs=bI(this,{top:gs,left:0},gt||"page").top;return cT(this.doc,gs+this.display.viewOffset)},heightAtLine:function(gu,gw){var gs=false,gv;if(typeof gu=="number"){var gt=this.doc.first+this.doc.size-1;if(gu<this.doc.first){gu=this.doc.first}else{if(gu>gt){gu=gt;gs=true}}gv=bP(this.doc,gu)}else{gv=gu}return cu(this,gv,{top:0,left:0},gw||"page").top+(gs?this.doc.height-b9(gv):0)},defaultTextHeight:function(){return fP(this.display)},defaultCharWidth:function(){return K(this.display)},setGutterMarker:dC(function(gt,gs,gu){return I(this.doc,gt,"gutter",function(gv){var gw=gv.gutterMarkers||(gv.gutterMarkers={});gw[gs]=gu;if(!gu&&cw(gw)){gv.gutterMarkers=null}return true})}),clearGutter:dC(function(gu){var gs=this,gt=gs.doc,gv=gt.first;gt.iter(function(gw){if(gw.gutterMarkers&&gw.gutterMarkers[gu]){gw.gutterMarkers[gu]=null;eP(gs,gv,"gutter");if(cw(gw.gutterMarkers)){gw.gutterMarkers=null}}++gv})}),lineInfo:function(gs){if(typeof gs=="number"){if(!cy(this.doc,gs)){return null}var gt=gs;gs=bP(this.doc,gs);if(!gs){return null}}else{var gt=cZ(gs);if(gt==null){return null}}return{line:gt,handle:gs,text:gs.text,gutterMarkers:gs.gutterMarkers,textClass:gs.textClass,bgClass:gs.bgClass,wrapClass:gs.wrapClass,widgets:gs.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(gx,gw,gy,gA,gt){var gs=this.display;gx=aB(this,X(this.doc,gx));var gz=gx.bottom,gv=gx.left;gw.style.position="absolute";gw.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(gw);gs.sizer.appendChild(gw);if(gA=="over"){gz=gx.top}else{if(gA=="above"||gA=="near"){var gB=Math.max(gs.wrapper.clientHeight,this.doc.height),gu=Math.max(gs.sizer.clientWidth,gs.lineSpace.clientWidth);if((gA=="above"||gx.bottom+gw.offsetHeight>gB)&&gx.top>gw.offsetHeight){gz=gx.top-gw.offsetHeight}else{if(gx.bottom+gw.offsetHeight<=gB){gz=gx.bottom}}if(gv+gw.offsetWidth>gu){gv=gu-gw.offsetWidth}}}gw.style.top=gz+"px";gw.style.left=gw.style.right="";if(gt=="right"){gv=gs.sizer.clientWidth-gw.offsetWidth;gw.style.right="0px"}else{if(gt=="left"){gv=0}else{if(gt=="middle"){gv=(gs.sizer.clientWidth-gw.offsetWidth)/2}}gw.style.left=gv+"px"}if(gy){e9(this,gv,gz,gv+gw.offsetWidth,gz+gw.offsetHeight)}},triggerOnKeyDown:dC(d7),triggerOnKeyPress:dC(d8),triggerOnKeyUp:d9,execCommand:function(gs){if(af.hasOwnProperty(gs)){return af[gs].call(null,this)}},triggerElectric:dC(function(gs){fS(this,gs)}),findPosH:function(gv,gs,gx,gy){var gu=1;if(gs<0){gu=-1;gs=-gs}for(var gw=0,gt=X(this.doc,gv);gw<gs;++gw){gt=by(this.doc,gt,gu,gx,gy);if(gt.hitSide){break}}return gt},moveH:dC(function(gt,gu){var gs=this;gs.extendSelectionsBy(function(gv){if(gs.display.shift||gs.doc.extend||gv.empty()){return by(gs.doc,gv.head,gt,gu,gs.options.rtlMoveVisually)}else{return gt<0?gv.from():gv.to()}},fd)}),deleteH:dC(function(gs,gv){var gu=this.doc.sel,gt=this.doc;if(gu.somethingSelected()){gt.replaceSelection("",null,"+delete")}else{aG(this,function(gx){var gw=by(gt,gx.head,gs,gv,false);return gs<0?{from:gw,to:gx.head}:{from:gx.head,to:gw}})}}),findPosV:function(gw,gs,gz,gx){var gv=1,gA=gx;if(gs<0){gv=-1;gs=-gs}for(var gy=0,gu=X(this.doc,gw);gy<gs;++gy){var gt=aB(this,gu,"div");if(gA==null){gA=gt.left}else{gt.left=gA}gu=bz(this,gt,gv,gz);if(gu.hitSide){break}}return gu},moveV:dC(function(gu,gy){var gs=this,gv=this.doc,gw=[];var gt=!gs.display.shift&&!gv.extend&&gv.sel.somethingSelected();gv.extendSelectionsBy(function(gB){if(gt){return gu<0?gB.from():gB.to()}var gz=aB(gs,gB.head,"div");if(gB.goalColumn!=null){gz.left=gB.goalColumn}gw.push(gz.left);var gA=bz(gs,gz,gu,gy);if(gy=="page"&&gB==gv.sel.primary()){g(gs,null,J(gs,gA,"div").top-gz.top)}return gA},fd);if(gw.length){for(var gx=0;gx<gv.sel.ranges.length;gx++){gv.sel.ranges[gx].goalColumn=gw[gx]}}}),findWordAt:function(gx){var gt=this.doc,gw=bP(gt,gx.line).text;var gy=gx.ch,gu=gx.ch;if(gw){var gv=this.getHelper(gx,"wordChars");if((gx.xRel<0||gu==gw.length)&&gy){--gy}else{++gu}var gz=gw.charAt(gy);var gs=cB(gz,gv)?function(gA){return cB(gA,gv)}:/\s/.test(gz)?function(gA){return/\s/.test(gA)}:function(gA){return !/\s/.test(gA)&&!cB(gA)};while(gy>0&&gs(gw.charAt(gy-1))){--gy}while(gu<gw.length&&gs(gw.charAt(gu))){++gu}}return new eG(er(gx.line,gy),er(gx.line,gu))},toggleOverwrite:function(gs){if(gs!=null&&gs==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){c(this.display.cursorDiv,"CodeMirror-overwrite")}else{e1(this.display.cursorDiv,"CodeMirror-overwrite")}ft(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==a()},isReadOnly:function(){return !!(this.options.readOnly||this.doc.cantEdit)},scrollTo:dC(function(gs,gt){if(gs!=null||gt!=null){eZ(this)}if(gs!=null){this.curOp.scrollLeft=gs}if(gt!=null){this.curOp.scrollTop=gt}}),getScrollInfo:function(){var gs=this.display.scroller;return{left:gs.scrollLeft,top:gs.scrollTop,height:gs.scrollHeight-e8(this)-this.display.barHeight,width:gs.scrollWidth-e8(this)-this.display.barWidth,clientHeight:aM(this),clientWidth:aO(this)}},scrollIntoView:dC(function(gt,gs){if(gt==null){gt={from:this.doc.sel.primary().head,to:null};if(gs==null){gs=this.options.cursorScrollMargin}}else{if(typeof gt=="number"){gt={from:er(gt,0),to:null}}else{if(gt.from==null){gt={from:gt,to:null}}}}if(!gt.to){gt.to=gt.from}gt.margin=gs||0;if(gt.from.line!=null){eZ(this);this.curOp.scrollToPos=gt}else{var gu=E(this,Math.min(gt.from.left,gt.to.left),Math.min(gt.from.top,gt.to.top)-gt.margin,Math.max(gt.from.right,gt.to.right),Math.max(gt.from.bottom,gt.to.bottom)+gt.margin);this.scrollTo(gu.scrollLeft,gu.scrollTop)}}),setSize:dC(function(gw,gt){var gs=this;function gu(gx){return typeof gx=="number"||/^\d+$/.test(String(gx))?gx+"px":gx}if(gw!=null){gs.display.wrapper.style.width=gu(gw)}if(gt!=null){gs.display.wrapper.style.height=gu(gt)}if(gs.options.lineWrapping){S(this)}var gv=gs.display.viewFrom;gs.doc.iter(gv,gs.display.viewTo,function(gy){if(gy.widgets){for(var gx=0;gx<gy.widgets.length;gx++){if(gy.widgets[gx].noHScroll){eP(gs,gv,"widget");break}}}++gv});gs.curOp.forceUpdate=true;ft(gs,"refresh",this)}),operation:function(gs){return e2(this,gs)},refresh:dC(function(){var gs=this.display.cachedTextHeight;eM(this);this.curOp.forceUpdate=true;P(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);fY(this);if(gs==null||Math.abs(gs-fP(this.display))>0.5){bk(this)}ft(this,"refresh",this)}),swapDoc:dC(function(gs){var gt=this.doc;gt.cm=null;m(this,gs);P(this);this.display.input.reset();this.scrollTo(gs.scrollLeft,gs.scrollTop);this.curOp.forceScroll=true;fw(this,"swapDoc",this,gt);return gt}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bm(ab);var aC=ab.defaults={};var eg=ab.optionHandlers={};function ef(gu,gs,gt,gv){ab.defaults[gu]=gs;if(gt){eg[gu]=gv?function(gw,gy,gx){if(gx!=cm){gt(gw,gy,gx)}}:gt}}var cm=ab.Init={toString:function(){return"CodeMirror.Init"}};ef("value","",function(gs,gt){gs.setValue(gt)},true);ef("mode",null,function(gs,gt){gs.doc.modeOption=gt;c7(gs)},true);ef("indentUnit",2,c7,true);ef("indentWithTabs",false);ef("smartIndent",true);ef("tabSize",4,function(gs){eX(gs);P(gs);eM(gs)},true);ef("lineSeparator",null,function(gs,gw){gs.doc.lineSep=gw;if(!gw){return}var gv=[],gu=gs.doc.first;gs.doc.iter(function(gy){for(var gz=0;;){var gx=gy.text.indexOf(gw,gz);if(gx==-1){break}gz=gx+gw.length;gv.push(er(gu,gx))}gu++});for(var gt=gv.length-1;gt>=0;gt--){eW(gs.doc,gw,gv[gt],er(gv[gt].line,gv[gt].ch+gw.length))}});ef("specialChars",/[\u0000-\u001f\u007f\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(gs,gu,gt){gs.state.specialChars=new RegExp(gu.source+(gu.test("\t")?"":"|\t"),"g");if(gt!=ab.Init){gs.refresh()}});ef("specialCharPlaceholder",aD,function(gs){gs.refresh()},true);ef("electricChars",true);ef("inputStyle",dF?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);ef("spellcheck",false,function(gs,gt){gs.getInputField().spellcheck=gt},true);ef("rtlMoveVisually",!go);ef("wholeLineUpdateBefore",true);ef("theme","default",function(gs){fR(gs);b0(gs)},true);ef("keyMap","default",function(gs,gw,gu){var gt=bO(gw);var gv=gu!=ab.Init&&bO(gu);if(gv&&gv.detach){gv.detach(gs,gt)}if(gt.attach){gt.attach(gs,gv||null)}});ef("extraKeys",null);ef("lineWrapping",false,gp,true);ef("gutters",[],function(gs){fi(gs.options);b0(gs)},true);ef("fixedGutter",true,function(gs,gt){gs.display.gutters.style.left=gt?ai(gs.display)+"px":"0";gs.refresh()},true);ef("coverGutterNextToScrollbar",false,function(gs){f8(gs)},true);ef("scrollbarStyle","native",function(gs){co(gs);f8(gs);gs.display.scrollbars.setScrollTop(gs.doc.scrollTop);gs.display.scrollbars.setScrollLeft(gs.doc.scrollLeft)},true);ef("lineNumbers",false,function(gs){fi(gs.options);b0(gs)},true);ef("firstLineNumber",1,b0,true);ef("lineNumberFormatter",function(gs){return gs},b0,true);ef("showCursorWhenSelecting",false,ga,true);ef("resetSelectionOnContextMenu",true);ef("lineWiseCopyCut",true);ef("readOnly",false,function(gs,gt){if(gt=="nocursor"){d1(gs);gs.display.input.blur();gs.display.disabled=true}else{gs.display.disabled=false}gs.display.input.readOnlyChanged(gt)});ef("disableInput",false,function(gs,gt){if(!gt){gs.display.input.reset()}},true);ef("dragDrop",true,aW);ef("allowDropFileTypes",null);ef("cursorBlinkRate",530);ef("cursorScrollMargin",0);ef("cursorHeight",1,ga,true);ef("singleCursorHeightPerLine",true,ga,true);ef("workTime",100);ef("workDelay",100);ef("flattenSpans",true,eX,true);ef("addModeClass",false,eX,true);ef("pollInterval",100);ef("undoDepth",200,function(gs,gt){gs.doc.history.undoDepth=gt});ef("historyEventDelay",1250);ef("viewportMargin",10,function(gs){gs.refresh()},true);ef("maxHighlightLength",10000,eX,true);ef("moveInputWithCursor",true,function(gs,gt){if(!gt){gs.display.input.resetPosition()}});ef("tabindex",null,function(gs,gt){gs.display.input.getField().tabIndex=gt||""});ef("autofocus",null);var dH=ab.modes={},dD=ab.mimeModes={};ab.defineMode=function(gt,gs){if(!ab.defaults.mode&&gt!="null"){ab.defaults.mode=gt}if(arguments.length>2){gs.dependencies=Array.prototype.slice.call(arguments,2)}dH[gt]=gs};ab.defineMIME=function(gs,gt){dD[gs]=gt};ab.resolveMode=function(gt){if(typeof gt=="string"&&dD.hasOwnProperty(gt)){gt=dD[gt]}else{if(gt&&typeof gt.name=="string"&&dD.hasOwnProperty(gt.name)){var gs=dD[gt.name];if(typeof gs=="string"){gs={name:gs}}gt=aA(gs,gt);gt.name=gs.name}else{if(typeof gt=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(gt)){return ab.resolveMode("application/xml")}else{if(typeof gt=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(gt)){return ab.resolveMode("application/json")}}}}if(typeof gt=="string"){return{name:gt}}else{return gt||{name:"null"}}};ab.getMode=function(gv,gx){var gx=ab.resolveMode(gx);var gt=dH[gx.name];if(!gt){return ab.getMode(gv,"text/plain")}var gu=gt(gv,gx);if(dG.hasOwnProperty(gx.name)){var gs=dG[gx.name];for(var gw in gs){if(!gs.hasOwnProperty(gw)){continue}if(gu.hasOwnProperty(gw)){gu["_"+gw]=gu[gw]}gu[gw]=gs[gw]}}gu.name=gx.name;if(gx.helperType){gu.helperType=gx.helperType}if(gx.modeProps){for(var gw in gx.modeProps){gu[gw]=gx.modeProps[gw]}}return gu};ab.defineMode("null",function(){return{token:function(gs){gs.skipToEnd()}}});ab.defineMIME("text/plain","null");var dG=ab.modeExtensions={};ab.extendMode=function(gt,gu){var gs=dG.hasOwnProperty(gt)?dG[gt]:(dG[gt]={});au(gu,gs)};ab.defineExtension=function(gt,gs){ab.prototype[gt]=gs};ab.defineDocExtension=function(gt,gs){aP.prototype[gt]=gs};ab.defineOption=ef;var cn=[];ab.defineInitHook=function(gs){cn.push(gs)};var ca=ab.helpers={};ab.registerHelper=function(gt,gs,gu){if(!ca.hasOwnProperty(gt)){ca[gt]=ab[gt]={_global:[]}}ca[gt][gs]=gu};ab.registerGlobalHelper=function(gu,gs,gt,gv){ab.registerHelper(gu,gs,gv);ca[gu]._global.push({pred:gt,val:gv})};var ax=ab.copyState=function(gs,gv){if(gv===true){return gv}if(gs.copyState){return gs.copyState(gv)}var gu={};for(var gt in gv){var gw=gv[gt];if(gw instanceof Array){gw=gw.concat([])}gu[gt]=gw}return gu};var fG=ab.startState=function(gu,gs,gt){return gu.startState?gu.startState(gs,gt):true};ab.innerMode=function(gt,gu){while(gt.innerMode){var gs=gt.innerMode(gu);if(!gs||gs.mode==gt){break}gu=gs.state;gt=gs.mode}return gs||{mode:gt,state:gu}};var af=ab.commands={selectAll:function(gs){gs.setSelection(er(gs.firstLine(),0),er(gs.lastLine()),fb)},singleSelection:function(gs){gs.setSelection(gs.getCursor("anchor"),gs.getCursor("head"),fb)},killLine:function(gs){aG(gs,function(gu){if(gu.empty()){var gt=bP(gs.doc,gu.head.line).text.length;if(gu.head.ch==gt&&gu.head.line<gs.lastLine()){return{from:gu.head,to:er(gu.head.line+1,0)}}else{return{from:gu.head,to:er(gu.head.line,gt)}}}else{return{from:gu.from(),to:gu.to()}}})},deleteLine:function(gs){aG(gs,function(gt){return{from:er(gt.from().line,0),to:X(gs.doc,er(gt.to().line+1,0))}})},delLineLeft:function(gs){aG(gs,function(gt){return{from:er(gt.from().line,0),to:gt.from()}})},delWrappedLineLeft:function(gs){aG(gs,function(gu){var gv=gs.charCoords(gu.head,"div").top+5;var gt=gs.coordsChar({left:0,top:gv},"div");return{from:gt,to:gu.from()}})},delWrappedLineRight:function(gs){aG(gs,function(gt){var gv=gs.charCoords(gt.head,"div").top+5;var gu=gs.coordsChar({left:gs.display.lineDiv.offsetWidth+100,top:gv},"div");return{from:gt.from(),to:gu}})},undo:function(gs){gs.undo()},redo:function(gs){gs.redo()},undoSelection:function(gs){gs.undoSelection()},redoSelection:function(gs){gs.redoSelection()},goDocStart:function(gs){gs.extendSelection(er(gs.firstLine(),0))},goDocEnd:function(gs){gs.extendSelection(er(gs.lastLine()))},goLineStart:function(gs){gs.extendSelectionsBy(function(gt){return c2(gs,gt.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(gs){gs.extendSelectionsBy(function(gt){return c3(gs,gt.head)},{origin:"+move",bias:1})},goLineEnd:function(gs){gs.extendSelectionsBy(function(gt){return cU(gs,gt.head.line)},{origin:"+move",bias:-1})},goLineRight:function(gs){gs.extendSelectionsBy(function(gt){var gu=gs.charCoords(gt.head,"div").top+5;return gs.coordsChar({left:gs.display.lineDiv.offsetWidth+100,top:gu},"div")},fd)},goLineLeft:function(gs){gs.extendSelectionsBy(function(gt){var gu=gs.charCoords(gt.head,"div").top+5;return gs.coordsChar({left:0,top:gu},"div")},fd)},goLineLeftSmart:function(gs){gs.extendSelectionsBy(function(gu){var gv=gs.charCoords(gu.head,"div").top+5;var gt=gs.coordsChar({left:0,top:gv},"div");if(gt.ch<gs.getLine(gt.line).search(/\S/)){return c3(gs,gu.head)}return gt},fd)},goLineUp:function(gs){gs.moveV(-1,"line")},goLineDown:function(gs){gs.moveV(1,"line")},goPageUp:function(gs){gs.moveV(-1,"page")},goPageDown:function(gs){gs.moveV(1,"page")},goCharLeft:function(gs){gs.moveH(-1,"char")},goCharRight:function(gs){gs.moveH(1,"char")},goColumnLeft:function(gs){gs.moveH(-1,"column")},goColumnRight:function(gs){gs.moveH(1,"column")},goWordLeft:function(gs){gs.moveH(-1,"word")},goGroupRight:function(gs){gs.moveH(1,"group")},goGroupLeft:function(gs){gs.moveH(-1,"group")},goWordRight:function(gs){gs.moveH(1,"word")},delCharBefore:function(gs){gs.deleteH(-1,"char")},delCharAfter:function(gs){gs.deleteH(1,"char")},delWordBefore:function(gs){gs.deleteH(-1,"word")},delWordAfter:function(gs){gs.deleteH(1,"word")},delGroupBefore:function(gs){gs.deleteH(-1,"group")},delGroupAfter:function(gs){gs.deleteH(1,"group")},indentAuto:function(gs){gs.indentSelection("smart")},indentMore:function(gs){gs.indentSelection("add")},indentLess:function(gs){gs.indentSelection("subtract")},insertTab:function(gs){gs.replaceSelection("\t")},insertSoftTab:function(gs){var gx=[],gw=gs.listSelections(),gy=gs.options.tabSize;for(var gu=0;gu<gw.length;gu++){var gv=gw[gu].from();var gt=ay(gs.getLine(gv.line),gv.ch,gy);gx.push(fB(gy-gt%gy))}gs.replaceSelections(gx)},defaultTab:function(gs){if(gs.somethingSelected()){gs.indentSelection("add")}else{gs.execCommand("insertTab")}},transposeChars:function(gs){e2(gs,function(){var gy=gs.listSelections(),gw=[];for(var gu=0;gu<gy.length;gu++){var gt=gy[gu].head,gv=bP(gs.doc,gt.line).text;if(gv){if(gt.ch==gv.length){gt=new er(gt.line,gt.ch-1)}if(gt.ch>0){gt=new er(gt.line,gt.ch+1);gs.replaceRange(gv.charAt(gt.ch-1)+gv.charAt(gt.ch-2),er(gt.line,gt.ch-2),gt,"+transpose")}else{if(gt.line>gs.doc.first){var gx=bP(gs.doc,gt.line-1).text;if(gx){gs.replaceRange(gv.charAt(0)+gs.doc.lineSeparator()+gx.charAt(gx.length-1),er(gt.line-1,gx.length-1),er(gt.line,1),"+transpose")}}}}gw.push(new eG(gt,gt))}gs.setSelections(gw)})},newlineAndIndent:function(gs){e2(gs,function(){var gu=gs.listSelections().length;for(var gt=0;gt<gu;gt++){var gv=gs.listSelections()[gt];gs.replaceRange(gs.doc.lineSeparator(),gv.anchor,gv.head,"+input");gs.indentLine(gv.from().line+1,null,true)}bd(gs)})},openLine:function(gs){gs.replaceSelection("\n","start")},toggleOverwrite:function(gs){gs.toggleOverwrite()}};var cF=ab.keyMap={};cF.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};cF.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};cF.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};cF.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};cF["default"]=dc?cF.macDefault:cF.pcDefault;function dT(gx){var gy=gx.split(/-(?!$)/),gx=gy[gy.length-1];var gs,gu,gz,gt;for(var gv=0;gv<gy.length-1;gv++){var gw=gy[gv];if(/^(cmd|meta|m)$/i.test(gw)){gt=true}else{if(/^a(lt)?$/i.test(gw)){gs=true}else{if(/^(c|ctrl|control)$/i.test(gw)){gu=true}else{if(/^s(hift)$/i.test(gw)){gz=true}else{throw new Error("Unrecognized modifier name: "+gw)}}}}}if(gs){gx="Alt-"+gx}if(gu){gx="Ctrl-"+gx}if(gt){gx="Cmd-"+gx}if(gz){gx="Shift-"+gx}return gx}ab.normalizeKeyMap=function(gu){var gs={};for(var gv in gu){if(gu.hasOwnProperty(gv)){var gB=gu[gv];if(/^(name|fallthrough|(de|at)tach)$/.test(gv)){continue}if(gB=="..."){delete gu[gv];continue}var gw=dj(gv.split(" "),dT);for(var gt=0;gt<gw.length;gt++){var gA,gx;if(gt==gw.length-1){gx=gw.join(" ");gA=gB}else{gx=gw.slice(0,gt+1).join(" ");gA="..."}var gy=gs[gx];if(!gy){gs[gx]=gA}else{if(gy!=gA){throw new Error("Inconsistent bindings for "+gx)}}}delete gu[gv]}}for(var gz in gs){gu[gz]=gs[gz]}return gu};var c9=ab.lookupKey=function(gw,gx,gu,gs){gx=bO(gx);var gt=gx.call?gx.call(gw,gs):gx[gw];if(gt===false){return"nothing"}if(gt==="..."){return"multi"}if(gt!=null&&gu(gt)){return"handled"}if(gx.fallthrough){if(Object.prototype.toString.call(gx.fallthrough)!="[object Array]"){return c9(gw,gx.fallthrough,gu,gs)}for(var gv=0;gv<gx.fallthrough.length;gv++){var gy=c9(gw,gx.fallthrough[gv],gu,gs);if(gy){return gy}}}};var cz=ab.isModifierKey=function(gt){var gs=typeof gt=="string"?gt:cH[gt.keyCode];return gs=="Ctrl"||gs=="Alt"||gs=="Shift"||gs=="Mod"};var cG=ab.keyName=function(gt,gv){if(ez&&gt.keyCode==34&&gt["char"]){return false}var gs=cH[gt.keyCode],gu=gs;if(gu==null||gt.altGraphKey){return false}if(gt.altKey&&gs!="Alt"){gu="Alt-"+gu}if((bG?gt.metaKey:gt.ctrlKey)&&gs!="Ctrl"){gu="Ctrl-"+gu}if((bG?gt.ctrlKey:gt.metaKey)&&gs!="Cmd"){gu="Cmd-"+gu}if(!gv&&gt.shiftKey&&gs!="Shift"){gu="Shift-"+gu}return gu};function bO(gs){return typeof gs=="string"?cF[gs]:gs}ab.fromTextArea=function(gz,gw){gw=gw?au(gw):{};gw.value=gz.value;if(!gw.tabindex&&gz.tabIndex){gw.tabindex=gz.tabIndex}if(!gw.placeholder&&gz.placeholder){gw.placeholder=gz.placeholder}if(gw.autofocus==null){var gv=a();gw.autofocus=gv==gz||gz.getAttribute("autofocus")!=null&&gv==document.body}function gy(){gz.value=gs.getValue()}if(gz.form){d0(gz.form,"submit",gy);if(!gw.leaveSubmitMethodAlone){var gu=gz.form,gx=gu.submit;try{var gA=gu.submit=function(){gy();gu.submit=gx;gu.submit();gu.submit=gA}}catch(gt){}}}gw.finishInit=function(gB){gB.save=gy;gB.getTextArea=function(){return gz};gB.toTextArea=function(){gB.toTextArea=isNaN;gy();gz.parentNode.removeChild(gB.getWrapperElement());gz.style.display="";if(gz.form){dY(gz.form,"submit",gy);if(typeof gz.form.submit=="function"){gz.form.submit=gx}}}};gz.style.display="none";var gs=ab(function(gB){gz.parentNode.insertBefore(gB,gz.nextSibling)},gw);return gs};var fK=ab.StringStream=function(gs,gt){this.pos=this.start=0;this.string=gs;this.tabSize=gt||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};fK.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(gt){var gs=this.string.charAt(this.pos);if(typeof gt=="string"){var gu=gs==gt}else{var gu=gs&&(gt.test?gt.test(gs):gt(gs))}if(gu){++this.pos;return gs}},eatWhile:function(gs){var gt=this.pos;while(this.eat(gs)){}return this.pos>gt},eatSpace:function(){var gs=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>gs},skipToEnd:function(){this.pos=this.string.length},skipTo:function(gs){var gt=this.string.indexOf(gs,this.pos);if(gt>-1){this.pos=gt;return true}},backUp:function(gs){this.pos-=gs},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=ay(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?ay(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return ay(this.string,null,this.tabSize)-(this.lineStart?ay(this.string,this.lineStart,this.tabSize):0)},match:function(gw,gu,gt){if(typeof gw=="string"){var gs=function(gy){return gt?gy.toLowerCase():gy};var gx=this.string.substr(this.pos,gw.length);if(gs(gx)==gs(gw)){if(gu!==false){this.pos+=gw.length}return true}}else{var gv=this.string.slice(this.pos).match(gw);if(gv&&gv.index>0){return null}if(gv&&gu!==false){this.pos+=gv[0].length}return gv}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(gt,gs){this.lineStart+=gt;try{return gs()}finally{this.lineStart-=gt}}};var dO=0;var fQ=ab.TextMarker=function(gs,gt){this.lines=[];this.type=gt;this.doc=gs;this.id=++dO};bm(fQ);fQ.prototype.clear=function(){if(this.explicitlyCleared){return}var gs=this.doc.cm,gB=gs&&!gs.curOp;if(gB){fF(gs)}if(b7(this,"clear")){var gt=this.find();if(gt){fw(this,"clear",gt.from,gt.to)}}var gy=null,gx=null;for(var gu=0;gu<this.lines.length;++gu){var gw=this.lines[gu];var gz=bT(gw.markedSpans,this);if(gs&&!this.collapsed){eP(gs,cZ(gw),"text")}else{if(gs){if(gz.to!=null){gx=cZ(gw)}if(gz.from!=null){gy=cZ(gw)}}}gw.markedSpans=eT(gw.markedSpans,gz);if(gz.from==null&&this.collapsed&&!cV(this.doc,gw)&&gs){f5(gw,fP(gs.display))}}if(gs&&this.collapsed&&!gs.options.lineWrapping){for(var gu=0;gu<this.lines.length;++gu){var gA=gf(this.lines[gu]),gv=cY(gA);if(gv>gs.display.maxLineLength){gs.display.maxLine=gA;gs.display.maxLineLength=gv;gs.display.maxLineChanged=true}}}if(gy!=null&&gs&&this.collapsed){eM(gs,gy,gx+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(gs){eL(gs.doc)}}if(gs){fw(gs,"markerCleared",gs,this)}if(gB){a6(gs)}if(this.parent){this.parent.clear()}};fQ.prototype.find=function(gw,gv){if(gw==null&&this.type=="bookmark"){gw=1}var gs,gy;for(var gt=0;gt<this.lines.length;++gt){var gu=this.lines[gt];var gx=bT(gu.markedSpans,this);if(gx.from!=null){gs=er(gv?gu:cZ(gu),gx.from);if(gw==-1){return gs}}if(gx.to!=null){gy=er(gv?gu:cZ(gu),gx.to);if(gw==1){return gy}}}return gs&&{from:gs,to:gy}};fQ.prototype.changed=function(){var gt=this.find(-1,true),gu=this,gs=this.doc.cm;if(!gt||!gs){return}e2(gs,function(){var gw=gt.line,gx=cZ(gt.line);var gz=bC(gs,gx);if(gz){T(gz);gs.curOp.selectionChanged=gs.curOp.forceUpdate=true}gs.curOp.updateMaxLine=true;if(!cV(gu.doc,gw)&&gu.height!=null){var gy=gu.height;gu.height=null;var gv=gn(gu)-gy;if(gv){f5(gw,gw.height+gv)}}})};fQ.prototype.attachLine=function(gs){if(!this.lines.length&&this.doc.cm){var gt=this.doc.cm.curOp;if(!gt.maybeHiddenMarkers||cl(gt.maybeHiddenMarkers,this)==-1){(gt.maybeUnhiddenMarkers||(gt.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(gs)};fQ.prototype.detachLine=function(gs){this.lines.splice(cl(this.lines,gs),1);if(!this.lines.length&&this.doc.cm){var gt=this.doc.cm.curOp;(gt.maybeHiddenMarkers||(gt.maybeHiddenMarkers=[])).push(this)}};var dO=0;function dp(gv,gw,gA,gz,gB){if(gz&&gz.shared){return dq(gv,gw,gA,gz,gB)}if(gv.cm&&!gv.cm.curOp){return ed(gv.cm,dp)(gv,gw,gA,gz,gB)}var gy=new fQ(gv,gB),gu=aa(gw,gA);if(gz){au(gz,gy,false)}if(gu>0||gu==0&&gy.clearWhenEmpty!==false){return gy}if(gy.replacedWith){gy.collapsed=true;gy.widgetNode=a5("span",[gy.replacedWith],"CodeMirror-widget");if(!gz.handleMouseEvents){gy.widgetNode.setAttribute("cm-ignore-events","true")}if(gz.insertLeft){gy.widgetNode.insertLeft=true}}if(gy.collapsed){if(al(gv,gw.line,gw,gA,gy)||gw.line!=gA.line&&al(gv,gA.line,gw,gA,gy)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}e5=true}if(gy.addToHistory){b(gv,{from:gw,to:gA,origin:"markText"},gv.sel,NaN)}var gt=gw.line,gs=gv.cm,gC;gv.iter(gt,gA.line+1,function(gD){if(gs&&gy.collapsed&&!gs.options.lineWrapping&&gf(gD)==gs.display.maxLine){gC=true}if(gy.collapsed&&gt!=gw.line){f5(gD,0)}e(gD,new dl(gy,gt==gw.line?gw.ch:null,gt==gA.line?gA.ch:null));++gt});if(gy.collapsed){gv.iter(gw.line,gA.line+1,function(gD){if(cV(gv,gD)){f5(gD,0)}})}if(gy.clearOnEnter){d0(gy,"beforeCursorEnter",function(){gy.clear()})}if(gy.readOnly){e6=true;if(gv.history.done.length||gv.history.undone.length){gv.clearHistory()}}if(gy.collapsed){gy.id=++dO;gy.atomic=true}if(gs){if(gC){gs.curOp.updateMaxLine=true}if(gy.collapsed){eM(gs,gw.line,gA.line+1)}else{if(gy.className||gy.title||gy.startStyle||gy.endStyle||gy.css){for(var gx=gw.line;gx<=gA.line;gx++){eP(gs,gx,"text")}}}if(gy.atomic){eL(gs.doc)}fw(gs,"markerAdded",gs,gy)}return gy}var fq=ab.SharedTextMarker=function(gt,gu){this.markers=gt;this.primary=gu;for(var gs=0;gs<gt.length;++gs){gt[gs].parent=this}};bm(fq);fq.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var gs=0;gs<this.markers.length;++gs){this.markers[gs].clear()}fw(this,"clear")};fq.prototype.find=function(gt,gs){return this.primary.find(gt,gs)};function dq(gs,gt,gx,gv,gy){gv=au(gv);gv.shared=false;var gu=[dp(gs,gt,gx,gv,gy)],gw=gu[0];var gz=gv.widgetNode;c6(gs,function(gA){if(gz){gv.widgetNode=gz.cloneNode(true)}gu.push(dp(gA,X(gA,gt),X(gA,gx),gv,gy));for(var gB=0;gB<gA.linked.length;++gB){if(gA.linked[gB].isParent){return}}gw=db(gu)});return new fq(gu,gw)}function bA(gs){return gs.findMarks(er(gs.first,0),gs.clipPos(er(gs.lastLine())),function(gt){return gt.parent})}function aw(gs,gv){for(var gt=0;gt<gv.length;gt++){var gu=gv[gt],gy=gu.find();var gw=gs.clipPos(gy.from),gx=gs.clipPos(gy.to);if(aa(gw,gx)){var gz=dp(gs,gw,gx,gu.primary,gu.primary.type);gu.markers.push(gz);gz.parent=gu}}}function aI(gw){for(var gs=0;gs<gw.length;gs++){var gv=gw[gs],gu=[gv.primary.doc];c6(gv.primary.doc,function(gy){gu.push(gy)});for(var gt=0;gt<gv.markers.length;gt++){var gx=gv.markers[gt];if(cl(gu,gx.doc)==-1){gx.parent=null;gv.markers.splice(gt--,1)}}}}function dl(gt,gs,gu){this.marker=gt;this.from=gs;this.to=gu}function bT(gv,gt){if(gv){for(var gs=0;gs<gv.length;++gs){var gu=gv[gs];if(gu.marker==gt){return gu}}}}function eT(gv,gu){for(var gt,gs=0;gs<gv.length;++gs){if(gv[gs]!=gu){(gt||(gt=[])).push(gv[gs])}}return gt}function e(gs,gt){gs.markedSpans=gs.markedSpans?gs.markedSpans.concat([gt]):[gt];gt.marker.attachLine(gs)}function dn(gx,gz,gu){if(gx){for(var gt=0,gw;gt<gx.length;++gt){var gy=gx[gt],gv=gy.marker;var gA=gy.from==null||(gv.inclusiveLeft?gy.from<=gz:gy.from<gz);if(gA||gy.from==gz&&gv.type=="bookmark"&&(!gu||!gy.marker.insertLeft)){var gs=gy.to==null||(gv.inclusiveRight?gy.to>=gz:gy.to>gz);(gw||(gw=[])).push(new dl(gv,gy.from,gs?null:gy.to))}}}return gw}function dm(gy,gs,gv){if(gy){for(var gu=0,gx;gu<gy.length;++gu){var gz=gy[gu],gw=gz.marker;var gt=gz.to==null||(gw.inclusiveRight?gz.to>=gs:gz.to>gs);if(gt||gz.from==gs&&gw.type=="bookmark"&&(!gv||gz.marker.insertLeft)){var gA=gz.from==null||(gw.inclusiveLeft?gz.from<=gs:gz.from<gs);(gx||(gx=[])).push(new dl(gw,gA?null:gz.from-gs,gz.to==null?null:gz.to-gs))}}}return gx}function fJ(gt,gs){if(gs.full){return null}var gE=cy(gt,gs.from.line)&&bP(gt,gs.from.line).markedSpans;var gF=cy(gt,gs.to.line)&&bP(gt,gs.to.line).markedSpans;if(!gE&&!gF){return null}var gI=gs.from.ch,gu=gs.to.ch,gA=aa(gs.from,gs.to)==0;var gv=dn(gE,gI,gA);var gB=dm(gF,gu,gA);var gG=gs.text.length==1,gD=db(gs.text).length+(gG?gI:0);if(gv){for(var gz=0;gz<gv.length;++gz){var gH=gv[gz];if(gH.to==null){var gw=bT(gB,gH.marker);if(!gw){gH.to=gI}else{if(gG){gH.to=gw.to==null?null:gw.to+gD}}}}}if(gB){for(var gz=0;gz<gB.length;++gz){var gH=gB[gz];if(gH.to!=null){gH.to+=gD}if(gH.from==null){var gw=bT(gv,gH.marker);if(!gw){gH.from=gD;if(gG){(gv||(gv=[])).push(gH)}}}else{gH.from+=gD;if(gG){(gv||(gv=[])).push(gH)}}}}if(gv){gv=R(gv)}if(gB&&gB!=gv){gB=R(gB)}var gC=[gv];if(!gG){var gx=gs.text.length-2,gy;if(gx>0&&gv){for(var gz=0;gz<gv.length;++gz){if(gv[gz].to==null){(gy||(gy=[])).push(new dl(gv[gz].marker,null,null))}}}for(var gz=0;gz<gx;++gz){gC.push(gy)}gC.push(gB)}return gC}function R(gu){for(var gs=0;gs<gu.length;++gs){var gt=gu[gs];if(gt.from!=null&&gt.from==gt.to&&gt.marker.clearWhenEmpty!==false){gu.splice(gs--,1)}}if(!gu.length){return null}return gu}function dB(gt,gs){var gx=bU(gt,gs);var gB=fJ(gt,gs);if(!gx){return gB}if(!gB){return gx}for(var gu=0;gu<gx.length;++gu){var gy=gx[gu],gA=gB[gu];if(gy&&gA){spans:for(var gv=0;gv<gA.length;++gv){var gz=gA[gv];for(var gw=0;gw<gy.length;++gw){if(gy[gw].marker==gz.marker){continue spans}}gy.push(gz)}}else{if(gA){gx[gu]=gA}}}return gx}function eU(gt,gv,gE){var gz=null;gt.iter(gv.line,gE.line+1,function(gG){if(gG.markedSpans){for(var gF=0;gF<gG.markedSpans.length;++gF){var gH=gG.markedSpans[gF].marker;if(gH.readOnly&&(!gz||cl(gz,gH)==-1)){(gz||(gz=[])).push(gH)}}}});if(!gz){return null}var gD=[{from:gv,to:gE}];for(var gw=0;gw<gz.length;++gw){var gA=gz[gw],gy=gA.find(0);for(var gx=0;gx<gD.length;++gx){var gC=gD[gx];if(aa(gC.to,gy.from)<0||aa(gC.from,gy.to)>0){continue}var gB=[gx,1],gs=aa(gC.from,gy.from),gu=aa(gC.to,gy.to);if(gs<0||!gA.inclusiveLeft&&!gs){gB.push({from:gC.from,to:gy.from})}if(gu>0||!gA.inclusiveRight&&!gu){gB.push({from:gy.to,to:gC.to})}gD.splice.apply(gD,gB);gx+=gB.length-1}}return gD}function aH(gt){var gu=gt.markedSpans;if(!gu){return}for(var gs=0;gs<gu.length;++gs){gu[gs].marker.detachLine(gt)}gt.markedSpans=null}function o(gt,gu){if(!gu){return}for(var gs=0;gs<gu.length;++gs){gu[gs].marker.attachLine(gt)}gt.markedSpans=gu}function bs(gs){return gs.inclusiveLeft?-1:0}function bt(gs){return gs.inclusiveRight?1:0}function ah(gs,gu){var gx=gs.lines.length-gu.lines.length;if(gx!=0){return gx}var gt=gs.find(),gv=gu.find();var gw=aa(gt.from,gv.from)||bs(gs)-bs(gu);if(gw){return -gw}var gy=aa(gt.to,gv.to)||bt(gs)-bt(gu);if(gy){return gy}return gu.id-gs.id}function ad(gu,gx){var gw=e5&&gu.markedSpans,gs;if(gw){for(var gv,gt=0;gt<gw.length;++gt){gv=gw[gt];if(gv.marker.collapsed&&(gx?gv.from:gv.to)==null&&(!gs||ah(gs,gv.marker)<0)){gs=gv.marker}}}return gs}function ae(gs){return ad(gs,true)}function ac(gs){return ad(gs,false)}function al(gs,gy,gu,gC,gz){var gx=bP(gs,gy);var gB=e5&&gx.markedSpans;if(gB){for(var gw=0;gw<gB.length;++gw){var gA=gB[gw];if(!gA.marker.collapsed){continue}var gt=gA.marker.find(0);var gv=aa(gt.from,gu)||bs(gA.marker)-bs(gz);var gD=aa(gt.to,gC)||bt(gA.marker)-bt(gz);if(gv>=0&&gD<=0||gv<=0&&gD>=0){continue}if(gv<=0&&(gA.marker.inclusiveRight&&gz.inclusiveLeft?aa(gt.to,gu)>=0:aa(gt.to,gu)>0)||gv>=0&&(gA.marker.inclusiveRight&&gz.inclusiveLeft?aa(gt.from,gC)<=0:aa(gt.from,gC)<0)){return true}}}}function gf(gs){var gt;while(gt=ae(gs)){gs=gt.find(-1,true).line}return gs}function gg(gs){var gu,gt;while(gu=ac(gs)){gs=gu.find(1,true).line;(gt||(gt=[])).push(gs)}return gt}function gi(gs,gu){var gt=bP(gs,gu),gv=gf(gt);if(gt==gv){return gu}return cZ(gv)}function gh(gs,gu){if(gu>gs.lastLine()){return gu}var gt=bP(gs,gu),gv;if(!cV(gs,gt)){return gu}while(gv=ac(gt)){gt=gv.find(1,true).line}return cZ(gt)+1}function cV(gs,gu){var gw=e5&&gu.markedSpans;if(gw){for(var gv,gt=0;gt<gw.length;++gt){gv=gw[gt];if(!gv.marker.collapsed){continue}if(gv.from==null){return true}if(gv.marker.widgetNode){continue}if(gv.from==0&&gv.marker.inclusiveLeft&&cW(gs,gu,gv)){return true}}}}function cW(gs,gv,gx){if(gx.to==null){var gt=gx.marker.find(1,true);return cW(gs,gt.line,bT(gt.line.markedSpans,gx.marker))}if(gx.marker.inclusiveRight&&gx.to==gv.text.length){return true}for(var gw,gu=0;gu<gv.markedSpans.length;++gu){gw=gv.markedSpans[gu];if(gw.marker.collapsed&&!gw.marker.widgetNode&&gw.from==gx.to&&(gw.to==null||gw.to!=gx.from)&&(gw.marker.inclusiveLeft||gx.marker.inclusiveRight)&&cW(gs,gv,gw)){return true}}}var c5=ab.LineWidget=function(gs,gt,gv){if(gv){for(var gu in gv){if(gv.hasOwnProperty(gu)){this[gu]=gv[gu]}}}this.doc=gs;this.node=gt};bm(c5);function i(gs,gu,gt){if(b9(gu)<((gs.curOp&&gs.curOp.scrollTop)||gs.doc.scrollTop)){g(gs,null,gt)}}c5.prototype.clear=function(){var gs=this.doc.cm,gx=this.line.widgets,gv=this.line,gw=cZ(gv);if(gw==null||!gx){return}for(var gu=0;gu<gx.length;++gu){if(gx[gu]==this){gx.splice(gu--,1)}}if(!gx.length){gv.widgets=null}var gt=gn(this);f5(gv,Math.max(0,gv.height-gt));if(gs){e2(gs,function(){i(gs,gv,-gt);eP(gs,gw,"widget")})}};c5.prototype.changed=function(){var gv=this.height,gs=this.doc.cm,gu=this.line;this.height=null;var gt=gn(this)-gv;if(!gt){return}f5(gu,gu.height+gt);if(gs){e2(gs,function(){gs.curOp.forceUpdate=true;i(gs,gu,gt)})}};function gn(gu){if(gu.height!=null){return gu.height}var gs=gu.doc.cm;if(!gs){return 0}if(!am(document.body,gu.node)){var gt="position: relative;";if(gu.coverGutter){gt+="margin-left: -"+gs.display.gutters.offsetWidth+"px;"}if(gu.noHScroll){gt+="width: "+gs.display.wrapper.clientWidth+"px;"}eR(gs.display.measure,a5("div",[gu.node],null,gt))}return gu.height=gu.node.parentNode.offsetHeight}function d(gt,gu,gv,gw){var gx=new c5(gt,gv,gw);var gs=gt.cm;if(gs&&gx.noHScroll){gs.display.alignWidgets=true}I(gt,gu,"widget",function(gz){var gA=gz.widgets||(gz.widgets=[]);if(gx.insertAt==null){gA.push(gx)}else{gA.splice(Math.min(gA.length-1,Math.max(0,gx.insertAt)),0,gx)}gx.line=gz;if(gs&&!cV(gt,gz)){var gy=b9(gz)<gt.scrollTop;f5(gz,gz.height+gn(gx));if(gy){g(gs,null,gx.height)}gs.curOp.forceUpdate=true}return true});return gx}var cS=ab.Line=function(gu,gt,gs){this.text=gu;o(this,gt);this.height=gs?gs(this):1};bm(cS);cS.prototype.lineNo=function(){return cZ(this)};function f0(gu,gw,gv,gt){gu.text=gw;if(gu.stateAfter){gu.stateAfter=null}if(gu.styles){gu.styles=null}if(gu.order!=null){gu.order=null}aH(gu);o(gu,gv);var gs=gt?gt(gu):1;if(gs!=gu.height){f5(gu,gs)}}function O(gs){gs.parent=null;aH(gs)}function br(gv,gt){if(gv){for(;;){var gs=gv.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!gs){break}gv=gv.slice(0,gs.index)+gv.slice(gs.index+gs[0].length);var gu=gs[1]?"bgClass":"textClass";if(gt[gu]==null){gt[gu]=gs[2]}else{if(!(new RegExp("(?:^|s)"+gs[2]+"(?:$|s)")).test(gt[gu])){gt[gu]+=" "+gs[2]}}}}return gv}function F(gt,gu){if(gt.blankLine){return gt.blankLine(gu)}if(!gt.innerMode){return}var gs=ab.innerMode(gt,gu);if(gs.mode.blankLine){return gs.mode.blankLine(gs.state)}}function eH(gu,gw,gv,gt){for(var gs=0;gs<10;gs++){if(gt){gt[0]=ab.innerMode(gu,gv).mode}var gx=gu.token(gw,gv);if(gw.pos>gw.start){return gx}}throw new Error("Mode "+gu.name+" failed to advance stream.")}function fN(gt,gy,gz,gs){function gv(gE){return{start:gB.start,end:gB.pos,string:gB.current(),type:gC||null,state:gE?ax(gu.mode,gA):gA}}var gu=gt.doc,gx=gu.mode,gC;gy=X(gu,gy);var gw=bP(gu,gy.line),gA=bW(gt,gy.line,gz);var gB=new fK(gw.text,gt.options.tabSize),gD;if(gs){gD=[]}while((gs||gB.pos<gy.ch)&&!gB.eol()){gB.start=gB.pos;gC=eH(gx,gB,gA);if(gs){gD.push(gv(true))}}return gs?gD:gv()}function e3(gs,gG,gB,gD,gv,gz,gx){var gw=gB.flattenSpans;if(gw==null){gw=gs.options.flattenSpans}var gt=0,gu=null;var gE=new fK(gG,gs.options.tabSize),gF;var gy=gs.options.addModeClass&&[null];if(gG==""){br(F(gB,gD),gz)}while(!gE.eol()){if(gE.pos>gs.options.maxHighlightLength){gw=false;if(gx){eB(gs,gG,gD,gE.pos)}gE.pos=gG.length;gF=null}else{gF=br(eH(gB,gE,gD,gy),gz)}if(gy){var gA=gy[0].name;if(gA){gF="m-"+(gF?gA+" "+gF:gA)}}if(!gw||gu!=gF){while(gt<gE.start){gt=Math.min(gE.start,gt+50000);gv(gt,gu)}gu=gF}gE.start=gE.pos}while(gt<gE.pos){var gC=Math.min(gE.pos,gt+50000);gv(gC,gu);gt=gC}}function cc(gt,gw,gB,gu){var gA=[gt.state.modeGen],gx={};e3(gt,gw.text,gt.doc.mode,gB,function(gC,gD){gA.push(gC,gD)},gx,gu);for(var gy=0;gy<gt.state.overlays.length;++gy){var gz=gt.state.overlays[gy],gv=1,gs=0;e3(gt,gw.text,gz.mode,true,function(gD,gG){var gF=gv;while(gs<gD){var gE=gA[gv];if(gE>gD){gA.splice(gv,1,gD,gA[gv+1],gE)}gv+=2;gs=Math.min(gD,gE)}if(!gG){return}if(gz.opaque){gA.splice(gF,gv-gF,gD,"cm-overlay "+gG);gv=gF+2}else{for(;gF<gv;gF+=2){var gC=gA[gF+1];gA[gF+1]=(gC?gC+" ":"")+"cm-overlay "+gG}}},gx)}return{styles:gA,classes:gx.bgClass||gx.textClass?gx:null}}function bS(gs,gt,gw){if(!gt.styles||gt.styles[0]!=gs.state.modeGen){var gv=bW(gs,cZ(gt));var gu=cc(gs,gt,gt.text.length>gs.options.maxHighlightLength?ax(gs.doc.mode,gv):gv);gt.stateAfter=gv;gt.styles=gu.styles;if(gu.classes){gt.styleClasses=gu.classes}else{if(gt.styleClasses){gt.styleClasses=null}}if(gw===gs.doc.frontier){gs.doc.frontier++}}return gt.styles}function eB(gs,gx,gv,gu){var gt=gs.doc.mode;var gw=new fK(gx,gs.options.tabSize);gw.start=gw.pos=gu||0;if(gx==""){F(gt,gv)}while(!gw.eol()){eH(gt,gw,gv);gw.start=gw.pos}}var fL={},fM={};function ct(gu,gt){if(!gu||/^\s*$/.test(gu)){return null}var gs=gt.addModeClass?fM:fL;return gs[gu]||(gs[gu]=gu.replace(/\S+/g,"cm-$&"))}function z(gu,gz){var gv=a5("span",null,null,gj?"padding-right: .1px":null);var gt={pre:a5("pre",[gv],"CodeMirror-line"),content:gv,col:0,pos:0,cm:gu,trailingSpace:false,splitSpaces:(cg||gj)&&gu.getOption("lineWrapping")};gz.measure={};for(var gw=0;gw<=(gz.rest?gz.rest.length:0);gw++){var gy=gw?gz.rest[gw-1]:gz.line,gA;gt.pos=0;gt.addToken=B;if(b4(gu.display.measure)&&(gA=bV(gy))){gt.addToken=C(gt.addToken,gA)}gt.map=[];var gs=gz!=gu.display.externalMeasured&&cZ(gy);cp(gy,gt,bS(gu,gy,gs));if(gy.styleClasses){if(gy.styleClasses.bgClass){gt.bgClass=cE(gy.styleClasses.bgClass,gt.bgClass||"")}if(gy.styleClasses.textClass){gt.textClass=cE(gy.styleClasses.textClass,gt.textClass||"")}}if(gt.map.length==0){gt.map.push(0,0,gt.content.appendChild(gq(gu.display.measure)))}if(gw==0){gz.measure.map=gt.map;gz.measure.cache={}}else{(gz.measure.maps||(gz.measure.maps=[])).push(gt.map);(gz.measure.caches||(gz.measure.caches=[])).push({})}}if(gj){var gx=gt.content.lastChild;if(/\bcm-tab\b/.test(gx.className)||(gx.querySelector&&gx.querySelector(".cm-tab"))){gt.content.className="cm-tab-wrap-hack"}}ft(gu,"renderLine",gu,gz.line,gt.pre);if(gt.pre.className){gt.textClass=cE(gt.pre.className,gt.textClass||"")}return gt}function aD(gs){var gt=a5("span","\u2022","cm-invalidchar");gt.title="\\u"+gs.charCodeAt(0).toString(16);gt.setAttribute("aria-label",gt.title);return gt}function B(gs,gH,gE,gD,gw,gI,gu){if(!gH){return}var gv=gs.splitSpaces?fE(gH,gs.trailingSpace):gH;var gC=gs.cm.state.specialChars,gz=false;if(!gC.test(gH)){gs.col+=gH.length;var gt=document.createTextNode(gv);gs.map.push(gs.pos,gs.pos+gH.length,gt);if(cg&&cj<9){gz=true}gs.pos+=gH.length}else{var gt=document.createDocumentFragment(),gA=0;while(true){gC.lastIndex=gA;var gy=gC.exec(gH);var gB=gy?gy.index-gA:gH.length-gA;if(gB){var gK=document.createTextNode(gv.slice(gA,gA+gB));if(cg&&cj<9){gt.appendChild(a5("span",[gK]))}else{gt.appendChild(gK)}gs.map.push(gs.pos,gs.pos+gB,gK);gs.col+=gB;gs.pos+=gB}if(!gy){break}gA+=gB+1;if(gy[0]=="\t"){var gF=gs.cm.options.tabSize,gG=gF-gs.col%gF;var gK=gt.appendChild(a5("span",fB(gG),"cm-tab"));gK.setAttribute("role","presentation");gK.setAttribute("cm-text","\t");gs.col+=gG}else{if(gy[0]=="\r"||gy[0]=="\n"){var gK=gt.appendChild(a5("span",gy[0]=="\r"?"\u240d":"\u2424","cm-invalidchar"));gK.setAttribute("cm-text",gy[0]);gs.col+=1}else{var gK=gs.cm.options.specialCharPlaceholder(gy[0]);gK.setAttribute("cm-text",gy[0]);if(cg&&cj<9){gt.appendChild(a5("span",[gK]))}else{gt.appendChild(gK)}gs.col+=1}}gs.map.push(gs.pos,gs.pos+1,gK);gs.pos++}}gs.trailingSpace=gv.charCodeAt(gH.length-1)==32;if(gE||gD||gw||gz||gu){var gx=gE||"";if(gD){gx+=gD}if(gw){gx+=gw}var gJ=a5("span",[gt],gx,gu);if(gI){gJ.title=gI}return gs.content.appendChild(gJ)}gs.content.appendChild(gt)}function fE(gw,gx){if(gw.length>1&&!/  /.test(gw)){return gw}var gv=gx,gu="";for(var gt=0;gt<gw.length;gt++){var gs=gw.charAt(gt);if(gs==" "&&gv&&(gt==gw.length-1||gw.charCodeAt(gt+1)==32)){gs="\u00a0"}gu+=gs;gv=gs==" "}return gu}function C(gs,gt){return function(gu,gD,gC,gB,gx,gE,gv){gC=gC?gC+" cm-force-border":"cm-force-border";var gA=gu.pos,gw=gA+gD.length;for(;;){for(var gy=0;gy<gt.length;gy++){var gz=gt[gy];if(gz.to>gA&&gz.from<=gA){break}}if(gz.to>=gw){return gs(gu,gD,gC,gB,gx,gE,gv)}gs(gu,gD.slice(0,gz.to-gA),gC,gB,null,gE,gv);gB=null;gD=gD.slice(gz.to-gA);gA=gz.to}}}function y(gs,gv,gu,gt){var gw=!gt&&gu.widgetNode;if(gw){gs.map.push(gs.pos,gs.pos+gv,gw)}if(!gt&&gs.cm.display.input.needsContentAttribute){if(!gw){gw=gs.content.appendChild(document.createElement("span"))}gw.setAttribute("cm-marker",gu.id)}if(gw){gs.cm.display.input.setUneditable(gw);gs.content.appendChild(gw)}gs.pos+=gv;gs.trailingSpace=false}function cp(gD,gu,gN){var gJ=gD.markedSpans,gs=gD.text,gt=0;if(!gJ){for(var gA=1;gA<gN.length;gA+=2){gu.addToken(gu,gs.slice(gt,gt=gN[gA]),ct(gN[gA+1],gu.cm.options))}return}var gC=gs.length,gG=0,gA=1,gO="",gM,gw;var gF=0,gL,gI,gK,gP,gv;for(;;){if(gF==gG){gL=gI=gK=gP=gw="";gv=null;gF=Infinity;var gz=[],gy;for(var gB=0;gB<gJ.length;++gB){var gH=gJ[gB],gE=gH.marker;if(gE.type=="bookmark"&&gH.from==gG&&gE.widgetNode){gz.push(gE)}else{if(gH.from<=gG&&(gH.to==null||gH.to>gG||gE.collapsed&&gH.to==gG&&gH.from==gG)){if(gH.to!=null&&gH.to!=gG&&gF>gH.to){gF=gH.to;gI=""}if(gE.className){gL+=" "+gE.className}if(gE.css){gw=(gw?gw+";":"")+gE.css}if(gE.startStyle&&gH.from==gG){gK+=" "+gE.startStyle}if(gE.endStyle&&gH.to==gF){(gy||(gy=[])).push(gE.endStyle,gH.to)}if(gE.title&&!gP){gP=gE.title}if(gE.collapsed&&(!gv||ah(gv.marker,gE)<0)){gv=gH}}else{if(gH.from>gG&&gF>gH.from){gF=gH.from}}}}if(gy){for(var gB=0;gB<gy.length;gB+=2){if(gy[gB+1]==gF){gI+=" "+gy[gB]}}}if(!gv||gv.from==gG){for(var gB=0;gB<gz.length;++gB){y(gu,0,gz[gB])}}if(gv&&(gv.from||0)==gG){y(gu,(gv.to==null?gC+1:gv.to)-gG,gv.marker,gv.from==null);if(gv.to==null){return}if(gv.to==gG){gv=false}}}if(gG>=gC){break}var gR=Math.min(gC,gF);while(true){if(gO){var gx=gG+gO.length;if(!gv){var gQ=gx>gR?gO.slice(0,gR-gG):gO;gu.addToken(gu,gQ,gM?gM+gL:gL,gK,gG+gQ.length==gF?gI:"",gP,gw)}if(gx>=gR){gO=gO.slice(gR-gG);gG=gR;break}gG=gx;gK=""}gO=gs.slice(gt,gt=gN[gA++]);gM=ct(gN[gA++],gu.cm.options)}}}function cA(gt,gs){return gs.from.ch==0&&gs.to.ch==0&&db(gs.text)==""&&(!gt.cm||gt.cm.options.wholeLineUpdateBefore)}function fV(gu,gt,gC,gv){function gE(gI){return gC?gC[gI]:null}function gH(gI,gK,gJ){f0(gI,gK,gJ,gv);fw(gI,"change",gI,gt)}function gB(gL,gI){for(var gJ=gL,gK=[];gJ<gI;++gJ){gK.push(new cS(gF[gJ],gE(gJ),gv))}return gK}var gx=gt.from,gG=gt.to,gF=gt.text;var gw=bP(gu,gx.line),gy=bP(gu,gG.line);var gA=db(gF),gz=gE(gF.length-1),gD=gG.line-gx.line;if(gt.full){gu.insert(0,gB(0,gF.length));gu.remove(gF.length,gu.size-gF.length)}else{if(cA(gu,gt)){var gs=gB(0,gF.length-1);gH(gy,gy.text,gz);if(gD){gu.remove(gx.line,gD)}if(gs.length){gu.insert(gx.line,gs)}}else{if(gw==gy){if(gF.length==1){gH(gw,gw.text.slice(0,gx.ch)+gA+gw.text.slice(gG.ch),gz)}else{var gs=gB(1,gF.length-1);gs.push(new cS(gA+gw.text.slice(gG.ch),gz,gv));gH(gw,gw.text.slice(0,gx.ch)+gF[0],gE(0));gu.insert(gx.line+1,gs)}}else{if(gF.length==1){gH(gw,gw.text.slice(0,gx.ch)+gF[0]+gy.text.slice(gG.ch),gE(0));gu.remove(gx.line+1,gD)}else{gH(gw,gw.text.slice(0,gx.ch)+gF[0],gE(0));gH(gy,gA+gy.text.slice(gG.ch),gz);var gs=gB(1,gF.length-1);if(gD>1){gu.remove(gx.line+1,gD-1)}gu.insert(gx.line+1,gs)}}}}fw(gu,"change",gu,gt)}function cO(gu){this.lines=gu;this.parent=null;for(var gt=0,gs=0;gt<gu.length;++gt){gu[gt].parent=this;gs+=gu[gt].height}this.height=gs}cO.prototype={chunkSize:function(){return this.lines.length},removeInner:function(gs,gw){for(var gu=gs,gt=gs+gw;gu<gt;++gu){var gv=this.lines[gu];this.height-=gv.height;O(gv);fw(gv,"delete")}this.lines.splice(gs,gw)},collapse:function(gs){gs.push.apply(gs,this.lines)},insertInner:function(gs,gv,gt){this.height+=gt;this.lines=this.lines.slice(0,gs).concat(gv).concat(this.lines.slice(gs));for(var gu=0;gu<gv.length;++gu){gv[gu].parent=this}},iterN:function(gs,gu,gv){for(var gt=gs+gu;gs<gt;++gs){if(gv(this.lines[gs])){return true}}}};function x(gt){this.children=gt;var gw=0,gu=0;for(var gv=0;gv<gt.length;++gv){var gs=gt[gv];gw+=gs.chunkSize();gu+=gs.height;gs.parent=this}this.size=gw;this.height=gu;this.parent=null}x.prototype={chunkSize:function(){return this.size},removeInner:function(gs,gw){this.size-=gw;for(var gu=0;gu<this.children.length;++gu){var gt=this.children[gu],gz=gt.chunkSize();if(gs<gz){var gy=Math.min(gw,gz-gs),gx=gt.height;gt.removeInner(gs,gy);this.height-=gx-gt.height;if(gz==gy){this.children.splice(gu--,1);gt.parent=null}if((gw-=gy)==0){break}gs=0}else{gs-=gz}}if(this.size-gw<25&&(this.children.length>1||!(this.children[0] instanceof cO))){var gv=[];this.collapse(gv);this.children=[new cO(gv)];this.children[0].parent=this}},collapse:function(gt){for(var gs=0;gs<this.children.length;++gs){this.children[gs].collapse(gt)}},insertInner:function(gs,gx,gu){this.size+=gx.length;this.height+=gu;for(var gv=0;gv<this.children.length;++gv){var gt=this.children[gv],gA=gt.chunkSize();if(gs<=gA){gt.insertInner(gs,gx,gu);if(gt.lines&&gt.lines.length>50){var gz=gt.lines.length%25+25;for(var gy=gz;gy<gt.lines.length;){var gw=new cO(gt.lines.slice(gy,gy+=25));gt.height-=gw.height;this.children.splice(++gv,0,gw);gw.parent=this}gt.lines=gt.lines.slice(0,gz);this.maybeSpill()}break}gs-=gA}},maybeSpill:function(){if(this.children.length<=10){return}var gt=this;do{var gw=gt.children.splice(gt.children.length-5,5);var gv=new x(gw);if(!gt.parent){var gs=new x(gt.children);gs.parent=gt;gt.children=[gs,gv];gt=gs}else{gt.size-=gv.size;gt.height-=gv.height;var gu=cl(gt.parent.children,gt);gt.parent.children.splice(gu+1,0,gv)}gv.parent=gt.parent}while(gt.children.length>10);gt.parent.maybeSpill()},iterN:function(gs,gv,gw){for(var gu=0;gu<this.children.length;++gu){var gt=this.children[gu],gx=gt.chunkSize();if(gs<gx){var gy=Math.min(gv,gx-gs);if(gt.iterN(gs,gy,gw)){return true}if((gv-=gy)==0){break}gs=0}else{gs-=gx}}}};var dN=0;var aP=ab.Doc=function(gw,gu,gs,gt){if(!(this instanceof aP)){return new aP(gw,gu,gs,gt)}if(gs==null){gs=0}x.call(this,[new cO([new cS("",null)])]);this.first=gs;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=gs;var gv=er(gs,0);this.sel=fx(gv);this.history=new ce(null);this.id=++dN;this.modeOption=gu;this.lineSep=gt;this.extend=false;if(typeof gw=="string"){gw=this.splitLines(gw)}fV(this,{from:gv,to:gv,text:gw});fl(this,fx(gv),fb)};aP.prototype=aA(x.prototype,{constructor:aP,iter:function(gs,gu,gt){if(gt){this.iterN(gs-this.first,gu-gs,gt)}else{this.iterN(this.first,this.first+this.size,gs)}},insert:function(gs,gv){var gt=0;for(var gu=0;gu<gv.length;++gu){gt+=gv[gu].height}this.insertInner(gs-this.first,gv,gt)},remove:function(gs,gt){this.removeInner(gs-this.first,gt)},getValue:function(gt){var gs=bR(this,this.first,this.first+this.size);if(gt===false){return gs}return gs.join(gt||this.lineSeparator())},setValue:aQ(function(gs){var gu=er(this.first,0),gt=this.first+this.size-1;de(this,{from:gu,to:er(gt,bP(this,gt).text.length),text:this.splitLines(gs),origin:"setValue",full:true},true);fl(this,fx(gu))}),replaceRange:function(gs,gt,gv,gu){gt=X(this,gt);gv=gv?X(this,gv):gt;eW(this,gs,gt,gv,gu)},getRange:function(gs,gv,gu){var gt=bK(this,X(this,gs),X(this,gv));if(gu===false){return gt}return gt.join(gu||this.lineSeparator())},getLine:function(gt){var gs=this.getLineHandle(gt);return gs&&gs.text},getLineHandle:function(gs){if(cy(this,gs)){return bP(this,gs)}},getLineNumber:function(gs){return cZ(gs)},getLineHandleVisualStart:function(gs){if(typeof gs=="number"){gs=bP(this,gs)}return gf(gs)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(gs){return X(this,gs)},getCursor:function(gu){var gt=this.sel.primary(),gs;if(gu==null||gu=="head"){gs=gt.head}else{if(gu=="anchor"){gs=gt.anchor}else{if(gu=="end"||gu=="to"||gu===false){gs=gt.to()}else{gs=gt.from()}}}return gs},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:aQ(function(gt,gs,gu){fp(this,X(this,typeof gt=="number"?er(gt,gs||0):gt),null,gu)}),setSelection:aQ(function(gs,gt,gu){fp(this,X(this,gs),X(this,gt||gs),gu)}),extendSelection:aQ(function(gs,gu,gt){bp(this,X(this,gs),gu&&X(this,gu),gt)}),extendSelections:aQ(function(gs,gt){bq(this,Y(this,gs),gt)}),extendSelectionsBy:aQ(function(gs,gu){var gt=dj(this.sel.ranges,gs);bq(this,Y(this,gt),gu)}),setSelections:aQ(function(gw,gv,gt){if(!gw.length){return}for(var gs=0,gu=[];gs<gw.length;gs++){gu[gs]=new eG(X(this,gw[gs].anchor),X(this,gw[gs].head))}if(gv==null){gv=Math.min(gw.length-1,this.sel.primIndex)}fl(this,dU(gu,gv),gt)}),addSelection:aQ(function(gs,gt,gu){var gv=this.sel.ranges.slice(0);gv.push(new eG(X(this,gs),X(this,gt||gs)));fl(this,dU(gv,gv.length-1),gu)}),getSelection:function(gu){var gv=this.sel.ranges,gt;for(var gs=0;gs<gv.length;gs++){var gw=bK(this,gv[gs].from(),gv[gs].to());gt=gt?gt.concat(gw):gw}if(gu===false){return gt}else{return gt.join(gu||this.lineSeparator())}},getSelections:function(gt){var gu=[],gv=this.sel.ranges;for(var gs=0;gs<gv.length;gs++){var gw=bK(this,gv[gs].from(),gv[gs].to());if(gt!==false){gw=gw.join(gt||this.lineSeparator())}gu[gs]=gw}return gu},replaceSelection:function(gs,gt,gw){var gu=[];for(var gv=0;gv<this.sel.ranges.length;gv++){gu[gv]=gs}this.replaceSelections(gu,gt,gw||"+input")},replaceSelections:aQ(function(gt,gu,gx){var gs=[],gz=this.sel;for(var gv=0;gv<gz.ranges.length;gv++){var gy=gz.ranges[gv];gs[gv]={from:gy.from(),to:gy.to(),text:this.splitLines(gt[gv]),origin:gx}}var gw=gu&&gu!="end"&&aj(this,gs,gu);for(var gv=gs.length-1;gv>=0;gv--){de(this,gs[gv])}if(gw){fo(this,gw)}else{if(this.cm){bd(this.cm)}}}),undo:aQ(function(){df(this,"undo")}),redo:aQ(function(){df(this,"redo")}),undoSelection:aQ(function(){df(this,"undo",true)}),redoSelection:aQ(function(){df(this,"redo",true)}),setExtending:function(gs){this.extend=gs},getExtending:function(){return this.extend},historySize:function(){var gt=this.history,gs=0,gv=0;for(var gu=0;gu<gt.done.length;gu++){if(!gt.done[gu].ranges){++gs}}for(var gu=0;gu<gt.undone.length;gu++){if(!gt.undone[gu].ranges){++gv}}return{undo:gs,redo:gv}},clearHistory:function(){this.history=new ce(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(gs){if(gs){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(gs){return this.history.generation==(gs||this.cleanGeneration)},getHistory:function(){return{done:at(this.history.done),undone:at(this.history.undone)}},setHistory:function(gt){var gs=this.history=new ce(this.history.maxGeneration);gs.done=at(gt.done.slice(0),null,true);gs.undone=at(gt.undone.slice(0),null,true)},addLineClass:aQ(function(gt,gu,gs){return I(this,gt,gu=="gutter"?"gutter":"class",function(gv){var gw=gu=="text"?"textClass":gu=="background"?"bgClass":gu=="gutter"?"gutterClass":"wrapClass";if(!gv[gw]){gv[gw]=gs}else{if(N(gs).test(gv[gw])){return false}else{gv[gw]+=" "+gs}}return true})}),removeLineClass:aQ(function(gt,gu,gs){return I(this,gt,gu=="gutter"?"gutter":"class",function(gy){var gz=gu=="text"?"textClass":gu=="background"?"bgClass":gu=="gutter"?"gutterClass":"wrapClass";var gv=gy[gz];if(!gv){return false}else{if(gs==null){gy[gz]=null}else{var gx=gv.match(N(gs));if(!gx){return false}var gw=gx.index+gx[0].length;gy[gz]=gv.slice(0,gx.index)+(!gx.index||gw==gv.length?"":" ")+gv.slice(gw)||null}}return true})}),addLineWidget:aQ(function(gs,gt,gu){return d(this,gs,gt,gu)}),removeLineWidget:function(gs){gs.clear()},markText:function(gs,gu,gt){return dp(this,X(this,gs),X(this,gu),gt,gt&&gt.type||"range")},setBookmark:function(gt,gs){var gu={replacedWith:gs&&(gs.nodeType==null?gs.widget:gs),insertLeft:gs&&gs.insertLeft,clearWhenEmpty:false,shared:gs&&gs.shared,handleMouseEvents:gs&&gs.handleMouseEvents};gt=X(this,gt);return dp(this,gt,gt,gu,"bookmark")},findMarksAt:function(gu){gu=X(this,gu);var gt=[],gw=bP(this,gu.line).markedSpans;if(gw){for(var gs=0;gs<gw.length;++gs){var gv=gw[gs];if((gv.from==null||gv.from<=gu.ch)&&(gv.to==null||gv.to>=gu.ch)){gt.push(gv.marker.parent||gv.marker)}}}return gt},findMarks:function(gu,gw,gs){gu=X(this,gu);gw=X(this,gw);var gt=[],gv=gu.line;this.iter(gu.line,gw.line+1,function(gy){var gA=gy.markedSpans;if(gA){for(var gx=0;gx<gA.length;gx++){var gz=gA[gx];if(!(gz.to!=null&&gv==gu.line&&gu.ch>=gz.to||gz.from==null&&gv!=gu.line||gz.from!=null&&gv==gw.line&&gz.from>=gw.ch)&&(!gs||gs(gz.marker))){gt.push(gz.marker.parent||gz.marker)}}}++gv});return gt},getAllMarks:function(){var gs=[];this.iter(function(gu){var gv=gu.markedSpans;if(gv){for(var gt=0;gt<gv.length;++gt){if(gv[gt].from!=null){gs.push(gv[gt].marker)}}}});return gs},posFromIndex:function(gu){var gs,gt=this.first,gv=this.lineSeparator().length;this.iter(function(gw){var gx=gw.text.length+gv;if(gx>gu){gs=gu;return true}gu-=gx;++gt});return X(this,er(gt,gs))},indexFromPos:function(gs){gs=X(this,gs);var gt=gs.ch;if(gs.line<this.first||gs.ch<0){return 0}var gu=this.lineSeparator().length;this.iter(this.first,gs.line,function(gv){gt+=gv.text.length+gu});return gt},copy:function(gs){var gt=new aP(bR(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);gt.scrollTop=this.scrollTop;gt.scrollLeft=this.scrollLeft;gt.sel=this.sel;gt.extend=false;if(gs){gt.history.undoDepth=this.history.undoDepth;gt.setHistory(this.getHistory())}return gt},linkedDoc:function(gu){if(!gu){gu={}}var gt=this.first,gv=this.first+this.size;if(gu.from!=null&&gu.from>gt){gt=gu.from}if(gu.to!=null&&gu.to<gv){gv=gu.to}var gs=new aP(bR(this,gt,gv),gu.mode||this.modeOption,gt,this.lineSep);if(gu.sharedHist){gs.history=this.history}(this.linked||(this.linked=[])).push({doc:gs,sharedHist:gu.sharedHist});gs.linked=[{doc:this,isParent:true,sharedHist:gu.sharedHist}];aw(gs,bA(this));return gs},unlinkDoc:function(gu){if(gu instanceof ab){gu=gu.doc}if(this.linked){for(var gs=0;gs<this.linked.length;++gs){var gt=this.linked[gs];if(gt.doc!=gu){continue}this.linked.splice(gs,1);gu.unlinkDoc(this);aI(bA(this));break}}if(gu.history==this.history){var gv=[gu.id];c6(gu,function(gw){gv.push(gw.id)},true);gu.history=new ce(null);gu.history.done=at(this.history.done,gv);gu.history.undone=at(this.history.undone,gv)}},iterLinkedDocs:function(gs){c6(this,gs)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(gs){if(this.lineSep){return gs.split(this.lineSep)}return fD(gs)},lineSeparator:function(){return this.lineSep||"\n"}});aP.prototype.eachLine=aP.prototype.iter;var aU="iter insert remove copy getEditor constructor".split(" ");for(var eC in aP.prototype){if(aP.prototype.hasOwnProperty(eC)&&cl(aU,eC)<0){ab.prototype[eC]=(function(gs){return function(){return gs.apply(this.doc,arguments)}})(aP.prototype[eC])}}bm(aP);function c6(gs,gt,gv){function gu(gw,gB,gA){if(gw.linked){for(var gx=0;gx<gw.linked.length;++gx){var gy=gw.linked[gx];if(gy.doc==gB){continue}var gz=gA&&gy.sharedHist;if(gv&&!gz){continue}gt(gy.doc,gz);gu(gy.doc,gw,gz)}}}gu(gs,null,true)}function m(gs,gt){if(gt.cm){throw new Error("This document is already in use.")}gs.doc=gt;gt.cm=gs;bk(gs);c7(gs);if(!gs.options.lineWrapping){bx(gs)}gs.options.mode=gt.modeOption;eM(gs)}function bP(gu,gw){gw-=gu.first;if(gw<0||gw>=gu.size){throw new Error("There is no line "+(gw+gu.first)+" in the document.")}for(var gt=gu;!gt.lines;){for(var gv=0;;++gv){var gs=gt.children[gv],gx=gs.chunkSize();if(gw<gx){gt=gs;break}gw-=gx}}return gt.lines[gw]}function bK(gs,gw,gt){var gv=[],gu=gw.line;gs.iter(gw.line,gt.line+1,function(gx){var gy=gx.text;if(gu==gt.line){gy=gy.slice(0,gt.ch)}if(gu==gw.line){gy=gy.slice(gw.ch)}gv.push(gy);++gu});return gv}function bR(gs,gt,gv){var gu=[];gs.iter(gt,gv,function(gw){gu.push(gw.text)});return gu}function f5(gu,gt){var gs=gt-gu.height;if(gs){for(var gv=gu;gv;gv=gv.parent){gv.height+=gs}}}function cZ(gv){if(gv.parent==null){return null}var gt=gv.parent,gw=cl(gt.lines,gv);for(var gs=gt.parent;gs;gt=gs,gs=gs.parent){for(var gu=0;;++gu){if(gs.children[gu]==gt){break}gw+=gs.children[gu].chunkSize()}}return gw+gt.first}function cT(gu,gv){var gz=gu.first;outer:do{for(var gw=0;gw<gu.children.length;++gw){var gt=gu.children[gw],gs=gt.height;if(gv<gs){gu=gt;continue outer}gv-=gs;gz+=gt.chunkSize()}return gz}while(!gu.lines);for(var gw=0;gw<gu.lines.length;++gw){var gy=gu.lines[gw],gx=gy.height;if(gv<gx){break}gv-=gx}return gz+gw}function b9(gx){gx=gf(gx);var gu=0,gs=gx.parent;for(var gv=0;gv<gs.lines.length;++gv){var gw=gs.lines[gv];if(gw==gx){break}else{gu+=gw.height}}for(var gy=gs.parent;gy;gs=gy,gy=gs.parent){for(var gv=0;gv<gy.children.length;++gv){var gt=gy.children[gv];if(gt==gs){break}else{gu+=gt.height}}}return gu}function bV(gs){var gt=gs.order;if(gt==null){gt=gs.order=t(gs.text)}return gt}function ce(gs){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=gs||1}function cf(gt,gs){var gu={from:av(gs.from),to:H(gs),text:bK(gt,gs.from,gs.to)};n(gt,gu,gs.from.line,gs.to.line+1);c6(gt,function(gv){n(gv,gu,gs.from.line,gs.to.line+1)},true);return gu}function U(gs){while(gs.length){var gt=db(gs);if(gt.ranges){gs.pop()}else{break}}}function cI(gt,gs){if(gs){U(gt.done);return db(gt.done)}else{if(gt.done.length&&!db(gt.done).ranges){return db(gt.done)}else{if(gt.done.length>1&&!gt.done[gt.done.length-2].ranges){gt.done.pop();return db(gt.done)}}}}function b(gv,gt,gz,gy){var gw=gv.history;gw.undone.length=0;var gA=+new Date,gu;if((gw.lastOp==gy||gw.lastOrigin==gt.origin&&gt.origin&&((gt.origin.charAt(0)=="+"&&gv.cm&&gw.lastModTime>gA-gv.cm.options.historyEventDelay)||gt.origin.charAt(0)=="*"))&&(gu=cI(gw,gw.lastOp==gy))){var gx=db(gu.changes);if(aa(gt.from,gt.to)==0&&aa(gt.from,gx.to)==0){gx.to=H(gt)}else{gu.changes.push(cf(gv,gt))}}else{var gs=db(gw.done);if(!gs||!gs.ranges){eD(gv.sel,gw.done)}gu={changes:[cf(gv,gt)],generation:gw.generation};gw.done.push(gu);while(gw.done.length>gw.undoDepth){gw.done.shift();if(!gw.done[0].ranges){gw.done.shift()}}}gw.done.push(gz);gw.generation=++gw.maxGeneration;gw.lastModTime=gw.lastSelTime=gA;gw.lastOp=gw.lastSelOp=gy;gw.lastOrigin=gw.lastSelOrigin=gt.origin;if(!gx){ft(gv,"historyAdded")}}function fg(gt,gu,gv,gw){var gs=gu.charAt(0);return gs=="*"||gs=="+"&&gv.ranges.length==gw.ranges.length&&gv.somethingSelected()==gw.somethingSelected()&&new Date-gt.history.lastSelTime<=(gt.cm?gt.cm.options.historyEventDelay:500)}function f(gs,gx,gu,gv){var gt=gs.history,gw=gv&&gv.origin;if(gu==gt.lastSelOp||(gw&&gt.lastSelOrigin==gw&&(gt.lastModTime==gt.lastSelTime&&gt.lastOrigin==gw||fg(gs,gw,db(gt.done),gx)))){gt.done[gt.done.length-1]=gx}else{eD(gx,gt.done)}gt.lastSelTime=+new Date;gt.lastSelOrigin=gw;gt.lastSelOp=gu;if(gv&&gv.clearRedo!==false){U(gt.undone)}}function eD(gt,gs){var gu=db(gs);if(!(gu&&gu.ranges&&gu.equals(gt))){gs.push(gt)}}function n(gt,gs,gv,gx){var gu=gs["spans_"+gt.id],gw=0;gt.iter(Math.max(gt.first,gv),Math.min(gt.first+gt.size,gx),function(gy){if(gy.markedSpans){(gu||(gu=gs["spans_"+gt.id]={}))[gw]=gy.markedSpans}++gw})}function eS(gu){if(!gu){return null}for(var gs=0,gt;gs<gu.length;++gs){if(gu[gs].marker.explicitlyCleared){if(!gt){gt=gu.slice(0,gs)}}else{if(gt){gt.push(gu[gs])}}}return !gt?gu:gt.length?gt:null}function bU(gt,gs){var gu=gs["spans_"+gt.id];if(!gu){return null}for(var gv=0,gw=[];gv<gs.text.length;++gv){gw.push(eS(gu[gv]))}return gw}function at(gw,gC,gy){for(var gx=0,gu=[];gx<gw.length;++gx){var gv=gw[gx];if(gv.ranges){gu.push(gy?ff.prototype.deepCopy.call(gv):gv);continue}var gt=gv.changes,gB=[];gu.push({changes:gB});for(var gz=0;gz<gt.length;++gz){var gs=gt[gz],gA;gB.push({from:gs.from,to:gs.to,text:gs.text});if(gC){for(var gD in gs){if(gA=gD.match(/^spans_(\d+)$/)){if(cl(gC,Number(gA[1]))>-1){db(gB)[gD]=gs[gD];delete gs[gD]}}}}}}return gu}function eK(gu,gt,gv,gs){if(gv<gu.line){gu.line+=gs}else{if(gt<gu.line){gu.line=gt;gu.ch=0}}}function eJ(gs,gv,gA,gu){for(var gw=0;gw<gs.length;++gw){var gz=gs[gw],gy=true;if(gz.ranges){if(!gz.copied){gz=gs[gw]=gz.deepCopy();gz.copied=true}for(var gx=0;gx<gz.ranges.length;gx++){eK(gz.ranges[gx].anchor,gv,gA,gu);eK(gz.ranges[gx].head,gv,gA,gu)}continue}for(var gx=0;gx<gz.changes.length;++gx){var gt=gz.changes[gx];if(gA<gt.from.line){gt.from=er(gt.from.line+gu,gt.from.ch);gt.to=er(gt.to.line+gu,gt.to.ch)}else{if(gv<=gt.to.line){gy=false;break}}}if(!gy){gs.splice(0,gw+1);gw=0}}}function eI(gv,gs){var gu=gs.from.line,gw=gs.to.line,gt=gs.text.length-(gw-gu)-1;eJ(gv.done,gu,gw,gt);eJ(gv.undone,gu,gw,gt)}var a1=ab.e_preventDefault=function(gs){if(gs.preventDefault){gs.preventDefault()}else{gs.returnValue=false}};var a3=ab.e_stopPropagation=function(gs){if(gs.stopPropagation){gs.stopPropagation()}else{gs.cancelBubble=true}};function a0(gs){return gs.defaultPrevented!=null?gs.defaultPrevented:gs.returnValue==false}var a2=ab.e_stop=function(gs){a1(gs);a3(gs)};function a4(gs){return gs.target||gs.srcElement}function aZ(gt){var gs=gt.which;if(gs==null){if(gt.button&1){gs=1}else{if(gt.button&2){gs=3}else{if(gt.button&4){gs=2}}}}if(dc&&gt.ctrlKey&&gs==1){gs=3}return gs}var d0=ab.on=function(gt,gw,gu){if(gt.addEventListener){gt.addEventListener(gw,gu,false)}else{if(gt.attachEvent){gt.attachEvent("on"+gw,gu)}else{var gv=gt._handlers||(gt._handlers={});var gs=gv[gw]||(gv[gw]=[]);gs.push(gu)}}};var dR=[];function bN(gu,gv,gt){var gs=gu._handlers&&gu._handlers[gv];if(gt){return gs&&gs.length>0?gs.slice():dR}else{return gs||dR}}var dY=ab.off=function(gs,gw,gt){if(gs.removeEventListener){gs.removeEventListener(gw,gt,false)}else{if(gs.detachEvent){gs.detachEvent("on"+gw,gt)}else{var gu=bN(gs,gw,false);for(var gv=0;gv<gu.length;++gv){if(gu[gv]==gt){gu.splice(gv,1);break}}}}};var ft=ab.signal=function(gt,gw){var gu=bN(gt,gw,true);if(!gu.length){return}var gs=Array.prototype.slice.call(arguments,2);for(var gv=0;gv<gu.length;++gv){gu[gv].apply(null,gs)}};var eh=null;function fw(gv,gy){var gt=bN(gv,gy,false);if(!gt.length){return}var gs=Array.prototype.slice.call(arguments,2),gx;if(ee){gx=ee.delayedCallbacks}else{if(eh){gx=eh}else{gx=eh=[];setTimeout(bF,0)}}function gu(gz){return function(){gz.apply(null,gs)}}for(var gw=0;gw<gt.length;++gw){gx.push(gu(gt[gw]))}}function bF(){var gs=eh;eh=null;for(var gt=0;gt<gs.length;++gt){gs[gt]()}}function fv(gs,gt,gu){if(typeof gt=="string"){gt={type:gt,preventDefault:function(){this.defaultPrevented=true}}}ft(gs,gu||gt.type,gs,gt);return a0(gt)||gt.codemirrorIgnore}function fu(gt){var gs=gt._handlers&&gt._handlers.cursorActivity;if(!gs){return}var gv=gt.curOp.cursorActivityHandlers||(gt.curOp.cursorActivityHandlers=[]);for(var gu=0;gu<gs.length;++gu){if(cl(gv,gs[gu])==-1){gv.push(gs[gu])}}}function b7(gs,gt){return bN(gs,gt).length>0}function bm(gs){gs.prototype.on=function(gu,gt){d0(this,gu,gt)};gs.prototype.off=function(gu,gt){dY(this,gu,gt)}}var e7=30;var en=ab.Pass={toString:function(){return"CodeMirror.Pass"}};var fb={scroll:false},fc={origin:"*mouse"},fd={origin:"+move"};function aF(){this.id=null}aF.prototype.set=function(gt,gs){clearTimeout(this.id);this.id=setTimeout(gs,gt)};var ay=ab.countColumn=function(gy,gs,gz,gw,gx){if(gs==null){gs=gy.search(/[^\s\u00a0]/);if(gs==-1){gs=gy.length}}for(var gt=gw||0,gu=gx||0;;){var gv=gy.indexOf("\t",gt);if(gv<0||gv>=gs){return gu+(gs-gt)}gu+=gv-gt;gu+=gz-(gu%gz);gt=gv+1}};var bw=ab.findColumn=function(gx,gt,gy){for(var gv=0,gs=0;;){var gu=gx.indexOf("\t",gv);if(gu==-1){gu=gx.length}var gw=gu-gv;if(gu==gx.length||gs+gw>=gt){return gv+Math.min(gw,gt-gs)}gs+=gu-gv;gs+=gy-(gs%gy);gv=gu+1;if(gs>=gt){return gv}}};var fC=[""];function fB(gs){while(fC.length<=gs){fC.push(db(fC)+" ")}return fC[gs]}function db(gs){return gs[gs.length-1]}var fe=function(gs){gs.select()};if(cv){fe=function(gs){gs.selectionStart=0;gs.selectionEnd=gs.value.length}}else{if(cg){fe=function(gt){try{gt.select()}catch(gs){}}}}function cl(gs,gt){for(var gu=0;gu<gs.length;++gu){if(gs[gu]==gt){return gu}}return -1}function dj(gs,gt){var gv=[];for(var gu=0;gu<gs.length;gu++){gv[gu]=gt(gs[gu],gu)}return gv}function cs(gs,gw,gv){var gt=0,gu=gv(gw);while(gt<gs.length&&gv(gs[gt])<=gu){gt++}gs.splice(gt,0,gw)}function dV(){}function aA(gs,gu){var gt;if(Object.create){gt=Object.create(gs)}else{dV.prototype=gs;gt=new dV()}if(gu){au(gu,gt)}return gt}function au(gs,gv,gt){if(!gv){gv={}}for(var gu in gs){if(gs.hasOwnProperty(gu)&&(gt!==false||!gv.hasOwnProperty(gu))){gv[gu]=gs[gu]}}return gv}function w(gt){var gs=Array.prototype.slice.call(arguments,1);return function(){return gt.apply(null,gs)}}var dS=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var cC=ab.isWordChar=function(gs){return/\w/.test(gs)||gs>"\x80"&&(gs.toUpperCase()!=gs.toLowerCase()||dS.test(gs))};function cB(gs,gt){if(!gt){return cC(gs)}if(gt.source.indexOf("\\w")>-1&&cC(gs)){return true}return gt.test(gs)}function cw(gt){for(var gs in gt){if(gt.hasOwnProperty(gs)&&gt[gs]){return false}}return true}var bn=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function cx(gs){return gs.charCodeAt(0)>=768&&bn.test(gs)}function a5(gx,gt,gs,gw){var gu=document.createElement(gx);if(gs){gu.className=gs}if(gw){gu.style.cssText=gw}if(typeof gt=="string"){gu.appendChild(document.createTextNode(gt))}else{if(gt){for(var gv=0;gv<gt.length;++gv){gu.appendChild(gt[gv])}}}return gu}var eF;if(document.createRange){eF=function(gu,gw,gs,gt){var gv=document.createRange();gv.setEnd(gt||gu,gs);gv.setStart(gu,gw);return gv}}else{eF=function(gu,gw,gt){var gv=document.body.createTextRange();try{gv.moveToElementText(gu.parentNode)}catch(gs){return gv}gv.collapse(true);gv.moveEnd("character",gt);gv.moveStart("character",gw);return gv}}function eQ(gt){for(var gs=gt.childNodes.length;gs>0;--gs){gt.removeChild(gt.firstChild)}return gt}function eR(gt,gs){return eQ(gt).appendChild(gs)}var am=ab.contains=function(gt,gs){if(gs.nodeType==3){gs=gs.parentNode}if(gt.contains){return gt.contains(gs)}do{if(gs.nodeType==11){gs=gs.host}if(gs==gt){return true}}while(gs=gs.parentNode)};function a(){var gs=document.activeElement;while(gs&&gs.root&&gs.root.activeElement){gs=gs.root.activeElement}return gs}if(cg&&cj<11){a=function(){try{return document.activeElement}catch(gs){return document.body}}}function N(gs){return new RegExp("(^|\\s)"+gs+"(?:$|\\s)\\s*")}var e1=ab.rmClass=function(gw,gt){var gu=gw.className;var gv=N(gt).exec(gu);if(gv){var gs=gu.slice(gv.index+gv[0].length);gw.className=gu.slice(0,gv.index)+(gs?gv[1]+gs:"")}};var c=ab.addClass=function(gu,gs){var gt=gu.className;if(!N(gs).test(gt)){gu.className+=(gt?" ":"")+gs}};function cE(gs,gu){var gt=gs.split(" ");for(var gv=0;gv<gt.length;gv++){if(gt[gv]&&!N(gt[gv]).test(gu)){gu+=" "+gt[gv]}}return gu}function bH(gu){if(!document.body.getElementsByClassName){return}var gs=document.body.getElementsByClassName("CodeMirror");for(var gv=0;gv<gs.length;gv++){var gt=gs[gv].CodeMirror;if(gt){gu(gt)}}}var bY=false;function bf(){if(bY){return}eO();bY=true}function eO(){var gs;d0(window,"resize",function(){if(gs==null){gs=setTimeout(function(){gs=null;bH(eb)},100)}});d0(window,"blur",function(){bH(d1)})}var aV=function(){if(cg&&cj<9){return false}var gs=a5("div");return"draggable" in gs||"dragDrop" in gs}();var gr;function gq(gs){if(gr==null){var gu=a5("span","\u200b");eR(gs,a5("span",[gu,document.createTextNode("x")]));if(gs.firstChild.offsetHeight!=0){gr=gu.offsetWidth<=1&&gu.offsetHeight>2&&!(cg&&cj<8)}}var gt=gr?a5("span","\u200b"):a5("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");gt.setAttribute("cm-text","");return gt}var p;function b4(gs){if(p!=null){return p}var gv=eR(gs,document.createTextNode("A\u062eA"));var gt=eF(gv,0,1).getBoundingClientRect();var gu=eF(gv,1,2).getBoundingClientRect();eQ(gs);if(!gt||gt.left==gt.right){return false}return p=(gu.right-gt.right<3)}var fD=ab.splitLines="\n\nb".split(/\n/).length!=3?function(gy){var gv=0,gw=[],gs=gy.length;while(gv<=gs){var gu=gy.indexOf("\n",gv);if(gu==-1){gu=gy.length}var gt=gy.slice(gv,gy.charAt(gu-1)=="\r"?gu-1:gu);var gx=gt.indexOf("\r");if(gx!=-1){gw.push(gt.slice(0,gx));gv+=gx+1}else{gw.push(gt);gv=gu+1}}return gw}:function(gs){return gs.split(/\r\n?|\n/)};var b8=window.getSelection?function(gt){try{return gt.selectionStart!=gt.selectionEnd}catch(gs){return false}}:function(gu){try{var gt=gu.ownerDocument.selection.createRange()}catch(gs){}if(!gt||gt.parentElement()!=gu){return false}return gt.compareEndPoints("StartToEnd",gt)!=0};var b6=(function(){var gs=a5("div");if("oncopy" in gs){return true}gs.setAttribute("oncopy","return;");return typeof gs.oncopy=="function"})();var r=null;function b5(gt){if(r!=null){return r}var gu=eR(gt,a5("span","x"));var gv=gu.getBoundingClientRect();var gs=eF(gu,0,1).getBoundingClientRect();return r=Math.abs(gv.left-gs.left)>1}var cH=ab.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};(function(){for(var gs=0;gs<10;gs++){cH[gs+48]=cH[gs+96]=String(gs)}for(var gs=65;gs<=90;gs++){cH[gs]=String.fromCharCode(gs)}for(var gs=1;gs<=12;gs++){cH[gs+111]=cH[gs+63235]="F"+gs}})();function cD(gw,gu,gy,gs){if(!gw){return gs(gu,gy,"ltr")}var gt=false;for(var gv=0;gv<gw.length;++gv){var gx=gw[gv];if(gx.from<gy&&gx.to>gu||gu==gy&&gx.to==gu){gs(Math.max(gx.from,gu),Math.min(gx.to,gy),gx.level==1?"rtl":"ltr");gt=true}}if(!gt){gs(gu,gy,"ltr")}}function s(gs){return gs.level%2?gs.to:gs.from}function v(gs){return gs.level%2?gs.from:gs.to}function cX(gs){var gt=bV(gs);return gt?s(gt[0]):0}function c1(gs){var gt=bV(gs);if(!gt){return gs.text.length}return v(db(gt))}function c2(gt,gv){var gu=bP(gt.doc,gv);var gx=gf(gu);if(gx!=gu){gv=cZ(gx)}var gw=bV(gx);var gs=!gw?0:gw[0].level%2?c1(gx):cX(gx);return er(gv,gs)}function cU(gt,gv){var gw,gu=bP(gt.doc,gv);while(gw=ac(gu)){gu=gw.find(1,true).line;gv=null}var gx=bV(gu);var gs=!gx?gu.text.length:gx[0].level%2?cX(gu):c1(gu);return er(gv==null?cZ(gu):gv,gs)}function c3(gs,gx){var gy=c2(gs,gx.line);var gv=bP(gs.doc,gy.line);var gw=bV(gv);if(!gw||gw[0].level==0){var gt=Math.max(0,gv.text.search(/\S/));var gu=gx.line==gy.line&&gx.ch<=gt&&gx.ch;return er(gy.line,gu?0:gt)}return gy}function ag(gv,gs,gt){var gu=gv[0].level;if(gs==gu){return true}if(gt==gu){return false}return gs<gt}var u;function bL(gv,gw){u=null;for(var gu=0,gt;gu<gv.length;++gu){var gs=gv[gu];if(gs.from<gw&&gs.to>gw){return gu}if((gs.from==gw||gs.to==gw)){if(gt==null){gt=gu}else{if(ag(gv,gs.level,gv[gt].level)){if(gs.from!=gs.to){u=gt}return gu}else{if(gs.from!=gs.to){u=gu}return gt}}}}return gt}function dI(gu,gv,gt,gs){if(!gs){return gv+gt}do{gv+=gt}while(gv>0&&cx(gu.text.charAt(gv)));return gv}function dL(gv,gy,gu,gt){var gs=bV(gv);if(!gs){return dJ(gv,gy,gu,gt)}var gx=bL(gs,gy),gw=gs[gx];var gz=dI(gv,gy,gw.level%2?-gu:gu,gt);for(;;){if(gz>gw.from&&gz<gw.to){return gz}if(gz==gw.from||gz==gw.to){if(bL(gs,gz)==gx){return gz}gw=gs[gx+=gu];return(gu>0)==gw.level%2?gw.to:gw.from}else{gw=gs[gx+=gu];if(!gw){return null}if((gu>0)==gw.level%2){gz=dI(gv,gw.to,-1,gt)}else{gz=dI(gv,gw.from,1,gt)}}}}function dJ(gu,gv,gt,gs){var gw=gv+gt;if(gs){while(gw>0&&cx(gu.text.charAt(gw))){gw+=gt}}return gw<0||gw>gu.text.length?null:gw}var t=(function(){var gA="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var gs="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function gv(gC){if(gC<=247){return gA.charAt(gC)}else{if(1424<=gC&&gC<=1524){return"R"}else{if(1536<=gC&&gC<=1773){return gs.charAt(gC-1536)}else{if(1774<=gC&&gC<=2220){return"r"}else{if(8192<=gC&&gC<=8203){return"w"}else{if(gC==8204){return"b"}else{return"L"}}}}}}}var gt=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var gy=/[stwN]/,gz=/[LRr]/,gw=/[Lb1n]/,gx=/[1n]/;var gB="L";function gu(gD,gC,gE){this.level=gD;this.from=gC;this.to=gE}return function(gR){if(!gt.test(gR)){return false}var gJ=gR.length,gT=[];for(var gH=0,gS;gH<gJ;++gH){gT.push(gS=gv(gR.charCodeAt(gH)))}for(var gH=0,gO=gB;gH<gJ;++gH){var gS=gT[gH];if(gS=="m"){gT[gH]=gO}else{gO=gS}}for(var gH=0,gF=gB;gH<gJ;++gH){var gS=gT[gH];if(gS=="1"&&gF=="r"){gT[gH]="n"}else{if(gz.test(gS)){gF=gS;if(gS=="r"){gT[gH]="R"}}}}for(var gH=1,gO=gT[0];gH<gJ-1;++gH){var gS=gT[gH];if(gS=="+"&&gO=="1"&&gT[gH+1]=="1"){gT[gH]="1"}else{if(gS==","&&gO==gT[gH+1]&&(gO=="1"||gO=="n")){gT[gH]=gO}}gO=gS}for(var gH=0;gH<gJ;++gH){var gS=gT[gH];if(gS==","){gT[gH]="N"}else{if(gS=="%"){for(var gG=gH+1;gG<gJ&&gT[gG]=="%";++gG){}var gP=(gH&&gT[gH-1]=="!")||(gG<gJ&&gT[gG]=="1")?"1":"N";for(var gI=gH;gI<gG;++gI){gT[gI]=gP}gH=gG-1}}}for(var gH=0,gF=gB;gH<gJ;++gH){var gS=gT[gH];if(gF=="L"&&gS=="1"){gT[gH]="L"}else{if(gz.test(gS)){gF=gS}}}for(var gH=0;gH<gJ;++gH){if(gy.test(gT[gH])){for(var gG=gH+1;gG<gJ&&gy.test(gT[gG]);++gG){}var gE=(gH?gT[gH-1]:gB)=="L";var gC=(gG<gJ?gT[gG]:gB)=="L";var gP=gE||gC?"L":"R";for(var gI=gH;gI<gG;++gI){gT[gI]=gP}gH=gG-1}}var gM=[],gK;for(var gH=0;gH<gJ;){if(gw.test(gT[gH])){var gQ=gH;for(++gH;gH<gJ&&gw.test(gT[gH]);++gH){}gM.push(new gu(0,gQ,gH))}else{var gN=gH,gD=gM.length;for(++gH;gH<gJ&&gT[gH]!="L";++gH){}for(var gI=gN;gI<gH;){if(gx.test(gT[gI])){if(gN<gI){gM.splice(gD,0,new gu(1,gN,gI))}var gL=gI;for(++gI;gI<gH&&gx.test(gT[gI]);++gI){}gM.splice(gD,0,new gu(2,gL,gI));gN=gI}else{++gI}}if(gN<gH){gM.splice(gD,0,new gu(1,gN,gH))}}}if(gM[0].level==1&&(gK=gR.match(/^\s+/))){gM[0].from=gK[0].length;gM.unshift(new gu(0,0,gK[0].length))}if(db(gM).level==1&&(gK=gR.match(/\s+$/))){db(gM).to-=gK[0].length;gM.push(new gu(0,gJ-gK[0].length,gJ))}if(gM[0].level==2){gM.unshift(new gu(1,gM[0].to,gM[0].to))}if(gM[0].level!=db(gM).level){gM.push(new gu(gM[0].level,gJ,gJ))}return gM}})();ab.version="5.18.2";return ab});