var server;this.onmessage=function(d){var b=d.data;switch(b.type){case"init":return startServer(b.defs,b.plugins,b.scripts);case"add":return server.addFile(b.name,b.text);case"del":return server.delFile(b.name);case"req":return server.request(b.body,function(c,e){postMessage({id:b.id,body:e,err:c&&String(c)})});case"getFile":var a=pending[b.id];delete pending[b.id];return a(b.err,b.text);default:throw new Error("Unknown message type: "+b.type)}};var nextId=0,pending={};function getFile(b,a){postMessage({type:"getFile",name:b,id:++nextId});pending[nextId]=a}function startServer(a,b,c){if(c){importScripts.apply(null,c)}server=new tern.Server({getFile:getFile,async:true,defs:a,plugins:b})}this.console={log:function(a){postMessage({type:"debug",message:a})}};