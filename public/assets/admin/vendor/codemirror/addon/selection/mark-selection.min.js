(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(d){d.defineOption("styleSelectedText",false,function(k,n,l){var m=l&&l!=d.Init;if(n&&!m){k.state.markedSelection=[];k.state.markedSelectionStyle=typeof n=="string"?n:"CodeMirror-selectedtext";i(k);k.on("cursorActivity",g);k.on("change",f)}else{if(!n&&m){k.off("cursorActivity",g);k.off("change",f);b(k);k.state.markedSelection=k.state.markedSelectionStyle=null}}});function g(k){k.operation(function(){j(k)})}function f(k){if(k.state.markedSelection.length){k.operation(function(){b(k)})}}var a=8;var h=d.Pos;var c=d.cmpPos;function e(o,r,v,k){if(c(r,v)==0){return}var l=o.state.markedSelection;var n=o.state.markedSelectionStyle;for(var s=r.line;;){var u=s==r.line?r:h(s,0);var q=s+a,m=q>=v.line;var p=m?v:h(q,0);var t=o.markText(u,p,{className:n});if(k==null){l.push(t)}else{l.splice(k++,0,t)}if(m){break}s=q}}function b(l){var k=l.state.markedSelection;for(var m=0;m<k.length;++m){k[m].clear()}k.length=0}function i(k){b(k);var m=k.listSelections();for(var l=0;l<m.length;l++){e(k,m[l].from(),m[l].to())}}function j(l){if(!l.somethingSelected()){return b(l)}if(l.listSelections().length>1){return i(l)}var o=l.getCursor("start"),p=l.getCursor("end");var k=l.state.markedSelection;if(!k.length){return e(l,o,p)}var n=k[0].find(),m=k[k.length-1].find();if(!n||!m||p.line-o.line<a||c(o,m.to)>=0||c(p,n.from)<=0){return i(l)}while(c(o,n.from)>0){k.shift().clear();n=k[0].find()}if(c(o,n.from)<0){if(n.to.line-o.line<a){k.shift().clear();e(l,o,n.to,0)}else{e(l,o,n.from,0)}}while(c(p,m.to)<0){k.pop().clear();m=k[k.length-1].find()}if(c(p,m.to)>0){if(p.line-m.from.line<a){k.pop().clear();e(l,m.from,p)}else{e(l,m.to,p)}}}});