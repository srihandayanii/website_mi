(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineExtension("addPanel",function(h,i){i=i||{};if(!this.state.panels){b(this)}var g=this.state.panels;var j=g.wrapper;var e=this.getWrapperElement();if(i.after instanceof c&&!i.after.cleared){j.insertBefore(h,i.before.node.nextSibling)}else{if(i.before instanceof c&&!i.before.cleared){j.insertBefore(h,i.before.node)}else{if(i.replace instanceof c&&!i.replace.cleared){j.insertBefore(h,i.replace.node);i.replace.clear()}else{if(i.position=="bottom"){j.appendChild(h)}else{if(i.position=="before-bottom"){j.insertBefore(h,e.nextSibling)}else{if(i.position=="after-top"){j.insertBefore(h,e)}else{j.insertBefore(h,j.firstChild)}}}}}}var f=(i&&i.height)||h.offsetHeight;this._setSize(null,g.heightLeft-=f);g.panels++;return new c(this,h,i,f)});function c(e,g,h,f){this.cm=e;this.node=g;this.options=h;this.height=f;this.cleared=false}c.prototype.clear=function(){if(this.cleared){return}this.cleared=true;var e=this.cm.state.panels;this.cm._setSize(null,e.heightLeft+=this.height);e.wrapper.removeChild(this.node);if(--e.panels==0){d(this.cm)}};c.prototype.changed=function(e){var g=e==null?this.node.offsetHeight:e;var f=this.cm.state.panels;this.cm._setSize(null,f.height+=(g-this.height));this.height=g};function b(e){var j=e.getWrapperElement();var i=window.getComputedStyle?window.getComputedStyle(j):j.currentStyle;var g=parseInt(i.height);var h=e.state.panels={setHeight:j.style.height,heightLeft:g,panels:0,wrapper:document.createElement("div")};j.parentNode.insertBefore(h.wrapper,j);var f=e.hasFocus();h.wrapper.appendChild(j);if(f){e.focus()}e._setSize=e.setSize;if(g!=null){e.setSize=function(m,k){if(k==null){return this._setSize(m,k)}h.setHeight=k;if(typeof k!="number"){var l=/^(\d+\.?\d*)px$/.exec(k);if(l){k=Number(l[1])}else{h.wrapper.style.height=k;k=h.wrapper.offsetHeight;h.wrapper.style.height=""}}e._setSize(m,h.heightLeft+=(k-g));g=k}}}function d(e){var f=e.state.panels;e.state.panels=null;var g=e.getWrapperElement();f.wrapper.parentNode.replaceChild(g,f.wrapper);g.style.height=f.setHeight;e.setSize=e._setSize;e.setSize()}});