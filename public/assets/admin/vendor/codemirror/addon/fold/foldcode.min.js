(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){function c(f,n,m,h){if(m&&m.call){var g=m;m=null}else{var g=d(f,m,"rangeFinder")}if(typeof n=="number"){n=a.Pos(n,0)}var j=d(f,m,"minFoldSize");function i(p){var s=g(f,n);if(!s||s.to.line-s.from.line<j){return null}var r=f.findMarksAt(s.from);for(var q=0;q<r.length;++q){if(r[q].__isFold&&h!=="fold"){if(!p){return null}s.cleared=true;r[q].clear()}}return s}var o=i(true);if(d(f,m,"scanUp")){while(!o&&n.line>f.firstLine()){n=a.Pos(n.line-1,0);o=i(false)}}if(!o||o.cleared||h==="unfold"){return}var l=e(f,m);a.on(l,"mousedown",function(p){k.clear();a.e_preventDefault(p)});var k=f.markText(o.from,o.to,{replacedWith:l,clearOnEnter:d(f,m,"clearOnEnter"),__isFold:true});k.on("clear",function(p,q){a.signal(f,"unfold",f,p,q)});a.signal(f,"fold",f,o.from,o.to)}function e(f,g){var i=d(f,g,"widget");if(typeof i=="string"){var h=document.createTextNode(i);i=document.createElement("span");i.appendChild(h);i.className="CodeMirror-foldmarker"}return i}a.newFoldFunction=function(f,g){return function(h,i){c(h,i,{rangeFinder:f,widget:g})}};a.defineExtension("foldCode",function(h,g,f){c(this,h,g,f)});a.defineExtension("isFolded",function(h){var g=this.findMarksAt(h);for(var f=0;f<g.length;++f){if(g[f].__isFold){return true}}});a.commands.toggleFold=function(f){f.foldCode(f.getCursor())};a.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold")};a.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold")};a.commands.foldAll=function(f){f.operation(function(){for(var h=f.firstLine(),g=f.lastLine();h<=g;h++){f.foldCode(a.Pos(h,0),null,"fold")}})};a.commands.unfoldAll=function(f){f.operation(function(){for(var h=f.firstLine(),g=f.lastLine();h<=g;h++){f.foldCode(a.Pos(h,0),null,"unfold")}})};a.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(g,k){for(var j=0;j<f.length;++j){var h=f[j](g,k);if(h){return h}}}});a.registerHelper("fold","auto",function(f,k){var h=f.getHelpers(k,"fold");for(var j=0;j<h.length;j++){var g=h[j](f,k);if(g){return g}}});var b={rangeFinder:a.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:false,clearOnEnter:true};a.defineOption("foldOptions",null);function d(f,i,h){if(i&&i[h]!==undefined){return i[h]}var g=f.options.foldOptions;if(g&&g[h]!==undefined){return g[h]}return b[h]}a.defineExtension("foldOption",function(g,f){return d(this,g,f)})});