(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../fold/xml-fold"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../fold/xml-fold"],a)}else{a(CodeMirror)}}})(function(b){b.defineOption("matchTags",false,function(e,g,f){if(f&&f!=b.Init){e.off("cursorActivity",c);e.off("viewportChange",d);a(e)}if(g){e.state.matchBothTags=typeof g=="object"&&g.bothTags;e.on("cursorActivity",c);e.on("viewportChange",d);c(e)}});function a(e){if(e.state.tagHit){e.state.tagHit.clear()}if(e.state.tagOther){e.state.tagOther.clear()}e.state.tagHit=e.state.tagOther=null}function c(e){e.state.failedTagMatch=false;e.operation(function(){a(e);if(e.somethingSelected()){return}var f=e.getCursor(),j=e.getViewport();j.from=Math.min(j.from,f.line);j.to=Math.max(f.line+1,j.to);var h=b.findMatchingTag(e,f,j);if(!h){return}if(e.state.matchBothTags){var g=h.at=="open"?h.open:h.close;if(g){e.state.tagHit=e.markText(g.from,g.to,{className:"CodeMirror-matchingtag"})}}var i=h.at=="close"?h.open:h.close;if(i){e.state.tagOther=e.markText(i.from,i.to,{className:"CodeMirror-matchingtag"})}else{e.state.failedTagMatch=true}})}function d(e){if(e.state.failedTagMatch){c(e)}}b.commands.toMatchingTag=function(e){var f=b.findMatchingTag(e,e.getCursor());if(f){var g=f.at=="close"?f.open:f.close;if(g){e.extendSelection(g.to,g.from)}}}});