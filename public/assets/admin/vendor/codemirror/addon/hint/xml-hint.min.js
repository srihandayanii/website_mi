(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){var c=a.Pos;function b(k,w){var E=w&&w.schemaInfo;var y=(w&&w.quoteChar)||'"';if(!E){return}var l=k.getCursor(),H=k.getTokenAt(l);if(H.end>l.ch){H.end=l.ch;H.string=H.string.slice(0,l.ch-H.start)}var r=a.innerMode(k.getMode(),H.state);if(r.mode.name!="xml"){return}var A=[],z=false,x;var C=/\btag\b/.test(H.type)&&!/>$/.test(H.string);var D=C&&/^\w/.test(H.string),F;if(D){var h=k.getLine(l.line).slice(Math.max(0,H.start-2),H.start);var G=/<\/$/.test(h)?"close":/<$/.test(h)?"open":null;if(G){F=H.start-(G=="close"?2:1)}}else{if(C&&H.string=="<"){G="open"}else{if(C&&H.string=="</"){G="close"}}}if(!C&&!r.state.tagName||G){if(D){x=H.string}z=G;var o=r.state.context,m=o&&E[o.tagName];var j=o?m&&m.children:E["!top"];if(j&&G!="close"){for(var q=0;q<j.length;++q){if(!x||j[q].lastIndexOf(x,0)==0){A.push("<"+j[q])}}}else{if(G!="close"){for(var u in E){if(E.hasOwnProperty(u)&&u!="!top"&&u!="!attrs"&&(!x||u.lastIndexOf(x,0)==0)){A.push("<"+u)}}}}if(o&&(!x||G=="close"&&o.tagName.lastIndexOf(x,0)==0)){A.push("</"+o.tagName+">")}}else{var m=E[r.state.tagName],f=m&&m.attrs;var p=E["!attrs"];if(!f&&!p){return}if(!f){f=p}else{if(p){var B={};for(var v in p){if(p.hasOwnProperty(v)){B[v]=p[v]}}for(var v in f){if(f.hasOwnProperty(v)){B[v]=f[v]}}f=B}}if(H.type=="string"||H.string=="="){var h=k.getRange(c(l.line,Math.max(0,l.ch-60)),c(l.line,H.type=="string"?H.start:H.end));var d=h.match(/([^\s\u00a0=<>\"\']+)=$/),g;if(!d||!f.hasOwnProperty(d[1])||!(g=f[d[1]])){return}if(typeof g=="function"){g=g.call(this,k)}if(H.type=="string"){x=H.string;var t=0;if(/['"]/.test(H.string.charAt(0))){y=H.string.charAt(0);x=H.string.slice(1);t++}var s=H.string.length;if(/['"]/.test(H.string.charAt(s-1))){y=H.string.charAt(s-1);x=H.string.substr(t,s-2)}z=true}for(var q=0;q<g.length;++q){if(!x||g[q].lastIndexOf(x,0)==0){A.push(y+g[q]+y)}}}else{if(H.type=="attribute"){x=H.string;z=true}for(var e in f){if(f.hasOwnProperty(e)&&(!x||e.lastIndexOf(x,0)==0)){A.push(e)}}}}return{list:A,from:z?c(l.line,F==null?H.start:F):l,to:z?c(l.line,H.end):l}}a.registerHelper("hint","xml",b)});