(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){var d={};var c=/[^\s\u00a0]/;var e=a.Pos;function b(h){var g=h.search(c);return g==-1?0:g}a.commands.toggleComment=function(g){g.toggleComment()};a.defineExtension("toggleComment",function(m){if(!m){m=d}var g=this;var k=Infinity,n=this.listSelections(),l=null;for(var j=n.length-1;j>=0;j--){var h=n[j].from(),o=n[j].to();if(h.line>=k){continue}if(o.line>=k){o=e(k,0)}k=h.line;if(l==null){if(g.uncomment(h,o,m)){l="un"}else{g.lineComment(h,o,m);l="line"}}else{if(l=="un"){g.uncomment(h,o,m)}else{g.lineComment(h,o,m)}}}});function f(g,i,h){return/\bstring\b/.test(g.getTokenTypeAt(e(i.line,0)))&&!/^[\'\"`]/.test(h)}a.defineExtension("lineComment",function(k,p,m){if(!m){m=d}var o=this,l=o.getModeAt(k);var j=o.getLine(k.line);if(j==null||f(o,k,j)){return}var h=m.lineComment||l.lineComment;if(!h){if(m.blockCommentStart||l.blockCommentStart){m.fullLines=true;o.blockComment(k,p,m)}return}var i=Math.min(p.ch!=0||p.line==k.line?p.line+1:p.line,o.lastLine()+1);var n=m.padding==null?" ":m.padding;var g=m.commentBlankLines||k.line==p.line;o.operation(function(){if(m.indent){var q=null;for(var s=k.line;s<i;++s){var t=o.getLine(s);var u=t.slice(0,b(t));if(q==null||q.length>u.length){q=u}}for(var s=k.line;s<i;++s){var t=o.getLine(s),r=q.length;if(!g&&!c.test(t)){continue}if(t.slice(0,r)!=q){r=b(t)}o.replaceRange(q+h+n,e(s,0),e(s,r))}}else{for(var s=k.line;s<i;++s){if(g||c.test(o.getLine(s))){o.replaceRange(h+n,e(s,0))}}}})});a.defineExtension("blockComment",function(i,o,k){if(!k){k=d}var m=this,j=m.getModeAt(i);var n=k.blockCommentStart||j.blockCommentStart;var h=k.blockCommentEnd||j.blockCommentEnd;if(!n||!h){if((k.lineComment||j.lineComment)&&k.fullLines!=false){m.lineComment(i,o,k)}return}var g=Math.min(o.line,m.lastLine());if(g!=i.line&&o.ch==0&&c.test(m.getLine(g))){--g}var l=k.padding==null?" ":k.padding;if(i.line>g){return}m.operation(function(){if(k.fullLines!=false){var q=c.test(m.getLine(g));m.replaceRange(l+h,e(g));m.replaceRange(n+l,e(i.line,0));var r=k.blockCommentLead||j.blockCommentLead;if(r!=null){for(var p=i.line+1;p<=g;++p){if(p!=g||q){m.replaceRange(r+l,e(p,0))}}}}else{m.replaceRange(h,o);m.replaceRange(n,i)}})});a.defineExtension("uncomment",function(p,E,y){if(!y){y=d}var A=this,w=A.getModeAt(p);var k=Math.min(E.ch!=0||E.line==p.line?E.line:E.line-1,A.lastLine()),B=Math.min(p.line,k);var v=y.lineComment||w.lineComment,u=[];var z=y.padding==null?" ":y.padding,j;lineComment:{if(!v){break lineComment}for(var q=B;q<=k;++q){var t=A.getLine(q);var o=t.indexOf(v);if(o>-1&&!/comment/.test(A.getTokenTypeAt(e(q,o+1)))){o=-1}if(o==-1&&c.test(t)){break lineComment}if(o>-1&&c.test(t.slice(0,o))){break lineComment}u.push(t)}A.operation(function(){for(var G=B;G<=k;++G){var H=u[G-B];var I=H.indexOf(v),F=I+v.length;if(I<0){continue}if(H.slice(F,F+z.length)==z){F+=z.length}j=true;A.replaceRange("",e(G,I),e(G,F))}});if(j){return true}}var D=y.blockCommentStart||w.blockCommentStart;var m=y.blockCommentEnd||w.blockCommentEnd;if(!D||!m){return false}var s=y.blockCommentLead||w.blockCommentLead;var C=A.getLine(B),l=k==B?C:A.getLine(k);var x=C.indexOf(D),h=l.lastIndexOf(m);if(h==-1&&B!=k){l=A.getLine(--k);h=l.lastIndexOf(m)}if(x==-1||h==-1||!/comment/.test(A.getTokenTypeAt(e(B,x+1)))||!/comment/.test(A.getTokenTypeAt(e(k,h+1)))){return false}var r=C.lastIndexOf(D,p.ch);var n=r==-1?-1:C.slice(0,p.ch).indexOf(m,r+D.length);if(r!=-1&&n!=-1&&n+m.length!=p.ch){return false}n=l.indexOf(m,E.ch);var g=l.slice(E.ch).lastIndexOf(D,n-E.ch);r=(n==-1||g==-1)?-1:E.ch+g;if(n!=-1&&r!=-1&&r!=E.ch){return false}A.operation(function(){A.replaceRange("",e(k,h-(z&&l.slice(h-z.length,h)==z?z.length:0)),e(k,h+m.length));var J=x+D.length;if(z&&C.slice(J,J+z.length)==z){J+=z.length}A.replaceRange("",e(B,x),e(B,J));if(s){for(var H=B+1;H<=k;++H){var I=A.getLine(H),F=I.indexOf(s);if(F==-1||c.test(I.slice(0,F))){continue}var G=F+s.length;if(z&&I.slice(G,G+z.length)==z){G+=z.length}A.replaceRange("",e(H,F),e(H,G))}}});return true})});