(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("smalltalk",function(b){var j=/[+\-\/\\*~<>=@%|&?!.,:;^]/;var d=/true|false|nil|self|super|thisContext/;var c=function(n,m){this.next=n;this.parent=m};var l=function(o,m,n){this.name=o;this.context=m;this.eos=n};var k=function(){this.context=new c(e,null);this.expectVariable=true;this.indentation=0;this.userIndentationDelta=0};k.prototype.userIndent=function(m){this.userIndentationDelta=m>0?(m/b.indentUnit-this.indentation):0};var e=function(p,n,o){var q=new l(null,n,false);var m=p.next();if(m==='"'){q=f(p,new c(f,n))}else{if(m==="'"){q=g(p,new c(g,n))}else{if(m==="#"){if(p.peek()==="'"){p.next();q=h(p,new c(h,n))}else{if(p.eatWhile(/[^\s.{}\[\]()]/)){q.name="string-2"}else{q.name="meta"}}}else{if(m==="$"){if(p.next()==="<"){p.eatWhile(/[^\s>]/);p.next()}q.name="string-2"}else{if(m==="|"&&o.expectVariable){q.context=new c(i,n)}else{if(/[\[\]{}()]/.test(m)){q.name="bracket";q.eos=/[\[{(]/.test(m);if(m==="["){o.indentation++}else{if(m==="]"){o.indentation=Math.max(0,o.indentation-1)}}}else{if(j.test(m)){p.eatWhile(j);q.name="operator";q.eos=m!==";"}else{if(/\d/.test(m)){p.eatWhile(/[\w\d]/);q.name="number"}else{if(/[\w_]/.test(m)){p.eatWhile(/[\w\d_]/);q.name=o.expectVariable?(d.test(p.current())?"keyword":"variable"):null}else{q.eos=o.expectVariable}}}}}}}}}return q};var f=function(n,m){n.eatWhile(/[^"]/);return new l("comment",n.eat('"')?m.parent:m,true)};var g=function(n,m){n.eatWhile(/[^']/);return new l("string",n.eat("'")?m.parent:m,false)};var h=function(n,m){n.eatWhile(/[^']/);return new l("string-2",n.eat("'")?m.parent:m,false)};var i=function(o,n){var p=new l(null,n,false);var m=o.next();if(m==="|"){p.context=n.parent;p.eos=true}else{o.eatWhile(/[^|]/);p.name="variable"}return p};return{startState:function(){return new k},token:function(n,m){m.userIndent(n.indentation());if(n.eatSpace()){return null}var o=m.context.next(n,m.context,m);m.context=o.context;m.expectVariable=o.eos;return o.name},blankLine:function(m){m.userIndent(0)},indent:function(n,o){var m=n.context.next===e&&o&&o.charAt(0)==="]"?-1:n.userIndentationDelta;return(n.indentation+m)*b.indentUnit},electricChars:"]"}});a.defineMIME("text/x-stsrc",{name:"smalltalk"})});