(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("stex",function(){function j(m,l){m.cmdState.push(l)}function g(l){if(l.cmdState.length>0){return l.cmdState[l.cmdState.length-1]}else{return null}}function i(m){var l=m.cmdState.pop();if(l){l.closeBracket()}}function d(o){var l=o.cmdState;for(var m=l.length-1;m>=0;m--){var n=l[m];if(n.name=="DEFAULT"){continue}return n}return{styleIdentifier:function(){return null}}}function b(m,l,n){return function(){this.name=m;this.bracketNo=0;this.style=l;this.styles=n;this.argument=null;this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null};this.openBracket=function(){this.bracketNo++;return"bracket"};this.closeBracket=function(){}}}var h={};h.importmodule=b("importmodule","tag",["string","builtin"]);h.documentclass=b("documentclass","tag",["","atom"]);h.usepackage=b("usepackage","tag",["atom"]);h.begin=b("begin","tag",["atom"]);h.end=b("end","tag",["atom"]);h.DEFAULT=function(){this.name="DEFAULT";this.style="tag";this.styleIdentifier=this.openBracket=this.closeBracket=function(){}};function k(m,l){m.f=l}function f(o,p){var n;if(o.match(/^\\[a-zA-Z@]+/)){var m=o.current().slice(1);n=h[m]||h.DEFAULT;n=new n();j(p,n);k(p,c);return n.style}if(o.match(/^\\[$&%#{}_]/)){return"tag"}if(o.match(/^\\[,;!\/\\]/)){return"tag"}if(o.match("\\[")){k(p,function(q,r){return e(q,r,"\\]")});return"keyword"}if(o.match("$$")){k(p,function(q,r){return e(q,r,"$$")});return"keyword"}if(o.match("$")){k(p,function(q,r){return e(q,r,"$")});return"keyword"}var l=o.next();if(l=="%"){o.skipToEnd();return"comment"}else{if(l=="}"||l=="]"){n=g(p);if(n){n.closeBracket(l);k(p,c)}else{return"error"}return"bracket"}else{if(l=="{"||l=="["){n=h.DEFAULT;n=new n();j(p,n);return"bracket"}else{if(/\d/.test(l)){o.eatWhile(/[\w.%]/);return"atom"}else{o.eatWhile(/[\w\-_]/);n=d(p);if(n.name=="begin"){n.argument=o.current()}return n.styleIdentifier()}}}}}function e(n,o,m){if(n.eatSpace()){return null}if(n.match(m)){k(o,f);return"keyword"}if(n.match(/^\\[a-zA-Z@]+/)){return"tag"}if(n.match(/^[a-zA-Z]+/)){return"variable-2"}if(n.match(/^\\[$&%#{}_]/)){return"tag"}if(n.match(/^\\[,;!\/]/)){return"tag"}if(n.match(/^[\^_&]/)){return"tag"}if(n.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)){return null}if(n.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)){return"number"}var l=n.next();if(l=="{"||l=="}"||l=="["||l=="]"||l=="("||l==")"){return"bracket"}if(l=="%"){n.skipToEnd();return"comment"}return"error"}function c(n,o){var l=n.peek(),m;if(l=="{"||l=="["){m=g(o);m.openBracket(l);n.eat(l);k(o,f);return"bracket"}if(/[ \t\r]/.test(l)){n.eat(l);return null}k(o,f);i(o);return f(n,o)}return{startState:function(){return{cmdState:[],f:f}},copyState:function(l){return{cmdState:l.cmdState.slice(),f:l.f}},token:function(m,l){return l.f(m,l)},blankLine:function(l){l.f=f;l.cmdState.length=0},lineComment:"%"}});a.defineMIME("text/x-stex","stex");a.defineMIME("text/x-latex","stex")});