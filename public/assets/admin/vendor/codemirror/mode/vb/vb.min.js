(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("vb",function(e,w){var l="error";function G(H){return new RegExp("^(("+H.join(")|(")+"))\\b","i")}var y=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]");var x=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var j=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var i=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var D=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var n=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var u=["class","module","sub","enum","select","while","if","function","get","set","property","try"];var s=["else","elseif","case","catch"];var k=["next","loop"];var v=["and","or","not","xor","in"];var F=G(v);var c=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"];var d=["integer","string","double","decimal","boolean","short","char","float","single"];var q=G(c);var E=G(d);var z='"';var t=G(u);var r=G(s);var b=G(k);var h=G(["end"]);var g=G(["do"]);var p=null;a.registerHelper("hintWords","vb",u.concat(s).concat(k).concat(v).concat(c).concat(d));function o(H,I){I.currentIndent++}function f(H,I){I.currentIndent--}function A(L,K){if(L.eatSpace()){return null}var H=L.peek();if(H==="'"){L.skipToEnd();return"comment"}if(L.match(/^((&H)|(&O))?[0-9\.a-f]/i,false)){var I=false;if(L.match(/^\d*\.\d+F?/i)){I=true}else{if(L.match(/^\d+\.\d*F?/)){I=true}else{if(L.match(/^\.\d+F?/)){I=true}}}if(I){L.eat(/J/i);return"number"}var J=false;if(L.match(/^&H[0-9a-f]+/i)){J=true}else{if(L.match(/^&O[0-7]+/i)){J=true}else{if(L.match(/^[1-9]\d*F?/)){L.eat(/J/i);J=true}else{if(L.match(/^0(?![\dx])/i)){J=true}}}}if(J){L.eat(/L/i);return"number"}}if(L.match(z)){K.tokenize=C(L.current());return K.tokenize(L,K)}if(L.match(D)||L.match(i)){return null}if(L.match(j)||L.match(y)||L.match(F)){return"operator"}if(L.match(x)){return null}if(L.match(g)){o(L,K);K.doInCurrentLine=true;return"keyword"}if(L.match(t)){if(!K.doInCurrentLine){o(L,K)}else{K.doInCurrentLine=false}return"keyword"}if(L.match(r)){return"keyword"}if(L.match(h)){f(L,K);f(L,K);return"keyword"}if(L.match(b)){f(L,K);return"keyword"}if(L.match(E)){return"keyword"}if(L.match(q)){return"keyword"}if(L.match(n)){return"variable"}L.next();return l}function C(H){var J=H.length==1;var I="string";return function(L,K){while(!L.eol()){L.eatWhile(/[^'"]/);if(L.match(H)){K.tokenize=A;return I}else{L.eat(/['"]/)}}if(J){if(w.singleLineStringErrors){return l}else{K.tokenize=A}}return I}}function B(K,J){var L=J.tokenize(K,J);var H=K.current();if(H==="."){L=J.tokenize(K,J);H=K.current();if(L==="variable"){return"variable"}else{return l}}var I="[({".indexOf(H);if(I!==-1){o(K,J)}if(p==="dedent"){if(f(K,J)){return l}}I="])}".indexOf(H);if(I!==-1){if(f(K,J)){return l}}return L}var m={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:A,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false}},token:function(I,H){if(I.sol()){H.currentIndent+=H.nextLineIndent;H.nextLineIndent=0;H.doInCurrentLine=0}var J=B(I,H);H.lastToken={style:J,content:I.current()};return J},indent:function(H,I){var J=I.replace(/^\s+|\s+$/g,"");if(J.match(b)||J.match(h)||J.match(r)){return e.indentUnit*(H.currentIndent-1)}if(H.currentIndent<0){return 0}return H.currentIndent*e.indentUnit},lineComment:"'"};return m});a.defineMIME("text/x-vb","vb")});