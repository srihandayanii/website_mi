(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("tiddlywiki",function(){var p={};var d={allTags:true,closeAll:true,list:true,newJournal:true,newTiddler:true,permaview:true,saveChanges:true,search:true,slider:true,tabs:true,tag:true,tagging:true,tags:true,tiddler:true,timeline:true,today:true,version:true,option:true,"with":true,filter:true};var c=/[\w_\-]/i,h=/^\-\-\-\-+$/,l=/^\/\*\*\*$/,m=/^\*\*\*\/$/,e=/^<<<$/,i=/^\/\/\{\{\{$/,j=/^\/\/\}\}\}$/,n=/^<!--\{\{\{-->$/,o=/^<!--\}\}\}-->$/,f=/^\{\{\{$/,g=/^\}\}\}$/,k=/.*?\}\}\}/;function b(A,z,y){z.tokenize=y;return y(A,z)}function q(B,A){var z=B.sol(),y=B.peek();A.block=false;if(z&&/[<\/\*{}\-]/.test(y)){if(B.match(f)){A.block=true;return b(B,A,r)}if(B.match(e)){return"quote"}if(B.match(l)||B.match(m)){return"comment"}if(B.match(i)||B.match(j)||B.match(n)||B.match(o)){return"comment"}if(B.match(h)){return"hr"}}B.next();if(z&&/[\/\*!#;:>|]/.test(y)){if(y=="!"){B.skipToEnd();return"header"}if(y=="*"){B.eatWhile("*");return"comment"}if(y=="#"){B.eatWhile("#");return"comment"}if(y==";"){B.eatWhile(";");return"comment"}if(y==":"){B.eatWhile(":");return"comment"}if(y==">"){B.eatWhile(">");return"quote"}if(y=="|"){return"header"}}if(y=="{"&&B.match(/\{\{/)){return b(B,A,r)}if(/[hf]/i.test(y)&&/[ti]/i.test(B.peek())&&B.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i)){return"link"}if(y=='"'){return"string"}if(y=="~"){return"brace"}if(/[\[\]]/.test(y)&&B.match(y)){return"brace"}if(y=="@"){B.eatWhile(c);return"link"}if(/\d/.test(y)){B.eatWhile(/\d/);return"number"}if(y=="/"){if(B.eat("%")){return b(B,A,s)}else{if(B.eat("/")){return b(B,A,t)}}}if(y=="_"&&B.eat("_")){return b(B,A,x)}if(y=="-"&&B.eat("-")){if(B.peek()!=" "){return b(B,A,v)}if(B.peek()==" "){return"brace"}}if(y=="'"&&B.eat("'")){return b(B,A,w)}if(y=="<"&&B.eat("<")){return b(B,A,u)}B.eatWhile(/[\w\$_]/);return p.propertyIsEnumerable(B.current())?"keyword":null}function s(B,A){var z=false,y;while(y=B.next()){if(y=="/"&&z){A.tokenize=q;break}z=(y=="%")}return"comment"}function w(B,A){var z=false,y;while(y=B.next()){if(y=="'"&&z){A.tokenize=q;break}z=(y=="'")}return"strong"}function r(A,z){var y=z.block;if(y&&A.current()){return"comment"}if(!y&&A.match(k)){z.tokenize=q;return"comment"}if(y&&A.sol()&&A.match(g)){z.tokenize=q;return"comment"}A.next();return"comment"}function t(B,A){var z=false,y;while(y=B.next()){if(y=="/"&&z){A.tokenize=q;break}z=(y=="/")}return"em"}function x(B,A){var z=false,y;while(y=B.next()){if(y=="_"&&z){A.tokenize=q;break}z=(y=="_")}return"underlined"}function v(B,A){var z=false,y;while(y=B.next()){if(y=="-"&&z){A.tokenize=q;break}z=(y=="-")}return"strikethrough"}function u(A,z){if(A.current()=="<<"){return"macro"}var y=A.next();if(!y){z.tokenize=q;return null}if(y==">"){if(A.peek()==">"){A.next();z.tokenize=q;return"macro"}}A.eatWhile(/[\w\$_]/);return d.propertyIsEnumerable(A.current())?"keyword":null}return{startState:function(){return{tokenize:q}},token:function(z,y){if(z.eatSpace()){return null}var A=y.tokenize(z,y);return A}}});a.defineMIME("text/x-tiddlywiki","tiddlywiki")});