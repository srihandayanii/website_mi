(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("smarty",function(d,j){var l=j.rightDelimiter||"}";var i=j.leftDelimiter||"{";var q=j.version||2;var b=a.getMode(d,j.baseMode||"null");var g=["debug","extends","function","include","literal"];var k={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/};var h;function e(s,r){h=r;return s}function c(t,s,r){s.tokenize=r;return r(t,s)}function f(s,r){if(r==null){r=s.pos}return q===3&&i=="{"&&(r==s.string.length||/\s/.test(s.string.charAt(r)))}function p(u,t){var v=u.string;for(var s=u.pos;;){var r=v.indexOf(i,s);s=r+i.length;if(r==-1||!f(u,r+i.length)){break}}if(r==u.pos){u.match(i);if(u.eat("*")){return c(u,t,n("comment","*"+l))}else{t.depth++;t.tokenize=o;h="startTag";return"tag"}}if(r>-1){u.string=v.slice(0,r)}var w=b.token(u,t.base);if(r>-1){u.string=v}return w}function o(x,v){if(x.match(l,true)){if(q===3){v.depth--;if(v.depth<=0){v.tokenize=p}}else{v.tokenize=p}return e("tag",null)}if(x.match(i,true)){v.depth++;return e("tag","startTag")}var s=x.next();if(s=="$"){x.eatWhile(k.validIdentifier);return e("variable-2","variable")}else{if(s=="|"){return e("operator","pipe")}else{if(s=="."){return e("operator","property")}else{if(k.stringChar.test(s)){v.tokenize=m(s);return e("string","string")}else{if(k.operatorChars.test(s)){x.eatWhile(k.operatorChars);return e("operator","operator")}else{if(s=="["||s=="]"){return e("bracket","bracket")}else{if(s=="("||s==")"){return e("bracket","operator")}else{if(/\d/.test(s)){x.eatWhile(/\d/);return e("number","number")}else{if(v.last=="variable"){if(s=="@"){x.eatWhile(k.validIdentifier);return e("property","property")}else{if(s=="|"){x.eatWhile(k.validIdentifier);return e("qualifier","modifier")}}}else{if(v.last=="pipe"){x.eatWhile(k.validIdentifier);return e("qualifier","modifier")}else{if(v.last=="whitespace"){x.eatWhile(k.validIdentifier);return e("attribute","modifier")}}}if(v.last=="property"){x.eatWhile(k.validIdentifier);return e("property",null)}else{if(/\s/.test(s)){h="whitespace";return null}}var w="";if(s!="/"){w+=s}var r=null;while(r=x.eat(k.validIdentifier)){w+=r}for(var t=0,u=g.length;t<u;t++){if(g[t]==w){return e("keyword","keyword")}}if(/\s/.test(s)){return null}return e("tag","tag")}}}}}}}}}function m(r){return function(v,u){var t=null;var s=null;while(!v.eol()){s=v.peek();if(v.next()==r&&t!=="\\"){u.tokenize=o;break}t=s}return"string"}}function n(r,s){return function(u,t){while(!u.eol()){if(u.match(s)){t.tokenize=p;break}u.next()}return r}}return{startState:function(){return{base:a.startState(b),tokenize:p,last:null,depth:0}},copyState:function(r){return{base:a.copyState(b,r.base),tokenize:r.tokenize,last:r.last,depth:r.depth}},innerMode:function(r){if(r.tokenize==p){return{mode:b,state:r.base}}},token:function(s,r){var t=r.tokenize(s,r);r.last=h;return t},indent:function(r,s){if(r.tokenize==p&&b.indent){return b.indent(r.base,s)}else{return a.Pass}},blockCommentStart:i+"*",blockCommentEnd:"*"+l}});a.defineMIME("text/x-smarty","smarty")});