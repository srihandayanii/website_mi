(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("tiki",function(e){function m(y,z,x){return function(B,A){while(!B.eol()){if(B.match(z)){A.tokenize=q;break}B.next()}if(x){A.tokenize=x}return y}}function o(x){return function(z,y){while(!z.eol()){z.next()}y.tokenize=q;return x}}function q(B,A){function y(C){A.tokenize=C;return C(B,A)}var z=B.sol();var x=B.next();switch(x){case"{":B.eat("/");B.eatSpace();B.eatWhile(/[^\s\u00a0=\"\'\/?(}]/);A.tokenize=p;return"tag";case"_":if(B.eat("_")){return y(m("strong","__",q))}break;case"'":if(B.eat("'")){return y(m("em","''",q))}break;case"(":if(B.eat("(")){return y(m("variable-2","))",q))}break;case"[":return y(m("variable-3","]",q));break;case"|":if(B.eat("|")){return y(m("comment","||"))}break;case"-":if(B.eat("=")){return y(m("header string","=-",q))}else{if(B.eat("-")){return y(m("error tw-deleted","--",q))}}break;case"=":if(B.match("==")){return y(m("tw-underline","===",q))}break;case":":if(B.eat(":")){return y(m("comment","::"))}break;case"^":return y(m("tw-box","^"));break;case"~":if(B.match("np~")){return y(m("meta","~/np~"))}break}if(z){switch(x){case"!":if(B.match("!!!!!")){return y(o("header string"))}else{if(B.match("!!!!")){return y(o("header string"))}else{if(B.match("!!!")){return y(o("header string"))}else{if(B.match("!!")){return y(o("header string"))}else{return y(o("header string"))}}}}break;case"*":case"#":case"+":return y(o("tw-listitem bracket"));break}}return null}var n=e.indentUnit;var s,w;function p(A,z){var x=A.next();var y=A.peek();if(x=="}"){z.tokenize=q;return"tag"}else{if(x=="("||x==")"){return"bracket"}else{if(x=="="){w="equals";if(y==">"){x=A.next();y=A.peek()}if(!/[\'\"]/.test(y)){z.tokenize=l()}return"operator"}else{if(/[\'\"]/.test(x)){z.tokenize=k(x);return z.tokenize(A,z)}else{A.eatWhile(/[^\s\u00a0=\"\'\/?]/);return"keyword"}}}}}function k(x){return function(z,y){while(!z.eol()){if(z.next()==x){y.tokenize=p;break}}return"string"}}function l(){return function(A,z){while(!A.eol()){var x=A.next();var y=A.peek();if(x==" "||x==","||/[ )}]/.test(y)){z.tokenize=p;break}}return"string"}}var g,v;function r(){for(var x=arguments.length-1;x>=0;x--){g.cc.push(arguments[x])}}function f(){r.apply(null,arguments);return true}function u(y,z){var x=g.context&&g.context.noIndent;g.context={prev:g.context,pluginName:y,indent:g.indented,startOfLine:z,noIndent:x}}function t(){if(g.context){g.context=g.context.prev}}function h(y){if(y=="openPlugin"){g.pluginName=s;return f(b,j(g.startOfLine))}else{if(y=="closePlugin"){var x=false;if(g.context){x=g.context.pluginName!=s;t()}else{x=true}if(x){v="error"}return f(i(x))}else{if(y=="string"){if(!g.context||g.context.name!="!cdata"){u("!cdata")}if(g.tokenize==q){t()}return f()}else{return f()}}}}function j(x){return function(y){if(y=="selfclosePlugin"||y=="endPlugin"){return f()}if(y=="endPlugin"){u(g.pluginName,x);return f()}return f()}}function i(x){return function(y){if(x){v="error"}if(y=="endPlugin"){return f()}return r()}}function b(x){if(x=="keyword"){v="attribute";return f(b)}if(x=="equals"){return f(c,b)}return r()}function c(x){if(x=="keyword"){v="string";return f()}if(x=="string"){return f(d)}return r()}function d(x){if(x=="string"){return f(d)}else{return r()}}return{startState:function(){return{tokenize:q,cc:[],indented:0,startOfLine:true,pluginName:null,context:null}},token:function(z,y){if(z.sol()){y.startOfLine=true;y.indented=z.indentation()}if(z.eatSpace()){return null}v=w=s=null;var A=y.tokenize(z,y);if((A||w)&&A!="comment"){g=y;while(true){var x=y.cc.pop()||h;if(x(w||A)){break}}}y.startOfLine=false;return v||A},indent:function(y,z){var x=y.context;if(x&&x.noIndent){return 0}if(x&&/^{\//.test(z)){x=x.prev}while(x&&!x.startOfLine){x=x.prev}if(x){return x.indent+n}else{return 0}},electricChars:"/"}});a.defineMIME("text/tiki","tiki")});