(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("oz",function(e){function t(u){return new RegExp("^(("+u.join(")|(")+"))\\b")}var l=/[\^@!\|<>#~\.\*\-\+\\/,=]/;var f=/(<-)|(:=)|(=<)|(>=)|(<=)|(<:)|(>:)|(=:)|(\\=)|(\\=:)|(!!)|(==)|(::)/;var s=/(:::)|(\.\.\.)|(=<:)|(>=:)/;var i=["in","then","else","of","elseof","elsecase","elseif","catch","finally","with","require","prepare","import","export","define","do"];var g=["end"];var b=t(["true","false","nil","unit"]);var d=t(["andthen","at","attr","declare","feat","from","lex","mod","mode","orelse","parser","prod","prop","scanner","self","syn","token"]);var k=t(["local","proc","fun","case","class","if","cond","or","dis","choice","not","thread","try","raise","lock","for","suchthat","meth","functor"]);var j=t(i);var h=t(g);function m(x,w){if(x.eatSpace()){return null}if(x.match(/[{}]/)){return"bracket"}if(x.match(/(\[])/)){return"keyword"}if(x.match(s)||x.match(f)){return"operator"}if(x.match(b)){return"atom"}var v=x.match(k);if(v){if(!w.doInCurrentLine){w.currentIndent++}else{w.doInCurrentLine=false}if(v[0]=="proc"||v[0]=="fun"){w.tokenize=p}else{if(v[0]=="class"){w.tokenize=n}else{if(v[0]=="meth"){w.tokenize=q}}}return"keyword"}if(x.match(j)||x.match(d)){return"keyword"}if(x.match(h)){w.currentIndent--;return"keyword"}var u=x.next();if(u=='"'||u=="'"){w.tokenize=r(u);return w.tokenize(x,w)}if(/[~\d]/.test(u)){if(u=="~"){if(!/^[0-9]/.test(x.peek())){return null}else{if((x.next()=="0"&&x.match(/^[xX][0-9a-fA-F]+/))||x.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}}}if((u=="0"&&x.match(/^[xX][0-9a-fA-F]+/))||x.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}return null}if(u=="%"){x.skipToEnd();return"comment"}else{if(u=="/"){if(x.eat("*")){w.tokenize=o;return o(x,w)}}}if(l.test(u)){return"operator"}x.eatWhile(/\w/);return"variable"}function n(v,u){if(v.eatSpace()){return null}v.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)/);u.tokenize=m;return"variable-3"}function q(v,u){if(v.eatSpace()){return null}v.match(/([a-zA-Z][A-Za-z0-9_]*)|(`.+`)/);u.tokenize=m;return"def"}function p(v,u){if(v.eatSpace()){return null}if(!u.hasPassedFirstStage&&v.eat("{")){u.hasPassedFirstStage=true;return"bracket"}else{if(u.hasPassedFirstStage){v.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)|\$/);u.hasPassedFirstStage=false;u.tokenize=m;return"def"}else{u.tokenize=m;return null}}}function o(x,w){var v=false,u;while(u=x.next()){if(u=="/"&&v){w.tokenize=m;break}v=(u=="*")}return"comment"}function r(u){return function(z,y){var w=false,x,v=false;while((x=z.next())!=null){if(x==u&&!w){v=true;break}w=!w&&x=="\\"}if(v||!w){y.tokenize=m}return"string"}}function c(){var u=i.concat(g);return new RegExp("[\\[\\]]|("+u.join("|")+")$")}return{startState:function(){return{tokenize:m,currentIndent:0,doInCurrentLine:false,hasPassedFirstStage:false}},token:function(v,u){if(v.sol()){u.doInCurrentLine=0}return u.tokenize(v,u)},indent:function(u,v){var w=v.replace(/^\s+|\s+$/g,"");if(w.match(h)||w.match(j)||w.match(/(\[])/)){return e.indentUnit*(u.currentIndent-1)}if(u.currentIndent<0){return 0}return u.currentIndent*e.indentUnit},fold:"indent",electricInput:c(),lineComment:"%",blockCommentStart:"/*",blockCommentEnd:"*/"}});a.defineMIME("text/x-oz","oz")});