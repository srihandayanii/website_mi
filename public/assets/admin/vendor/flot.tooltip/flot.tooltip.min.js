(function(a){var b={tooltip:{show:false,cssClass:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:true,snap:true,lines:false,clickTips:false,onHover:function(f,e){},$compat:false}};b.tooltipOpts=b.tooltip;var c=function(e){this.tipPosition={x:0,y:0};this.init(e)};c.prototype.init=function(g){var k=this;var j=a.plot.plugins.length;this.plotPlugins=[];if(j){for(var f=0;f<j;f++){this.plotPlugins.push(a.plot.plugins[f].name)}}g.hooks.bindEvents.push(function(n,m){k.plotOptions=n.getOptions();if(typeof(k.plotOptions.tooltip)==="boolean"){k.plotOptions.tooltipOpts.show=k.plotOptions.tooltip;k.plotOptions.tooltip=k.plotOptions.tooltipOpts;delete k.plotOptions.tooltipOpts}if(k.plotOptions.tooltip.show===false||typeof k.plotOptions.tooltip.show==="undefined"){return}k.tooltipOptions=k.plotOptions.tooltip;if(k.tooltipOptions.$compat){k.wfunc="width";k.hfunc="height"}else{k.wfunc="innerWidth";k.hfunc="innerHeight"}var l=k.getDomElement();a(n.getPlaceholder()).bind("plothover",i);if(k.tooltipOptions.clickTips){a(n.getPlaceholder()).bind("plotclick",h)}k.clickmode=false;a(m).bind("mousemove",e)});g.hooks.shutdown.push(function(m,l){a(m.getPlaceholder()).unbind("plothover",i);a(m.getPlaceholder()).unbind("plotclick",h);m.removeTooltip();a(l).unbind("mousemove",e)});function e(l){var m={};m.x=l.pageX;m.y=l.pageY;g.setTooltipPosition(m)}function h(l,n,m){if(!k.clickmode){i(l,n,m);if(k.getDomElement().is(":visible")){a(g.getPlaceholder()).unbind("plothover",i);k.clickmode=true}}else{a(g.getPlaceholder()).bind("plothover",i);g.hideTooltip();k.clickmode=false}}function i(n,r,o){var p=function(t,u,v,w){return Math.sqrt((v-t)*(v-t)+(w-u)*(w-u))};var m=function(B,E,C,F,D,G,A){if(A&&!(A=function(J,M,K,N,L,O){if(typeof K!=="undefined"){return{x:K,y:M}}else{if(typeof N!=="undefined"){return{x:J,y:N}}}var H,I=-1/((O-N)/(L-K));return{x:H=(L*(J*I-M+N)+K*(J*-I+M-O))/(I*(L-K)+N-O),y:I*H-I*J+M}}(B,E,C,F,D,G),A.x>=Math.min(C,D)&&A.x<=Math.max(C,D)&&A.y>=Math.min(F,G)&&A.y<=Math.max(F,G))){var w=p(B,E,C,F),z=p(B,E,D,G);return w>z?z:w}else{var t=F-G,u=D-C,v=C*G-F*D;return Math.abs(t*B+u*E+v)/Math.sqrt(t*t+u*u)}};if(o){g.showTooltip(o,k.tooltipOptions.snap?o:r)}else{if(k.plotOptions.series.lines.show&&k.tooltipOptions.lines===true){var q=k.plotOptions.grid.mouseActiveRadius;var l={distance:q+1};var s=r;a.each(g.getData(),function(v,C){var E=0,D=-1;for(var x=1;x<C.data.length;x++){if(C.data[x-1][0]<=r.x&&C.data[x][0]>=r.x){E=x-1;D=x}}if(D===-1){g.hideTooltip();return}var A={x:C.data[E][0],y:C.data[E][1]},y={x:C.data[D][0],y:C.data[D][1]};var u=m(C.xaxis.p2c(r.x),C.yaxis.p2c(r.y),C.xaxis.p2c(A.x),C.yaxis.p2c(A.y),C.xaxis.p2c(y.x),C.yaxis.p2c(y.y),false);if(u<l.distance){var t=p(A.x,A.y,r.x,r.y)<p(r.x,r.y,y.x,y.y)?E:D;var B=C.datapoints.pointsize;var z=[r.x,A.y+((y.y-A.y)*((r.x-A.x)/(y.x-A.x)))];var w={datapoint:z,dataIndex:t,series:C,seriesIndex:v};l={distance:u,item:w};if(k.tooltipOptions.snap){s={pageX:C.xaxis.p2c(z[0]),pageY:C.yaxis.p2c(z[1])}}}});if(l.distance<q+1){g.showTooltip(l.item,s)}else{g.hideTooltip()}}else{g.hideTooltip()}}}g.setTooltipPosition=function(m){var l=k.getDomElement();var o=l.outerWidth()+k.tooltipOptions.shifts.x;var n=l.outerHeight()+k.tooltipOptions.shifts.y;if((m.x-a(window).scrollLeft())>(a(window)[k.wfunc]()-o)){m.x-=o;m.x=Math.max(m.x,0)}if((m.y-a(window).scrollTop())>(a(window)[k.hfunc]()-n)){m.y-=n}if(isNaN(m.x)){k.tipPosition.x=k.tipPosition.xPrev}else{k.tipPosition.x=m.x;k.tipPosition.xPrev=m.x}if(isNaN(m.y)){k.tipPosition.y=k.tipPosition.yPrev}else{k.tipPosition.y=m.y;k.tipPosition.yPrev=m.y}};g.showTooltip=function(n,m,o){var l=k.getDomElement();var p=k.stringFormat(k.tooltipOptions.content,n);if(p===""){return}l.html(p);g.setTooltipPosition({x:k.tipPosition.x,y:k.tipPosition.y});l.css({left:k.tipPosition.x+k.tooltipOptions.shifts.x,top:k.tipPosition.y+k.tooltipOptions.shifts.y}).show();if(typeof k.tooltipOptions.onHover==="function"){k.tooltipOptions.onHover(n,l)}};g.hideTooltip=function(){k.getDomElement().hide().html("")};g.removeTooltip=function(){k.getDomElement().remove()}};c.prototype.getDomElement=function(){var e=a("<div>");if(this.tooltipOptions&&this.tooltipOptions.cssClass){e=a("."+this.tooltipOptions.cssClass);if(e.length===0){e=a("<div />").addClass(this.tooltipOptions.cssClass);e.appendTo("body").hide().css({position:"absolute"});if(this.tooltipOptions.defaultTheme){e.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})}}}return e};c.prototype.stringFormat=function(f,i){var m=/%p\.{0,1}(\d{0,})/;var o=/%s/;var e=/%c/;var w=/%lx/;var D=/%ly/;var z=/%x\.{0,1}(\d{0,})/;var E=/%y\.{0,1}(\d{0,})/;var A="%x";var F="%y";var h="%ct";var k="%n";var u,B,g,l,j;if(typeof i.series.threshold!=="undefined"){u=i.datapoint[0];B=i.datapoint[1];g=i.datapoint[2]}else{if(typeof i.series.curvedLines!=="undefined"){u=i.datapoint[0];B=i.datapoint[1]}else{if(typeof i.series.lines!=="undefined"&&i.series.lines.steps){u=i.series.datapoints.points[i.dataIndex*2];B=i.series.datapoints.points[i.dataIndex*2+1];g=""}else{u=i.series.data[i.dataIndex][0];B=i.series.data[i.dataIndex][1];g=i.series.data[i.dataIndex][2]}}}if(i.series.label===null&&i.series.originSeries){i.series.label=i.series.originSeries.label}if(typeof(f)==="function"){f=f(i.series.label,u,B,i)}if(typeof(f)==="boolean"&&!f){return""}if(g){f=f.replace(h,g)}if(typeof(i.series.percent)!=="undefined"){l=i.series.percent}else{if(typeof(i.series.percents)!=="undefined"){l=i.series.percents[i.dataIndex]}}if(typeof l==="number"){f=this.adjustValPrecision(m,f,l)}if(i.series.hasOwnProperty("pie")){if(typeof i.series.data[0][1]!=="undefined"){j=i.series.data[0][1]}}if(typeof j==="number"){f=f.replace(k,j)}if(typeof(i.series.label)!=="undefined"){f=f.replace(o,i.series.label)}else{f=f.replace(o,"")}if(typeof(i.series.color)!=="undefined"){f=f.replace(e,i.series.color)}else{f=f.replace(e,"")}if(this.hasAxisLabel("xaxis",i)){f=f.replace(w,i.series.xaxis.options.axisLabel)}else{f=f.replace(w,"")}if(this.hasAxisLabel("yaxis",i)){f=f.replace(D,i.series.yaxis.options.axisLabel)}else{f=f.replace(D,"")}if(this.isTimeMode("xaxis",i)&&this.isXDateFormat(i)){f=f.replace(z,this.timestampToDate(u,this.tooltipOptions.xDateFormat,i.series.xaxis.options))}if(this.isTimeMode("yaxis",i)&&this.isYDateFormat(i)){f=f.replace(E,this.timestampToDate(B,this.tooltipOptions.yDateFormat,i.series.yaxis.options))}if(typeof u==="number"){f=this.adjustValPrecision(z,f,u)}if(typeof B==="number"){f=this.adjustValPrecision(E,f,B)}if(typeof i.series.xaxis.ticks!=="undefined"){var r;if(this.hasRotatedXAxisTicks(i)){r="rotatedTicks"}else{r="ticks"}var q=i.dataIndex+i.seriesIndex;for(var v in i.series.xaxis[r]){if(i.series.xaxis[r].hasOwnProperty(q)&&!this.isTimeMode("xaxis",i)){var s=(this.isCategoriesMode("xaxis",i))?i.series.xaxis[r][q].label:i.series.xaxis[r][q].v;if(s===u){f=f.replace(z,i.series.xaxis[r][q].label.replace(/\$/g,"$$$$"))}}}}if(typeof i.series.yaxis.ticks!=="undefined"){for(var C in i.series.yaxis.ticks){if(i.series.yaxis.ticks.hasOwnProperty(C)){var t=(this.isCategoriesMode("yaxis",i))?i.series.yaxis.ticks[C].label:i.series.yaxis.ticks[C].v;if(t===B){f=f.replace(E,i.series.yaxis.ticks[C].label.replace(/\$/g,"$$$$"))}}}}if(typeof i.series.xaxis.tickFormatter!=="undefined"){f=f.replace(A,i.series.xaxis.tickFormatter(u,i.series.xaxis).replace(/\$/g,"$$"))}if(typeof i.series.yaxis.tickFormatter!=="undefined"){f=f.replace(F,i.series.yaxis.tickFormatter(B,i.series.yaxis).replace(/\$/g,"$$"))}return f};c.prototype.isTimeMode=function(e,f){return(typeof f.series[e].options.mode!=="undefined"&&f.series[e].options.mode==="time")};c.prototype.isXDateFormat=function(e){return(typeof this.tooltipOptions.xDateFormat!=="undefined"&&this.tooltipOptions.xDateFormat!==null)};c.prototype.isYDateFormat=function(e){return(typeof this.tooltipOptions.yDateFormat!=="undefined"&&this.tooltipOptions.yDateFormat!==null)};c.prototype.isCategoriesMode=function(e,f){return(typeof f.series[e].options.mode!=="undefined"&&f.series[e].options.mode==="categories")};c.prototype.timestampToDate=function(h,e,f){var g=a.plot.dateGenerator(h,f);return a.plot.formatDate(g,e,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)};c.prototype.adjustValPrecision=function(g,e,i){var h;var f=e.match(g);if(f!==null){if(RegExp.$1!==""){h=RegExp.$1;i=i.toFixed(h);e=e.replace(g,i)}}return e};c.prototype.hasAxisLabel=function(e,f){return(a.inArray("axisLabels",this.plotPlugins)!==-1&&typeof f.series[e].options.axisLabel!=="undefined"&&f.series[e].options.axisLabel.length>0)};c.prototype.hasRotatedXAxisTicks=function(e){return(a.inArray("tickRotor",this.plotPlugins)!==-1&&typeof e.series.xaxis.rotatedTicks!=="undefined")};var d=function(e){new c(e)};a.plot.plugins.push({init:d,options:b,name:"tooltip",version:"0.8.5"})})(jQuery);