/* store2 - v2.3.2 - 2015-10-27
* Copyright (c) 2015 Nathan Bubna; Licensed MIT, GPL */
(function(d,b){var a={version:"2.3.2",areas:{},apis:{},inherit:function(e,f){for(var g in e){if(!f.hasOwnProperty(g)){f[g]=e[g]}}return f},stringify:function(e){return e===undefined||typeof e==="function"?e+"":JSON.stringify(e)},parse:function(g){try{return JSON.parse(g)}catch(f){return g}},fn:function(g,f){a.storeAPI[g]=f;for(var e in a.apis){a.apis[e][g]=f}},get:function(e,f){return e.getItem(f)},set:function(e,f,g){e.setItem(f,g)},remove:function(e,f){e.removeItem(f)},key:function(e,f){return e.key(f)},length:function(e){return e.length},clear:function(e){e.clear()},Store:function(h,f,i){var j=a.inherit(a.storeAPI,function(l,e,m){if(arguments.length===0){return j.getAll()}if(e!==undefined){return j.set(l,e,m)}if(typeof l==="string"||typeof l==="number"){return j.get(l)}if(!l){return j.clear()}return j.setAll(l,e)});j._id=h;try{var k="_safariPrivate_";f.setItem(k,"sucks");j._area=f;f.removeItem(k)}catch(g){}if(!j._area){j._area=a.inherit(a.storageAPI,{items:{},name:"fake"})}j._ns=i||"";if(!a.areas[h]){a.areas[h]=j._area}if(!a.apis[j._ns+j._id]){a.apis[j._ns+j._id]=j}return j},storeAPI:{area:function(f,e){var g=this[f];if(!g||!g.area){g=a.Store(f,e,this._ns);if(!this[f]){this[f]=g}}return g},namespace:function(e,f){if(!e){return this._ns?this._ns.substring(0,this._ns.length-1):""}var g=e,h=this[g];if(!h||!h.namespace){h=a.Store(this._id,this._area,this._ns+g+".");if(!this[g]){this[g]=h}if(!f){h.area("session",a.areas.session)}}return h},isFake:function(){return this._area.name==="fake"},toString:function(){return"store"+(this._ns?"."+this.namespace():"")+"["+this._id+"]"},has:function(e){if(this._area.has){return this._area.has(this._in(e))}return !!(this._in(e) in this._area)},size:function(){return this.keys().length},each:function(f,e){for(var g=0,j=a.length(this._area);g<j;g++){var h=this._out(a.key(this._area,g));if(h!==undefined){if(f.call(this,h,e||this.get(h))===false){break}}if(j>a.length(this._area)){j--;g--}}return e||this},keys:function(){return this.each(function(e,f){f.push(e)},[])},get:function(f,e){var g=a.get(this._area,this._in(f));return g!==null?a.parse(g):e||g},getAll:function(){return this.each(function(f,e){e[f]=this.get(f)},{})},set:function(g,f,h){var e=this.get(g);if(e!=null&&h===false){return f}return a.set(this._area,this._in(g),a.stringify(f),h)||e},setAll:function(f,h){var e,i;for(var g in f){i=f[g];if(this.set(g,i,h)!==i){e=true}}return e},remove:function(f){var e=this.get(f);a.remove(this._area,this._in(f));return e},clear:function(){if(!this._ns){a.clear(this._area)}else{this.each(function(e){a.remove(this._area,this._in(e))},1)}return this},clearAll:function(){var e=this._area;for(var f in a.areas){if(a.areas.hasOwnProperty(f)){this._area=a.areas[f];this.clear()}}this._area=e;return this},_in:function(e){if(typeof e!=="string"){e=a.stringify(e)}return this._ns?this._ns+e:e},_out:function(e){return this._ns?e&&e.indexOf(this._ns)===0?e.substring(this._ns.length):undefined:e}},storageAPI:{length:0,has:function(e){return this.items.hasOwnProperty(e)},key:function(f){var e=0;for(var g in this.items){if(this.has(g)&&f===e++){return g}}},setItem:function(e,f){if(!this.has(e)){this.length++}this.items[e]=f},removeItem:function(e){if(this.has(e)){delete this.items[e];this.length--}},getItem:function(e){return this.has(e)?this.items[e]:null},clear:function(){for(var e in this.list){this.removeItem(e)}},toString:function(){return this.length+" items in "+this.name+"Storage"}}};if(d.store){a.conflict=d.store}var c=a.Store("local",(function(){try{return localStorage}catch(f){}})());c.local=c;c._=a;c.area("session",(function(){try{return sessionStorage}catch(f){}})());d.store=c;if(typeof b==="function"&&b.amd!==undefined){b(function(){return c})}else{if(typeof module!=="undefined"&&module.exports){module.exports=c}}})(this,this.define);