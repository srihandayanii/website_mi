var Spinner=function(a,b){this.$element=$(a);this.options=$.extend({},$.fn.spinner.defaults,b);this.$input=this.$element.find(".spinner-input");this.$element.on("keyup",this.$input,$.proxy(this.change,this));if(this.options.hold){this.$element.on("mousedown",".spinner-up",$.proxy(function(){this.startSpin(true)},this));this.$element.on("mouseup",".spinner-up, .spinner-down",$.proxy(this.stopSpin,this));this.$element.on("mouseout",".spinner-up, .spinner-down",$.proxy(this.stopSpin,this));this.$element.on("mousedown",".spinner-down",$.proxy(function(){this.startSpin(false)},this))}else{this.$element.on("click",".spinner-up",$.proxy(function(){this.step(true)},this));this.$element.on("click",".spinner-down",$.proxy(function(){this.step(false)},this))}this.switches={count:1,enabled:true};if(this.options.speed==="medium"){this.switches.speed=300}else{if(this.options.speed==="fast"){this.switches.speed=100}else{this.switches.speed=500}}this.lastValue=null;this.render();if(this.options.disabled){this.disable()}};Spinner.prototype={constructor:Spinner,render:function(){var a=this.$input.val();if(a){this.value(a)}else{this.$input.val(this.options.value)}this.$input.attr("maxlength",(this.options.max+"").split("").length)},change:function(){var a=this.$input.val();if(a/1){this.options.value=a/1}else{a=a.replace(/[^0-9]/g,"")||"";this.$input.val(a);this.options.value=a/1}this.triggerChangedEvent()},stopSpin:function(){if(this.switches.timeout!==undefined){clearTimeout(this.switches.timeout);this.switches.count=1;this.triggerChangedEvent()}},triggerChangedEvent:function(){var a=this.value();if(a===this.lastValue){return}this.lastValue=a;this.$element.trigger("changed",a);this.$element.trigger("change")},startSpin:function(b){if(!this.options.disabled){var a=this.switches.count;if(a===1){this.step(b);a=1}else{if(a<3){a=1.5}else{if(a<8){a=2.5}else{a=4}}}this.switches.timeout=setTimeout($.proxy(function(){this.iterator(b)},this),this.switches.speed/a);this.switches.count++}},iterator:function(a){this.step(a);this.startSpin(a)},step:function(d){var a=this.options.value;var e=d?this.options.max:this.options.min;var c,f;if((d?a<e:a>e)){var g=a+(d?1:-1)*this.options.step;if(this.options.step%1!==0){c=(this.options.step+"").split(".")[1].length;f=Math.pow(10,c);g=Math.round(g*f)/f}if(d?g>e:g<e){this.value(e)}else{this.value(g)}}else{if(this.options.cycle){var b=d?this.options.min:this.options.max;this.value(b)}}},value:function(a){if(!isNaN(parseFloat(a))&&isFinite(a)){a=parseFloat(a);this.options.value=a;this.$input.val(a);return this}else{return this.options.value}},disable:function(){this.options.disabled=true;this.$input.attr("disabled","");this.$element.find("button").addClass("disabled")},enable:function(){this.options.disabled=false;this.$input.removeAttr("disabled");this.$element.find("button").removeClass("disabled")}};$.fn.spinner=function(d){var b=Array.prototype.slice.call(arguments,1);var c;var a=this.each(function(){var e=$(this);var f=e.data("spinner");var g=typeof d==="object"&&d;if(!f){e.data("spinner",(f=new Spinner(this,g)))}if(typeof d==="string"){c=f[d].apply(f,b)}});return(c===undefined)?a:c};$.fn.spinner.defaults={value:1,min:1,max:999,step:1,hold:true,speed:"medium",disabled:false};$.fn.spinner.Constructor=Spinner;$.fn.spinner.noConflict=function(){$.fn.spinner=old;return this};$(function(){$("body").on("mousedown.spinner.data-api",".spinner",function(){var a=$(this);if(a.data("spinner")){return}a.spinner(a.data())})});